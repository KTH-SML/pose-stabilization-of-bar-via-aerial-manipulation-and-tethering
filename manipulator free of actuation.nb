(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    491469,      13705]
NotebookOptionsPosition[    480881,      13343]
NotebookOutlinePosition[    481238,      13359]
CellTagsIndexPosition[    481195,      13356]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
Heterogeneous Collaborative Pose Stabilization of a Bar Via Aerial \
Manipulation and Tethering\
\>", "Chapter",
 CellChangeTimes->{3.714043925269031*^9}],

Cell[CellGroupData[{

Cell["Problem Description", "Title",
 CellChangeTimes->{3.714043861412257*^9}],

Cell[CellGroupData[{

Cell["\<\
import some functions that compute dynamics based on Lagrangian, and that \
lineartize the system dynamics around a point (should be an equilibrium point)\
\>", "Subsubsection",
 CellChangeTimes->{{3.714043954385538*^9, 3.7140440151805964`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NotebookEvaluate", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<lagrangian_matrices.nb\>\""}], "}"}], "]"}], "]"}], ";"}]], "Input",\

 CellChangeTimes->{{3.712255289034539*^9, 3.7122552920410633`*^9}}]
}, Open  ]],

Cell[TextData[StyleBox["Problem: 2D bar pose stabilization of bar tethered to \
1 uav and grasped by 1 uav via a one-link manipulator -- manipulator free of \
actuation", "Subsubsection"]], "Subsubsection",
 CellChangeTimes->{{3.535359441795238*^9, 3.535359447164266*^9}, {
   3.625750347233474*^9, 3.6257503556738234`*^9}, {3.7081796858867607`*^9, 
   3.7081797314348383`*^9}, {3.7122023767161922`*^9, 3.712202427957158*^9}, 
   3.71220246449969*^9, {3.712407484338901*^9, 3.7124074984121304`*^9}, {
   3.714044037412551*^9, 3.714044072148662*^9}, {3.714044111005726*^9, 
   3.714044122162035*^9}},
 ExpressionUUID -> "8c6e4113-1e33-4ae8-bdf9-095e34aa0ff1"],

Cell[CellGroupData[{

Cell["Position and generalized coordinated", "Chapter",
 CellChangeTimes->{{3.714044136148864*^9, 3.71404414372159*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"global", " ", "coordinates"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "REMARK", " ", "positions", " ", "are", " ", "of", " ", "center", " ", 
    "of", " ", "mass"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"px", ",", "pz", ",", 
       RowBox[{"(*", 
        RowBox[{"linear", " ", "position", " ", "of", " ", "bar"}], "*)"}], 
       "\[IndentingNewLine]", "nbarx", ",", "nbarz", ",", 
       RowBox[{"(*", 
        RowBox[{"angular", " ", "position", " ", "of", " ", "bar"}], "*)"}], 
       "\[IndentingNewLine]", "pmx", ",", "pmz", ",", 
       RowBox[{"(*", 
        RowBox[{"linear", " ", "position", " ", "of", " ", "manipulator"}], 
        "*)"}], "\[IndentingNewLine]", "nmx", ",", "nmz", ",", 
       RowBox[{"(*", 
        RowBox[{"angular", " ", "position", " ", "of", " ", "manipulator"}], 
        "*)"}], "\[IndentingNewLine]", "P1x", ",", "P1z", ",", 
       RowBox[{"(*", 
        RowBox[{"linear", " ", "position", " ", "of", " ", "uav", " ", "1"}], 
        "*)"}], "\[IndentingNewLine]", "P2x", ",", "P2z"}], 
      RowBox[{"(*", 
       RowBox[{"linear", " ", "position", " ", "of", " ", "uav", " ", "2"}], 
       "*)"}], "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"generalized", " ", 
      RowBox[{"coordinates", ":", " ", 
       RowBox[{"with", " ", "these"}]}]}], ",", " ", 
     RowBox[{
     "one", " ", "should", " ", "be", " ", "able", " ", "to", " ", 
      "reconstruct", " ", "the", " ", "global", " ", "coordinates"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"px", ",", "pz", ",", 
       RowBox[{"(*", 
        RowBox[{"linear", " ", "position", " ", "of", " ", "bar"}], "*)"}], 
       "\[IndentingNewLine]", "\[Alpha]bar", ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"angular", " ", "position", " ", "of", " ", "bar"}], " ", 
         "-", " ", 
         RowBox[{
          RowBox[{"w", ".", "r", ".", "t", ".", " ", "to"}], " ", "x", " ", 
          "axis"}]}], "*)"}], "\[IndentingNewLine]", "\[Alpha]m", ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"angular", " ", "position", " ", "of", " ", "manipulator"}], 
         " ", "-", " ", 
         RowBox[{
          RowBox[{"w", ".", "r", ".", "t", ".", " ", "to"}], " ", "z", " ", 
          "axis"}]}], "*)"}], "\[IndentingNewLine]", "\[Alpha]c1"}], "  ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "angular", " ", "position", " ", "of", " ", "cable", " ", "1"}], " ", 
        "-", " ", 
        RowBox[{
         RowBox[{"w", ".", "r", ".", "t", ".", " ", "to"}], " ", "z", " ", 
         "axis"}]}], "*)"}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qd", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"pxd", ",", "pzd", ",", 
       RowBox[{"(*", 
        RowBox[{"linear", " ", "velocity", " ", "of", " ", "bar"}], "*)"}], 
       "\[IndentingNewLine]", "\[Alpha]bard", ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"angular", " ", "velocity", " ", "of", " ", "bar"}], " ", 
         "-", " ", 
         RowBox[{
          RowBox[{"w", ".", "r", ".", "t", ".", " ", "to"}], " ", "x", " ", 
          "axis"}]}], "*)"}], "\[IndentingNewLine]", "\[Alpha]C1d"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "angular", " ", "position", " ", "of", " ", "cable", " ", "1"}], " ", 
        "-", " ", 
        RowBox[{
         RowBox[{"w", ".", "r", ".", "t", ".", " ", "to"}], " ", "y", " ", 
         "axis"}]}], "*)"}], "\[IndentingNewLine]", "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQ/TU1OuJb9CvHHkH/eBAdwLg93HH2a8cvswUiQLSI
mkcaiGYPLMoF0a9ulD32BNKyz1eA6bzF3OsWzXvtKDH53HoQPa0juGExkFa3
29AIou/5yveBaCcNbTA9z3z/fBDNFeO9AESzic65sBRIm505fhFE9xfYPQTR
7+SrnoLoO8GpdsuBtHSakz2Inucye7/T/NeOClO0LoDoDR9zK3yBtAyDbTWI
/rDhLOt+ID2v5jWYVjJeIXQASK97OVcYRO9o46wsXvDacXvw1GoQXdIttuQU
kLbzm7QXRJ84zHOrbMVrR2XBzw9A9AQjh2cget2Gko8gesvPX/K/VgPtuZWu
AqKbQjiyQbRY9GwwDQAb0bT5
  "],
 ExpressionUUID -> "2a4c5a2f-14ff-4a51-874d-d274721b773e"],

Cell["\<\
We will need to write the previous states as functions of time, so that we \
can take total derivatives. We can create new variables by applying a pure \
function:\
\>", "Text",
 CellChangeTimes->{{3.537875708338273*^9, 3.5378757399056873`*^9}, {
  3.537875925413426*^9, 3.537875955970327*^9}, {3.712202464538468*^9, 
  3.712202464561369*^9}, {3.71220265860371*^9, 3.712202661202537*^9}},
 ExpressionUUID -> "85809aa9-b23d-4de0-9b19-f1730e239aba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "generalized", " ", "coordinates", " ", "as", " ", "function", " ", "of", 
    " ", "time", " ", "and", " ", "its", " ", "1", "st", " ", "and", " ", "2",
     "nd", " ", "derivatives"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"qt", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", "t", "]"}], "&"}], "/@", "q"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qdt", "=", 
     RowBox[{"D", "[", 
      RowBox[{"qt", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qddt", "=", 
     RowBox[{"D", "[", 
      RowBox[{"qdt", ",", "t"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.5378759655652113`*^9, 3.537875978405024*^9}, {
   3.537876885017558*^9, 3.537876888437872*^9}, {3.537880235731019*^9, 
   3.537880236155603*^9}, {3.712380376572734*^9, 3.7123804217960243`*^9}, 
   3.712408129223044*^9},
 ExpressionUUID -> "13002005-e5e9-4011-8dce-b876428bd5e6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["7 holonomic constraints", "Chapter",
 CellChangeTimes->{{3.714044588033142*^9, 3.7140445958545094`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "pz_", ",", "nbarx_", ",", "nbarz_", ",", "pmx_", ",", 
      "pmz_", ",", "nmx_", ",", "nmz_", ",", "P1x_", ",", "P1z_", ",", "P2x_",
       ",", "P2z_"}], "}"}], "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", ".", "#"}], "&"}], "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"px", ",", "pz"}], "}"}], "+", 
         RowBox[{"d1", 
          RowBox[{"{", 
           RowBox[{"nbarx", ",", "nbarz"}], "}"}]}], "-", 
         RowBox[{"{", 
          RowBox[{"P1x", ",", "P1z"}], "}"}]}], "]"}], "-", 
       SuperscriptBox["l1", "2"]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"px", ",", "pz"}], "}"}], "+", 
      RowBox[{"d2", 
       RowBox[{"{", 
        RowBox[{"nbarx", ",", "nbarz"}], "}"}]}], "-", 
      RowBox[{"{", 
       RowBox[{"P2x", ",", "P2z"}], "}"}], "+", 
      RowBox[{"l2", " ", 
       RowBox[{"{", 
        RowBox[{"nmx", ",", "nmz"}], "}"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"px", ",", "pz"}], "}"}], "+", 
      RowBox[{"d2", 
       RowBox[{"{", 
        RowBox[{"nbarx", ",", "nbarz"}], "}"}]}], "-", 
      RowBox[{"{", 
       RowBox[{"pmx", ",", "pmz"}], "}"}], "+", 
      RowBox[{"lm", " ", 
       RowBox[{"{", 
        RowBox[{"nmx", ",", "nmz"}], "}"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nbarx", ",", "nbarz"}], "}"}], ".", 
        RowBox[{"{", 
         RowBox[{"nbarx", ",", "nbarz"}], "}"}]}], "-", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nmx", ",", "nmz"}], "}"}], ".", 
        RowBox[{"{", 
         RowBox[{"nmx", ",", "nmz"}], "}"}]}], "-", "1"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7140445970601788`*^9, 3.7140448177691174`*^9}, {
  3.71404486496996*^9, 3.714044867717222*^9}, {3.71404493252601*^9, 
  3.714044957297285*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Function g from generalized coordinates to position vector", "Chapter",
 CellChangeTimes->{{3.7140443477298393`*^9, 3.714044365263026*^9}}],

Cell["map that relates the two sets of coordinates:", "Text",
 CellChangeTimes->{{3.537876040247859*^9, 3.537876067434545*^9}, 
   3.537876101555757*^9, {3.5378827232983513`*^9, 3.537882749474223*^9}, {
   3.7123804353971987`*^9, 3.712380439336351*^9}},
 ExpressionUUID -> "c813662b-0f04-4b08-8050-25309ab1451e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"horizontal", " ", "unit", " ", 
      RowBox[{"vector", ":", " ", 
       RowBox[{"uvh", "[", "0", "]"}]}]}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"uvh", "[", "\[Alpha]_", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Alpha]", "]"}], ",", 
       RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"vertical", " ", "unit", " ", 
       RowBox[{"vector", ":", " ", 
        RowBox[{"uvv", "[", "0", "]"}]}]}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uvv", "[", "\[Alpha]_", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], ",", 
       RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"g", "[", 
      RowBox[{"{", 
       RowBox[{
       "px_", ",", "pz_", ",", "\[Alpha]bar_", ",", "\[Alpha]m_", ",", 
        "\[Alpha]c1_"}], "}"}], "]"}], "=", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"px", ",", "pz"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"uvh", "[", "\[Alpha]bar", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"px", ",", "pz"}], "}"}], "+", 
        RowBox[{"d2", " ", 
         RowBox[{"uvh", "[", "\[Alpha]bar", "]"}]}], "+", 
        RowBox[{"lm", " ", 
         RowBox[{"uvv", "[", "\[Alpha]m", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"uvv", "[", "\[Alpha]m", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"px", ",", "pz"}], "}"}], "+", 
        RowBox[{"d1", " ", 
         RowBox[{"uvh", "[", "\[Alpha]bar", "]"}]}], "+", 
        RowBox[{"l1", " ", 
         RowBox[{"uvv", "[", "\[Alpha]c1", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"px", ",", "pz"}], "}"}], "+", 
        RowBox[{"d2", " ", 
         RowBox[{"uvh", "[", "\[Alpha]bar", "]"}]}], "+", 
        RowBox[{"l2", " ", 
         RowBox[{"uvv", "[", "\[Alpha]m", "]"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.537876074907959*^9, 3.537876076674851*^9}, {
   3.537877255919182*^9, 3.5378772575499077`*^9}, {3.537880102391426*^9, 
   3.537880106412527*^9}, 3.53920098987811*^9, {3.539201054866827*^9, 
   3.539201060781165*^9}, {3.705277331261415*^9, 3.7052773678984957`*^9}, {
   3.7052774103985786`*^9, 3.705277435114867*^9}, {3.705277496846698*^9, 
   3.705277558433708*^9}, {3.705293789674754*^9, 3.705293799602372*^9}, {
   3.707049357498105*^9, 3.707049367521861*^9}, {3.7070494289467497`*^9, 
   3.707049462978292*^9}, {3.707049715724574*^9, 3.707049715969323*^9}, {
   3.707051276609754*^9, 3.707051278207502*^9}, {3.707055772667694*^9, 
   3.707055784772543*^9}, {3.7070558945618763`*^9, 3.707055928851099*^9}, {
   3.7070586982082777`*^9, 3.707058713135297*^9}, {3.707377321004766*^9, 
   3.707377373130725*^9}, {3.707399147653522*^9, 3.707399178668713*^9}, {
   3.707409725233466*^9, 3.707409725251438*^9}, {3.7076316856107063`*^9, 
   3.707631715111828*^9}, {3.707631747862039*^9, 3.7076317850842113`*^9}, {
   3.707633832177225*^9, 3.7076338375063972`*^9}, 3.708088272870463*^9, {
   3.708137877502083*^9, 3.708137899848523*^9}, {3.712202460288891*^9, 
   3.712202460311618*^9}, {3.712202609252602*^9, 3.712202635694916*^9}, {
   3.712202670315774*^9, 3.712202706676146*^9}, {3.712408152039597*^9, 
   3.712408152276243*^9}, 3.712723109701352*^9, {3.712723141319482*^9, 
   3.7127231594277973`*^9}},
 ExpressionUUID -> "d0fd8828-3b3f-415d-b01e-81c531f7ed9a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Jacobian of map g", "Chapter",
 CellChangeTimes->{{3.712380447637004*^9, 3.712380451934094*^9}, {
  3.712408153869577*^9, 3.712408162730542*^9}, {3.7140443833865747`*^9, 
  3.714044386507687*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Dg", "[", 
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "pz_", ",", "\[Alpha]bar_", ",", "\[Alpha]m_", ",", 
      "\[Alpha]c1_"}], "}"}], "]"}], "=", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"g", "[", "q", "]"}], ",", 
      RowBox[{"{", "q", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"g", "[", "qt", "]"}], ",", 
    RowBox[{"{", "qt", "}"}]}], "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7122553837541656`*^9, 3.71225538684551*^9}, {
  3.712408155342064*^9, 3.71240815568788*^9}, {3.714044245603557*^9, 
  3.714044246827879*^9}},
 ExpressionUUID -> "f098f472-f40c-4df3-90bf-7e58243a4070"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Alpha]bar", "[", "t", "]"}], "]"}]}], "0", "0"},
     {"0", "0", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Alpha]bar", "[", "t", "]"}], "]"}], "0", "0"},
     {"1", "0", 
      RowBox[{
       RowBox[{"-", "d2"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Alpha]bar", "[", "t", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"-", "lm"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]m", "[", "t", "]"}], "]"}]}], "0"},
     {"0", "1", 
      RowBox[{"d2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]bar", "[", "t", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"-", "lm"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Alpha]m", "[", "t", "]"}], "]"}]}], "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]m", "[", "t", "]"}], "]"}]}], "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Alpha]m", "[", "t", "]"}], "]"}]}], "0"},
     {"1", "0", 
      RowBox[{
       RowBox[{"-", "d1"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Alpha]bar", "[", "t", "]"}], "]"}]}], "0", 
      RowBox[{
       RowBox[{"-", "l1"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]c1", "[", "t", "]"}], "]"}]}]},
     {"0", "1", 
      RowBox[{"d1", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]bar", "[", "t", "]"}], "]"}]}], "0", 
      RowBox[{
       RowBox[{"-", "l1"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Alpha]c1", "[", "t", "]"}], "]"}]}]},
     {"1", "0", 
      RowBox[{
       RowBox[{"-", "d2"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Alpha]bar", "[", "t", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"-", "l2"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]m", "[", "t", "]"}], "]"}]}], "0"},
     {"0", "1", 
      RowBox[{"d2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]bar", "[", "t", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"-", "l2"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Alpha]m", "[", "t", "]"}], "]"}]}], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.712723170165324*^9, 3.712758972139398*^9, 
  3.7127609986665688`*^9, 3.7127671114897213`*^9, 3.712769536922183*^9, 
  3.712827696675914*^9, 3.713065012459305*^9, 3.713633625667926*^9, 
  3.713633822146483*^9, 3.713707533099327*^9, 3.714044286490252*^9, 
  3.714056376126885*^9, 3.714056477182933*^9, 3.714057806556024*^9, 
  3.714064240758806*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check g map satisfies holonomic constraints ", "Chapter",
 CellChangeTimes->{{3.714044823289524*^9, 3.71404483980197*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"g", "[", "q", "]"}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.714044848787335*^9, 3.714044856764862*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.714044852439179*^9, 3.7140448718544703`*^9}, {
   3.7140449368974333`*^9, 3.714044961107587*^9}, 3.714056376199894*^9, 
   3.7140564772754383`*^9, 3.714057806628248*^9, 3.714064240810005*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kinetic and potential energy functions", "Chapter",
 CellChangeTimes->{{3.708181120684865*^9, 3.708181132020318*^9}, 
   3.708181295962384*^9, 3.712202460372157*^9, {3.712380456855177*^9, 
   3.712380479414014*^9}, {3.7140444661486187`*^9, 3.714044478240489*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Kinectic", "[", 
   RowBox[{"{", 
    RowBox[{
    "pxd_", ",", "pzd_", ",", "nbarxd_", ",", "nbarzd_", ",", "pmxd_", ",", 
     "pmzd_", ",", "nmxd_", ",", "nmzd_", ",", "P1xd_", ",", "P1zd_", ",", 
     "P2xd_", ",", "P2zd_"}], "}"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], "M1", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["P1xd", "2"], "+", 
      SuperscriptBox["P1zd", "2"]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], "M2", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["P2xd", "2"], "+", 
      SuperscriptBox["P2zd", "2"]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], "m", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["pxd", "2"], "+", 
      SuperscriptBox["pzd", "2"]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], "Jbar", "  ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["nbarxd", "2"], "+", 
      SuperscriptBox["nbarzd", "2"]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], "MM", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["pmxd", "2"], "+", 
      SuperscriptBox["pmzd", "2"]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], "JM", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["nmxd", "2"], "+", 
      SuperscriptBox["nmzd", "2"]}], ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Potential", "[", 
   RowBox[{"{", 
    RowBox[{
    "px_", ",", "pz_", ",", "nbarx_", ",", "nbarz_", ",", "pmx_", ",", "pmz_",
      ",", "nmx_", ",", "nmz_", ",", "P1x_", ",", "P1z_", ",", "P2x_", ",", 
     "P2z_"}], "}"}], "]"}], ":=", 
  RowBox[{"gravity", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"M1", " ", "P1z"}], "+", 
     RowBox[{"M2", " ", "P2z"}], "+", 
     RowBox[{"m", " ", "pz"}], "+", 
     RowBox[{"MM", " ", "pmz"}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.5315700210108128`*^9, 3.531570113847682*^9}, {
   3.537876265026963*^9, 3.537876299056636*^9}, {3.5378772695871553`*^9, 
   3.537877271330921*^9}, {3.538891005856593*^9, 3.538891007407086*^9}, {
   3.70529395259408*^9, 3.7052939615437393`*^9}, 3.7052939977767477`*^9, {
   3.705294040437755*^9, 3.705294083529961*^9}, {3.7052941806151333`*^9, 
   3.705294183037215*^9}, {3.7052945547890453`*^9, 3.705294610906481*^9}, {
   3.706794922851754*^9, 3.706794923644573*^9}, {3.7067949572351847`*^9, 
   3.7067949630176563`*^9}, {3.7070494709462767`*^9, 3.707049542077465*^9}, {
   3.707050327568529*^9, 3.707050430032276*^9}, {3.7070513045186253`*^9, 
   3.70705132004698*^9}, {3.707055835746743*^9, 3.707055875694645*^9}, {
   3.707055938155796*^9, 3.707055940540186*^9}, {3.7070572167922583`*^9, 
   3.707057233090601*^9}, {3.707058766968213*^9, 3.707058781916214*^9}, {
   3.707377413310997*^9, 3.7073774255281467`*^9}, {3.707377457880165*^9, 
   3.70737757174139*^9}, {3.707399227189233*^9, 3.707399307464115*^9}, {
   3.707633844291562*^9, 3.707633865666338*^9}, {3.71220246040977*^9, 
   3.712202460447608*^9}, {3.712202491851122*^9, 3.712202503618841*^9}, {
   3.7122025460181313`*^9, 3.71220257106778*^9}, {3.712380513092469*^9, 
   3.712380513542139*^9}, {3.714044759709388*^9, 3.714044764892972*^9}},
 ExpressionUUID -> "6f8a9b07-7f8c-4f9c-8432-6d13f45d1059"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lagrangian", "Chapter",
 CellChangeTimes->{{3.714044484973217*^9, 3.7140444871547728`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "lagrangian", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"L", "[", 
     RowBox[{"p_", ",", "pd_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Kinectic", "[", "pd", "]"}], "-", 
     RowBox[{"Potential", "[", "p", "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"lagrangian", " ", "equations"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Lq", "=", 
     RowBox[{
      RowBox[{"L", "[", 
       RowBox[{
        RowBox[{"g", "[", "qt", "]"}], ",", 
        RowBox[{
         RowBox[{"Dg", "[", "qt", "]"}], ".", "qdt"}]}], "]"}], "//", 
      "Simplify"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.708067169861274*^9, 3.708067183425559*^9}, {
   3.708067250685109*^9, 3.708067340601609*^9}, {3.7081801712684402`*^9, 
   3.7081801796980143`*^9}, {3.708180325112464*^9, 3.708180357692067*^9}, {
   3.708180817747765*^9, 3.708180910748762*^9}, {3.708180944893852*^9, 
   3.7081810783016148`*^9}, {3.708181168921371*^9, 3.708181191095236*^9}, {
   3.7081831770631866`*^9, 3.708183206676272*^9}, {3.712202460608285*^9, 
   3.712202460654106*^9}, 3.7122027813513308`*^9, {3.7122028152875967`*^9, 
   3.7122028233567047`*^9}, {3.712252447688376*^9, 3.712252459433139*^9}, {
   3.7123806179164543`*^9, 3.712380637843601*^9}, {3.714044494328402*^9, 
   3.714044495275071*^9}},
 ExpressionUUID -> "ef458ca4-6e39-41ae-bd58-6a559fee4d8a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equations of motion from Lagrangian", "Chapter",
 CellChangeTimes->{{3.714044501869937*^9, 3.714044510194434*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UnactuatedEquationsOfMotion", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"Lq", ",", 
          RowBox[{"{", "qdt", "}"}]}], "]"}], ",", "t"}], "]"}], "-", 
      RowBox[{"D", "[", 
       RowBox[{"Lq", ",", 
        RowBox[{"{", "qt", "}"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"mass", ",", " ", 
    RowBox[{"coriolis", " ", "and", " ", "gravity", " ", "matrices"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"MMatrix", ",", "CMatrix", ",", "GMatrix"}], "}"}], "=", 
    RowBox[{"LagrangeMatrices", "[", 
     RowBox[{
      RowBox[{"Length", "[", "q", "]"}], ",", "g", ",", "Potential", ",", 
      "Kinectic"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"this", " ", "is", " ", "just", " ", "a", " ", "check"}], ",", 
    " ", 
    RowBox[{
    "to", " ", "make", " ", "sure", " ", "matrices", " ", "are", " ", 
     "correct"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MMatrix", "[", "qt", "]"}], ".", "qddt"}], "+", 
   RowBox[{
    RowBox[{"CMatrix", "[", 
     RowBox[{"qt", ",", "qdt"}], "]"}], ".", "qdt"}], "+", 
   RowBox[{"GMatrix", "[", "qt", "]"}], "-", "UnactuatedEquationsOfMotion"}], 
  "//", "Simplify"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.7140445114474163`*^9, 3.714056379586761*^9, 
  3.714056481006954*^9, 3.714057809973083*^9, 3.71406424468955*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Check that mass matrix is invertible around equilibrium point\
\>", "Chapter",
 CellChangeTimes->{{3.714044540509898*^9, 3.714044553387693*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Det", "[", 
     RowBox[{"MMatrix", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], "]"}], 
     "]"}], "//", "Simplify"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Det", "[", 
     RowBox[{"MMatrix", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], "]"}], 
     "]"}], "-", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["l1", "2"], " ", "M1", " ", 
      RowBox[{"(", "  ", 
       RowBox[{
        RowBox[{"m", " ", "M2", " ", 
         SuperscriptBox["l2", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"l2", "-", "lm"}], ")"}], "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "m"}]}], ")"}], " ", "MM"}], "+", 
        
        RowBox[{"JM", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d2", "2"], 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1"}]}], ")"}], " ", "m"}], "+", 
        
        RowBox[{"Jbar", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
     ")"}]}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.712722092345996*^9, 3.712722152093388*^9}, {
  3.712722184134254*^9, 3.712722266249679*^9}, {3.712722430277273*^9, 
  3.712722437530815*^9}, {3.712722570373019*^9, 3.7127225913117743`*^9}, {
  3.712723109734756*^9, 3.712723109740212*^9}, {3.712723141365848*^9, 
  3.712723141369851*^9}, {3.712723228058486*^9, 3.712723257155184*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.712722575710371*^9, 3.712722594976802*^9}, {
   3.712723257891986*^9, 3.712723261858017*^9}, 3.7127589773182297`*^9, 
   3.7127609993447437`*^9, 3.712767115064233*^9, 3.712769540912036*^9, 
   3.712827700125461*^9, 3.7130650166009483`*^9, 3.713633629324202*^9, 
   3.713633822651403*^9, 3.713707536868225*^9, 3.7140442943228683`*^9, 
   3.7140563797053213`*^9, 3.714056481142864*^9, 3.714057810078836*^9, 
   3.714064244798908*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Equilibrium state", "Code",
 FontWeight->"Plain"]], "Chapter",
 CellChangeTimes->{{3.708181265233707*^9, 3.708181265713923*^9}, 
   3.708181309218297*^9, {3.708181351257999*^9, 3.70818136579596*^9}, {
   3.714045076052676*^9, 3.714045080321437*^9}},
 FontWeight->"Bold"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"equilibrium", " ", "--"}], " ", "generalized", " ", 
    "coordinate"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"qeq", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"Length", "[", "q", "]"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.708181318323213*^9, 3.70818134239609*^9}, {
   3.708181375785921*^9, 3.7081813978362494`*^9}, 3.712202460670557*^9, 
   3.7122028155607557`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Equilibrium input", "Code",
 FontWeight->"Plain"]], "Chapter",
 CellChangeTimes->{{3.708181265233707*^9, 3.708181265713923*^9}, 
   3.708181309218297*^9, {3.708181351257999*^9, 3.70818136579596*^9}, {
   3.714045076052676*^9, 3.714045089531629*^9}}],

Cell[CellGroupData[{

Cell["Input", "Subsubsection",
 CellChangeTimes->{{3.714045119849018*^9, 3.7140451231973877`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"uu", "=", 
   RowBox[{"{", 
    RowBox[{"\[Tau]man", ",", "U1x", ",", "U1z", ",", "U2x", ",", "U2z"}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7122024606828136`*^9, 3.712202460686323*^9}, {
  3.714045095012586*^9, 3.7140451305935297`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Function that maps how input affect acceleration of \
generalized coordinates", "Subsubsection"]], "Subsubsection",
 CellChangeTimes->{{3.7081814186147337`*^9, 3.708181440889977*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "pz_", ",", "\[Alpha]bar_", ",", "\[Alpha]m_", ",", 
       "\[Alpha]c1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\[Tau]man_", ",", "U1x_", ",", "U1z_", ",", "U2x_", ",", "U2z_"}], 
      "}"}]}], "]"}], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "\[Tau]man", ",", "0"}], "}"}], 
    "+", 
    RowBox[{"(*", 
     RowBox[{"angular", " ", "acceleration", " ", "on", " ", "\[Alpha]m"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Evaluate", "[", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"g", "[", "q", "]"}], ",", 
         RowBox[{"{", "q", "}"}]}], "]"}], "]"}], "]"}], ".", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "U1x", ",", "U1z", ",", "U2x", ",", "U2z"}], "}"}]}]}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"linear", " ", "acceleration", " ", "on", " ", "Px1"}], ",", 
    "Pz1", ",", "Px2", ",", "Pz2"}], "*)"}], ";"}]], "Input",
 CellChangeTimes->{{3.708100940729021*^9, 3.7081009408614063`*^9}, {
   3.708101015226564*^9, 3.708101086012739*^9}, {3.7081373582399187`*^9, 
   3.708137358432314*^9}, {3.708140535298183*^9, 3.708140543660432*^9}, {
   3.70818137361593*^9, 3.70818137436969*^9}, 3.708181412138376*^9, {
   3.7081814439621363`*^9, 3.7081815431429*^9}, {3.712202460699114*^9, 
   3.7122024607228127`*^9}, {3.71220260932241*^9, 3.712202635715225*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Equilibrium input: equilibrium input must cancel gravity term \
\>", "Subsubsection",
 CellChangeTimes->{{3.708181548384183*^9, 3.708181561310329*^9}, {
  3.7124081887374687`*^9, 3.712408207871661*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "there", " ", "is", " ", "only", " ", "one", " ", "equilibrium", " ", "in",
     " ", "this", " ", "case"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ueq", "=", 
   RowBox[{"uu", "/.", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"GMatrix", "[", "qeq", "]"}], "\[Equal]", 
          RowBox[{"FU", "[", 
           RowBox[{"qeq", ",", "uu"}], "]"}]}], ",", "uu"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "//", "Simplify"}], 
     ")"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.712202460734853*^9, 3.7122028234680653`*^9, {3.712408210557308*^9, 
   3.7124082253877068`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"gravity", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d1"}], " ", "M1"}], "+", 
        RowBox[{"d2", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}]}], 
     RowBox[{"d1", "-", "d2"}]]}], ",", "0", ",", 
   FractionBox[
    RowBox[{"gravity", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "d2"}], " ", 
        RowBox[{"(", 
         RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
       RowBox[{"d1", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
    RowBox[{"d1", "-", "d2"}]]}], "}"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJwVzk0ogwEcx/FHDli4sJBFNNtC0zKJgzyiRrYVuZCH2CzZphYzjYO8jA1Z
SZpyGGU2NZy8LGkcNLGZKbOwdqA8UkvZiPL/H359br++BT2DLfIEgiAqYPeM
QN+IjSZl9x3JY6BOI7SMg5HG8OESeN7FZpvBF/O5Cu2+MI+iTmHdAjoxq8i3
gtYzZxA1DixOHoI8n0x6DGZzLYUucDbOaETFGUodqpaUz6HvAur5CtxPXQp4
Qa0v7w/121VMHxjn1ZSgTZ3FevTH0H6HHqUrafRa76++AeXRojI/9oRymLdg
5kbFVgCsVCta70CqQSsJgfyqUPoj/td7TtCHE47wCbRQ3t4YuMIhJtGYK636
G5wqYUlRit98ic7TYt7wNk1y44LVGVCzH102gF/T/WYjyIxYT03gENfEsYFN
KblJLDtNhj/3HAIHTXoTg2eoa7PQ3QZSorq1H7B2dzyL2KHJ34NSNup5E3lQ
9+v6RyL4D31j6wI=
  "]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["A and B matrices (not closed loop yet)", "Chapter",
 CellChangeTimes->{{3.7081816097983217`*^9, 3.7081816138591833`*^9}, {
  3.714045224143405*^9, 3.714045229280891*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"AMatrix", ",", "BMatrix"}], "}"}], "=", 
   RowBox[{"LagrangeLinearization", "[", 
    RowBox[{
    "qeq", ",", "g", ",", "Potential", ",", "Kinectic", ",", "FU", ",", 
     "uu"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"AMatrix", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"BMatrix", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.70806690602981*^9, 3.708067137519293*^9}, 
   3.70806716823663*^9, {3.708067343481702*^9, 3.708067369864313*^9}, {
   3.708067405944409*^9, 3.708067479463253*^9}, {3.708067584088011*^9, 
   3.7080676056603327`*^9}, {3.70806764592771*^9, 3.70806769869061*^9}, {
   3.7080677483418503`*^9, 3.708067962566708*^9}, {3.70810080097167*^9, 
   3.708100842810926*^9}, 3.708100916994722*^9, {3.708101090871266*^9, 
   3.708101161330327*^9}, {3.7081368521598454`*^9, 3.7081368994090347`*^9}, {
   3.708137128767048*^9, 3.708137320915947*^9}, {3.70818158019107*^9, 
   3.708181580337303*^9}, {3.708181632311233*^9, 3.708181733560211*^9}, {
   3.70818276197582*^9, 3.708182906698174*^9}, {3.708183304879369*^9, 
   3.7081833126779003`*^9}, {3.71220246078214*^9, 3.712202460897668*^9}, 
   3.712202781394043*^9, {3.7122028155794573`*^9, 3.712202823531789*^9}, {
   3.712202884223881*^9, 3.712202919226777*^9}, 3.712252467623262*^9, 
   3.712380672200121*^9},
 ExpressionUUID -> "20f9c02a-f665-46bc-84fe-7ffdbb395f4f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.708067963024736*^9, {3.7081008211590147`*^9, 3.7081008435758867`*^9}, 
   3.708137325107339*^9, 3.708139609108975*^9, 3.708140496773178*^9, 
   3.708140717717827*^9, 3.7081466563968353`*^9, 3.708162916510455*^9, 
   3.708172729483234*^9, 3.7081729384438057`*^9, 3.708181737847156*^9, 
   3.70818343188901*^9, 3.70818483602179*^9, 3.708184901911689*^9, 
   3.7081849549355993`*^9, 3.711081447553238*^9, 3.711081567657364*^9, 
   3.712203584688748*^9, 3.7122130595586243`*^9, 3.712216274247135*^9, 
   3.7122554411057796`*^9, 3.712256289229344*^9, 3.712256878725256*^9, 
   3.712256973151243*^9, 3.7122571306024513`*^9, 3.712291068119998*^9, 
   3.7122925582035913`*^9, 3.712338973114229*^9, 3.712342651714778*^9, 
   3.7123443413618593`*^9, 3.712344649191984*^9, 3.712345028079516*^9, 
   3.712345162217351*^9, {3.712380669110598*^9, 3.712380673118037*^9}, 
   3.712384677172572*^9, 3.71238500155595*^9, 3.712385196041595*^9, 
   3.712385370304798*^9, 3.7123860097012*^9, 3.7123867311576633`*^9, 
   3.7123869077967997`*^9, 3.712387542941867*^9, 3.7123894975660353`*^9, 
   3.7123913371817217`*^9, 3.712394554106945*^9, 3.712395931637108*^9, 
   3.712408181346946*^9, 3.712408227975677*^9, 3.712411767106163*^9, 
   3.7124131747695837`*^9, 3.7124141135669737`*^9, 3.712465694871215*^9, 
   3.712465944267489*^9, 3.7124694568481693`*^9, 3.712469625314258*^9, 
   3.712470618801878*^9, 3.71272326850138*^9, 3.7127589781587887`*^9, 
   3.712760999898717*^9, 3.7127671158478727`*^9, 3.7127695417095413`*^9, 
   3.712827700912114*^9, 3.713065017590929*^9, 3.7136336301145077`*^9, 
   3.713707537700149*^9, 3.7140452366996813`*^9, 3.714056380496993*^9, 
   3.714056482049952*^9, 3.714057810846673*^9, 3.7140642454974546`*^9},
 ExpressionUUID -> "d7d239d1-0d76-46ec-9df5-906932e9308b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{
        RowBox[{"l2", " ", "M2"}], "+", 
        RowBox[{"lm", " ", "MM"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
        "+", 
        RowBox[{
         SuperscriptBox["lm", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
        RowBox[{
         SuperscriptBox["l2", "2"], " ", "M2", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
        RowBox[{"JM", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "0", "0", 
      FractionBox[
       RowBox[{"JM", "+", 
        RowBox[{"lm", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "l2"}], "+", "lm"}], ")"}], " ", "MM"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
        "+", 
        RowBox[{
         SuperscriptBox["lm", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
        RowBox[{
         SuperscriptBox["l2", "2"], " ", "M2", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
        RowBox[{"JM", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "0"},
     {"0", "0", 
      FractionBox[
       RowBox[{"Jbar", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{"Jbar", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]], "0", 
      FractionBox[
       RowBox[{"Jbar", "+", 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "M1"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{"Jbar", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]},
     {"0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "d2"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{"Jbar", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]], "0", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "d1"}], " ", "M1"}], "+", 
        RowBox[{"d2", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1"}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{"Jbar", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]},
     {
      FractionBox[
       RowBox[{"m", "+", "M2", "+", "MM"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
        "+", 
        RowBox[{
         SuperscriptBox["lm", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
        RowBox[{
         SuperscriptBox["l2", "2"], " ", "M2", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
        RowBox[{"JM", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"lm", " ", "MM"}], "-", 
        RowBox[{"l2", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "MM"}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
        "+", 
        RowBox[{
         SuperscriptBox["lm", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
        RowBox[{
         SuperscriptBox["l2", "2"], " ", "M2", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
        RowBox[{"JM", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "0"},
     {
      FractionBox[
       RowBox[{
        RowBox[{"l2", " ", "M2"}], "+", 
        RowBox[{"lm", " ", "MM"}]}], 
       RowBox[{"l1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
          "+", 
          RowBox[{
           SuperscriptBox["lm", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
          RowBox[{
           SuperscriptBox["l2", "2"], " ", "M2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"JM", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"l1", " ", "M1"}]]}], "0", 
      FractionBox[
       RowBox[{"JM", "+", 
        RowBox[{"lm", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "l2"}], "+", "lm"}], ")"}], " ", "MM"}]}], 
       RowBox[{"l1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
          "+", 
          RowBox[{
           SuperscriptBox["lm", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
          RowBox[{
           SuperscriptBox["l2", "2"], " ", "M2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"JM", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.708067963024736*^9, {3.7081008211590147`*^9, 3.7081008435758867`*^9}, 
   3.708137325107339*^9, 3.708139609108975*^9, 3.708140496773178*^9, 
   3.708140717717827*^9, 3.7081466563968353`*^9, 3.708162916510455*^9, 
   3.708172729483234*^9, 3.7081729384438057`*^9, 3.708181737847156*^9, 
   3.70818343188901*^9, 3.70818483602179*^9, 3.708184901911689*^9, 
   3.7081849549355993`*^9, 3.711081447553238*^9, 3.711081567657364*^9, 
   3.712203584688748*^9, 3.7122130595586243`*^9, 3.712216274247135*^9, 
   3.7122554411057796`*^9, 3.712256289229344*^9, 3.712256878725256*^9, 
   3.712256973151243*^9, 3.7122571306024513`*^9, 3.712291068119998*^9, 
   3.7122925582035913`*^9, 3.712338973114229*^9, 3.712342651714778*^9, 
   3.7123443413618593`*^9, 3.712344649191984*^9, 3.712345028079516*^9, 
   3.712345162217351*^9, {3.712380669110598*^9, 3.712380673118037*^9}, 
   3.712384677172572*^9, 3.71238500155595*^9, 3.712385196041595*^9, 
   3.712385370304798*^9, 3.7123860097012*^9, 3.7123867311576633`*^9, 
   3.7123869077967997`*^9, 3.712387542941867*^9, 3.7123894975660353`*^9, 
   3.7123913371817217`*^9, 3.712394554106945*^9, 3.712395931637108*^9, 
   3.712408181346946*^9, 3.712408227975677*^9, 3.712411767106163*^9, 
   3.7124131747695837`*^9, 3.7124141135669737`*^9, 3.712465694871215*^9, 
   3.712465944267489*^9, 3.7124694568481693`*^9, 3.712469625314258*^9, 
   3.712470618801878*^9, 3.71272326850138*^9, 3.7127589781587887`*^9, 
   3.712760999898717*^9, 3.7127671158478727`*^9, 3.7127695417095413`*^9, 
   3.712827700912114*^9, 3.713065017590929*^9, 3.7136336301145077`*^9, 
   3.713707537700149*^9, 3.7140452366996813`*^9, 3.714056380496993*^9, 
   3.714056482049952*^9, 3.714057810846673*^9, 3.7140642455232143`*^9},
 ExpressionUUID -> "d7d239d1-0d76-46ec-9df5-906932e9308b"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Control law and closed loop", "Title",
 CellChangeTimes->{3.714043867254344*^9}],

Cell[TextData[{
 "Define control laws: as functions of q and ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["q", "."], TraditionalForm]]]
}], "Chapter",
 InitializationCell->True,
 CellChangeTimes->{{3.7081819873180227`*^9, 3.708181989419869*^9}, {
  3.708182498182735*^9, 3.7081825174518642`*^9}}],

Cell[CellGroupData[{

Cell["control law for uav 1 and 2: PD control laws", "Chapter",
 CellChangeTimes->{{3.708182019639147*^9, 3.708182055637903*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"U1cl", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "pz_", ",", "nbarx_", ",", "nbarz_", ",", "pmx_", ",", 
      "pmz_", ",", "nmx_", ",", "nmz_", ",", "P1x_", ",", "P1z_", ",", "P2x_",
       ",", "P2z_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "pxd_", ",", "pzd_", ",", "nbarxd_", ",", "nbarzd_", ",", "pmxd_", ",", 
      "pmzd_", ",", "nmxd_", ",", "nmzd_", ",", "P1xd_", ",", "P1zd_", ",", 
      "P2xd_", ",", "P2zd_"}], "}"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ueq", "[", 
    RowBox[{"[", 
     RowBox[{"2", ";;", "3"}], "]"}], "]"}], "+", 
   RowBox[{"M1", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"kpx1", " ", 
          RowBox[{"(", 
           RowBox[{"P1x", "-", "d1"}], ")"}]}], ",", 
         RowBox[{"kpz1", " ", 
          RowBox[{"(", 
           RowBox[{"P1z", "-", "l1"}], ")"}]}]}], "}"}]}], " ", "-", "  ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"kdx1", " ", "P1xd"}], ",", 
        RowBox[{"kdz1", " ", "P1zd"}]}], "}"}]}], 
     ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U2cl", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "pz_", ",", "nbarx_", ",", "nbarz_", ",", "pmx_", ",", 
      "pmz_", ",", "nmx_", ",", "nmz_", ",", "P1x_", ",", "P1z_", ",", "P2x_",
       ",", "P2z_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "pxd_", ",", "pzd_", ",", "nbarxd_", ",", "nbarzd_", ",", "pmxd_", ",", 
      "pmzd_", ",", "nmxd_", ",", "nmzd_", ",", "P1xd_", ",", "P1zd_", ",", 
      "P2xd_", ",", "P2zd_"}], "}"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ueq", "[", 
    RowBox[{"[", 
     RowBox[{"4", ";;", "5"}], "]"}], "]"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"M2", "+", "MM"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{"kpx2", 
          RowBox[{"(", " ", 
           RowBox[{"P2x", "-", "d2"}], ")"}]}], ",", 
         RowBox[{"kpz2", 
          RowBox[{"(", " ", 
           RowBox[{"P2z", "-", "l2"}], ")"}]}]}], "}"}]}], " ", "-", "  ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"kdx2", " ", "P2xd"}], ",", 
        RowBox[{"kdz2", " ", "P2zd"}]}], "}"}]}], ")"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.7081820496338253`*^9, 3.708182051364481*^9}, {
   3.712202461027039*^9, 3.712202461144662*^9}, {3.712202491898445*^9, 
   3.7122025036777573`*^9}, {3.7122025460438013`*^9, 3.712202571038122*^9}, {
   3.712204153052382*^9, 3.712204219651917*^9}, {3.712204682594892*^9, 
   3.712204696328224*^9}, {3.712204867061738*^9, 3.712204868402205*^9}, {
   3.712255472549773*^9, 3.712255571313534*^9}, 3.7127231098832617`*^9, 
   3.712723141487756*^9, {3.712723543392952*^9, 3.7127235448186283`*^9}, {
   3.714044759741539*^9, 3.714044764914549*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["control law for torque on manipulator (free of actuation)", "Chapter",
 CellChangeTimes->{{3.708182060666772*^9, 3.708182069711335*^9}, {
  3.71405564404185*^9, 3.7140556487553263`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"\[Tau]mancl", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "pz_", ",", "\[Alpha]bar_", ",", "\[Alpha]m_", ",", 
       "\[Alpha]c1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "pxd_", ",", "pzd_", ",", "\[Alpha]bard_", ",", "\[Alpha]md_", ",", 
       "\[Alpha]c1d_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"JM", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"k\[Tau]2p", " ", "\[Alpha]m"}], "+", 
      RowBox[{"k\[Tau]2d", " ", "\[Alpha]md"}]}], ")"}]}]}], "*)"}]], "Input",\

 CellChangeTimes->{
  3.7110821384084187`*^9, {3.7122024611590033`*^9, 3.712202461163165*^9}, {
   3.712202609367022*^9, 3.712202635751891*^9}, {3.712408342842629*^9, 
   3.712408346103488*^9}, 3.7140556394378633`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "For", " ", "convenience", " ", "I", " ", "need", " ", "to", " ", "define",
     " ", 
    RowBox[{"the", " ", "'"}], 
    RowBox[{"derivative", "'"}], " ", "of", " ", "q"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"q", "=", 
    RowBox[{"{", 
     RowBox[{
     "px", ",", "pz", ",", "\[Alpha]bar", ",", "\[Alpha]m", ",", 
      "\[Alpha]c1"}], "}"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"qd", "=", 
     RowBox[{"{", 
      RowBox[{
      "pxd", ",", "pzd", ",", "\[Alpha]bard", ",", "\[Alpha]md", ",", 
       "\[Alpha]c1d"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qdeq", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"Length", "[", "qd", "]"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.708182213824728*^9, 3.708182232207481*^9}, {
   3.71220246117942*^9, 3.712202461187558*^9}, {3.7122026093948593`*^9, 
   3.712202635770137*^9}, 3.712202815624939*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
combine all control laws: Don\[CloseCurlyQuote]t forget the equilibrium input!\
\>", "Chapter",
 CellChangeTimes->{{3.708182124094872*^9, 3.7081821596668453`*^9}, {
  3.708182487068285*^9, 3.70818249057577*^9}, {3.708182529210463*^9, 
  3.7081825387056293`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"recall", " ", "input"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"uu", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"control", " ", "law", " ", "for", " ", "each", " ", 
     RowBox[{"input", ":", " ", 
      RowBox[{"as", " ", "function", " ", "of", " ", "q", " ", "and", " ", 
       OverscriptBox["q", "."]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uucl", "[", 
     RowBox[{"q_", ",", "qd_"}], "]"}], ":=", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Tau]mancl", "[", 
          RowBox[{"q", ",", "qd"}], "]"}], "}"}], ","}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"U1cl", "[", 
       RowBox[{
        RowBox[{"g", "[", "q", "]"}], ",", 
        RowBox[{
         RowBox[{"Dg", "[", "q", "]"}], ".", "qd"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"U2cl", "[", 
       RowBox[{
        RowBox[{"g", "[", "q", "]"}], ",", 
        RowBox[{
         RowBox[{"Dg", "[", "q", "]"}], ".", "qd"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7081821697789927`*^9, 3.7081821723454723`*^9}, {
   3.7081822526260777`*^9, 3.70818228207806*^9}, {3.708182377301983*^9, 
   3.7081824101722937`*^9}, {3.7081835400972643`*^9, 
   3.7081835835560207`*^9}, {3.708183635596067*^9, 3.708183682316533*^9}, {
   3.708183718286434*^9, 3.708183733417137*^9}, {3.712255477599965*^9, 
   3.712255478611783*^9}, 3.712255583406383*^9, {3.712255721256022*^9, 
   3.7122557217709827`*^9}, {3.714055699075904*^9, 3.714055702016336*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\[Tau]man", ",", "U1x", ",", "U1z", ",", "U2x", ",", "U2z"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.712203637874134*^9, 3.712204242716817*^9, 3.7122047081021357`*^9, 
   3.7122047675207653`*^9, 3.712204876123884*^9, 3.712205863956192*^9, 
   3.712209666079414*^9, 3.7122124741950502`*^9, 3.7122130612235327`*^9, 
   3.7122162753451557`*^9, 3.7122555840085278`*^9, 3.7122556736279793`*^9, {
   3.712255722631712*^9, 3.7122557347171993`*^9}, 3.7122562896705523`*^9, 
   3.712256879143529*^9, 3.712256973888193*^9, 3.712257130939826*^9, 
   3.712291068643959*^9, 3.71229255908941*^9, 3.71233897350781*^9, 
   3.712342652073669*^9, 3.712344341714789*^9, 3.712344649709216*^9, 
   3.712345028537043*^9, 3.712345162789819*^9, 3.712380684731206*^9, 
   3.71238072668964*^9, 3.7123846776550817`*^9, 3.712385002043742*^9, 
   3.712385196634968*^9, 3.712385370784062*^9, 3.712386010111837*^9, 
   3.712386731227602*^9, 3.712386908374758*^9, 3.712387543378148*^9, 
   3.7123894979464684`*^9, 3.712391337734693*^9, 3.712394554614087*^9, 
   3.712395932108324*^9, 3.712408355983171*^9, 3.7124117672542973`*^9, 
   3.712413175173184*^9, 3.712414113690959*^9, 3.712465694995318*^9, 
   3.712465944394582*^9, 3.7124694572810163`*^9, 3.7124696257988577`*^9, 
   3.7124706192587843`*^9, 3.712723282364423*^9, 3.712723552632872*^9, 
   3.7127589787056503`*^9, 3.712761000269126*^9, 3.712767116301029*^9, 
   3.712769542171389*^9, 3.71282770136298*^9, 3.713065018199273*^9, 
   3.713633630745308*^9, 3.7137075380764103`*^9, {3.7140556939722013`*^9, 
   3.714055702877728*^9}, 3.7140563807899837`*^9, 3.714056482364195*^9, 
   3.714057811067801*^9, 3.714064245673682*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
compose function that maps input to linear/angular accelerations of q, with \
proposed control laws\
\>", "Chapter",
 CellChangeTimes->{{3.708182124094872*^9, 3.7081821596668453`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FUState", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "pz_", ",", "\[Alpha]bar_", ",", "\[Alpha]m_", ",", 
       "\[Alpha]c1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "pxd_", ",", "pzd_", ",", "\[Alpha]bard_", ",", "\[Alpha]md_", ",", 
       "\[Alpha]c1d_"}], "}"}]}], "]"}], "=", 
   RowBox[{"FU", "[", 
    RowBox[{"q", ",", 
     RowBox[{"uucl", "[", 
      RowBox[{"q", ",", "qd"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.70818236581586*^9, 3.7081823686731577`*^9}, {
   3.708182418454298*^9, 3.70818242625992*^9}, 3.708182524956933*^9, 
   3.708183745013349*^9, {3.7122024612288218`*^9, 3.7122024612335567`*^9}, {
   3.712202609410029*^9, 3.712202635785632*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["check equilibrium is still equilibrium", "Chapter",
 CellChangeTimes->{{3.708182545781909*^9, 3.7081825559502363`*^9}, 
   3.714055712505349*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GMatrix", "[", "qeq", "]"}], "-", 
   RowBox[{"FUState", "[", 
    RowBox[{"qeq", ",", "qdeq"}], "]"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{3.712202461249379*^9, 3.71220282355853*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.708182419439815*^9, 3.708182459327886*^9}, 
   3.7081834522219*^9, 3.708183747280048*^9, 3.708184837021894*^9, 
   3.7081849030394583`*^9, 3.708184956208845*^9, {3.711081470804797*^9, 
   3.711081478510476*^9}, 3.711081605986294*^9, 3.712203644131556*^9, 
   3.712204242992394*^9, 3.7122047083333063`*^9, 3.7122047677928553`*^9, 
   3.712204876422756*^9, 3.712205864223628*^9, 3.7122096663576937`*^9, 
   3.7122124744902287`*^9, 3.7122130616828403`*^9, 3.712216275577107*^9, 
   3.712255590241191*^9, 3.712255680760537*^9, 3.7122557350206003`*^9, 
   3.712256289846486*^9, 3.7122568792907667`*^9, 3.712256974298449*^9, 
   3.712257131063178*^9, 3.712291068863072*^9, 3.712292559234662*^9, 
   3.7123389736581717`*^9, 3.712342652202362*^9, 3.712344341847723*^9, 
   3.712344649876699*^9, 3.712345028651949*^9, 3.712345162917515*^9, 
   3.7123807291158247`*^9, 3.712384677803917*^9, 3.712385002209124*^9, 
   3.712385196961627*^9, 3.712385370923977*^9, 3.712386010242264*^9, 
   3.712386731259606*^9, 3.7123869085026093`*^9, 3.712387543471881*^9, 
   3.712389498077467*^9, 3.712391337865199*^9, 3.712394554778981*^9, 
   3.712395932315179*^9, 3.7124083593145943`*^9, 3.712411767336035*^9, 
   3.71241317533978*^9, 3.712414113749567*^9, 3.7124656950493107`*^9, 
   3.712465944451071*^9, 3.712469457453308*^9, 3.712469625965767*^9, 
   3.7124706194247513`*^9, 3.712723282516803*^9, 3.712723555204337*^9, 
   3.7127589789384737`*^9, 3.712761000398185*^9, 3.7127618434555273`*^9, 
   3.71276711645115*^9, 3.712769542358073*^9, 3.712827701500244*^9, 
   3.7130650183261127`*^9, 3.713633630880822*^9, 3.713707538209579*^9, 
   3.714055713977016*^9, 3.714056380891224*^9, 3.714056482513708*^9, 
   3.7140578111683083`*^9, 3.7140642457856903`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Find A matrix of closed loop", "Chapter",
 CellChangeTimes->{{3.7081825919386806`*^9, 3.708182599408729*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AMatrix", "=", 
   RowBox[{"LagrangeLinearizationClosedLoop", "[", 
    RowBox[{
    "qeq", ",", "g", ",", "Potential", ",", "Kinectic", ",", "FUState"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"AMatrix", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.70806690602981*^9, 3.708067137519293*^9}, 
   3.70806716823663*^9, {3.708067343481702*^9, 3.708067369864313*^9}, {
   3.708067405944409*^9, 3.708067479463253*^9}, {3.708067584088011*^9, 
   3.7080676056603327`*^9}, {3.70806764592771*^9, 3.70806769869061*^9}, {
   3.7080677483418503`*^9, 3.708067962566708*^9}, {3.70810080097167*^9, 
   3.708100842810926*^9}, 3.708100916994722*^9, {3.708101090871266*^9, 
   3.708101161330327*^9}, {3.7081368521598454`*^9, 3.7081368994090347`*^9}, {
   3.708137128767048*^9, 3.708137320915947*^9}, {3.708138685170187*^9, 
   3.708138802811664*^9}, {3.7081396456930723`*^9, 3.70813964600933*^9}, {
   3.708182574326517*^9, 3.708182616754509*^9}, {3.70818265533571*^9, 
   3.708182711715873*^9}, 3.7081829418049717`*^9, {3.7081830601761923`*^9, 
   3.7081830903641663`*^9}, {3.7081833263709173`*^9, 3.708183394278305*^9}, {
   3.708183756683989*^9, 3.708183788737091*^9}, {3.7122024612695*^9, 
   3.7122024613437853`*^9}, 3.712202781411571*^9, {3.712202815640732*^9, 
   3.712202823598898*^9}, 3.712202884239641*^9, {3.71220295764498*^9, 
   3.7122030487407923`*^9}, {3.712203087121792*^9, 3.712203087267913*^9}, 
   3.712255758385713*^9, {3.7122562582596903`*^9, 3.7122562616033363`*^9}, 
   3.714055870418263*^9},
 ExpressionUUID -> "20f9c02a-f665-46bc-84fe-7ffdbb395f4f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1"},
     {
      RowBox[{
       FractionBox[
        RowBox[{"kpx2", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{"kpx1", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpx1"}], " ", "M1"}], "-", 
           RowBox[{"kpx2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "0", "0", 
      RowBox[{
       FractionBox[
        RowBox[{"kpx2", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpx2"}], " ", 
            SuperscriptBox["l2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "-", 
           FractionBox[
            RowBox[{"gravity", " ", "l2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "d2"}], " ", 
                RowBox[{"(", 
                 RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
               RowBox[{"d1", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
            RowBox[{"d1", "-", "d2"}]]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"kpx1", " ", "l1", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpx1"}], " ", 
            SuperscriptBox["l1", "2"], " ", "M1"}], "+", 
           FractionBox[
            RowBox[{"gravity", " ", "l1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "d1"}], " ", "M1"}], "+", 
               RowBox[{"d2", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}]}], 
            RowBox[{"d1", "-", "d2"}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], 
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"kdx2", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{"kdx1", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kdx1"}], " ", "M1"}], "-", 
           RowBox[{"kdx2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "0", "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"kdx2", " ", 
          SuperscriptBox["l2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"l2", " ", "M2"}], "+", 
            RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
          "+", 
          RowBox[{
           SuperscriptBox["lm", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
          RowBox[{
           SuperscriptBox["l2", "2"], " ", "M2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"JM", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "+", 
       FractionBox[
        RowBox[{"kdx2", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "0"},
     {"0", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpz1"}], " ", "M1"}], "-", 
           RowBox[{"kpz2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "M1"}], "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d1"}], " ", "kpz1", " ", "M1"}], "-", 
           RowBox[{"d2", " ", "kpz2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d1"}], " ", "kpz1", " ", "M1"}], "-", 
           RowBox[{"d2", " ", "kpz2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "M1"}], "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["d1", "2"]}], " ", "kpz1", " ", "M1"}], "-", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "kpz2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "0", 
      "0", "0", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kdz1"}], " ", "M1"}], "-", 
           RowBox[{"kdz2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "M1"}], "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d1"}], " ", "kdz1", " ", "M1"}], "-", 
           RowBox[{"d2", " ", "kdz2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d1"}], " ", "kdz1", " ", "M1"}], "-", 
           RowBox[{"d2", " ", "kdz2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "M1"}], "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["d1", "2"]}], " ", "kdz1", " ", "M1"}], "-", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "kdz2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "0", 
      "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d1", " ", "M1"}], "+", 
            RowBox[{"d2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "kpz1"}], " ", "M1"}], "-", 
            RowBox[{"kpz2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "M1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"Jbar", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d1"}], " ", "kpz1", " ", "M1"}], "-", 
           RowBox[{"d2", " ", "kpz2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d1", " ", "M1"}], "+", 
            RowBox[{"d2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "d1"}], " ", "kpz1", " ", "M1"}], "-", 
            RowBox[{"d2", " ", "kpz2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "M1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"Jbar", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["d1", "2"]}], " ", "kpz1", " ", "M1"}], "-", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "kpz2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "0", 
      "0", "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d1", " ", "M1"}], "+", 
            RowBox[{"d2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "kdz1"}], " ", "M1"}], "-", 
            RowBox[{"kdz2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "M1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"Jbar", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d1"}], " ", "kdz1", " ", "M1"}], "-", 
           RowBox[{"d2", " ", "kdz2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d1", " ", "M1"}], "+", 
            RowBox[{"d2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "d1"}], " ", "kdz1", " ", "M1"}], "-", 
            RowBox[{"d2", " ", "kdz2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "M1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"Jbar", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["d1", "2"]}], " ", "kdz1", " ", "M1"}], "-", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "kdz2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "0", 
      "0"},
     {
      RowBox[{
       FractionBox[
        RowBox[{"kpx2", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{"kpx1", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpx1"}], " ", "M1"}], "-", 
           RowBox[{"kpx2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "0", "0", 
      RowBox[{
       FractionBox[
        RowBox[{"kpx2", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpx2"}], " ", 
            SuperscriptBox["l2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "-", 
           FractionBox[
            RowBox[{"gravity", " ", "l2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "d2"}], " ", 
                RowBox[{"(", 
                 RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
               RowBox[{"d1", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
            RowBox[{"d1", "-", "d2"}]]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"kpx1", " ", "l1", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpx1"}], " ", 
            SuperscriptBox["l1", "2"], " ", "M1"}], "+", 
           FractionBox[
            RowBox[{"gravity", " ", "l1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "d1"}], " ", "M1"}], "+", 
               RowBox[{"d2", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}]}], 
            RowBox[{"d1", "-", "d2"}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"kdx2", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{"kdx1", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kdx1"}], " ", "M1"}], "-", 
           RowBox[{"kdx2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "0", "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"kdx2", " ", 
          SuperscriptBox["l2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
          "+", 
          RowBox[{
           SuperscriptBox["lm", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
          RowBox[{
           SuperscriptBox["l2", "2"], " ", "M2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"JM", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "+", 
       FractionBox[
        RowBox[{"kdx2", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "0"},
     {
      RowBox[{
       FractionBox[
        RowBox[{"kpx2", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpx1"}], " ", "M1"}], "-", 
           RowBox[{"kpx2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{"kpx1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}], 
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]]}], "0", 
      "0", 
      RowBox[{
       FractionBox[
        RowBox[{"kpx2", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], 
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpx2"}], " ", 
            SuperscriptBox["l2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "-", 
           FractionBox[
            RowBox[{"gravity", " ", "l2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "d2"}], " ", 
                RowBox[{"(", 
                 RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
               RowBox[{"d1", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
            RowBox[{"d1", "-", "d2"}]]}], ")"}]}], 
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"kpx1", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpx1"}], " ", 
            SuperscriptBox["l1", "2"], " ", "M1"}], "+", 
           FractionBox[
            RowBox[{"gravity", " ", "l1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "d1"}], " ", "M1"}], "+", 
               RowBox[{"d2", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}]}], 
            RowBox[{"d1", "-", "d2"}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}], 
        RowBox[{
         SuperscriptBox["l1", "2"], " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"kdx2", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kdx1"}], " ", "M1"}], "-", 
           RowBox[{"kdx2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{"kdx1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}], 
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]]}], "0", 
      "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"kdx2", " ", 
          SuperscriptBox["l2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"l2", " ", "M2"}], "+", 
            RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
         RowBox[{"l1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}],
             "+", 
            RowBox[{
             SuperscriptBox["lm", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
            RowBox[{
             SuperscriptBox["l2", "2"], " ", "M2", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"JM", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]]}], "+", 
       FractionBox[
        RowBox[{"kdx2", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], 
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"kdx1", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "-", 
       FractionBox[
        RowBox[{"kdx1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.714055871876979*^9, 3.714056380986326*^9, 
  3.714056482628439*^9, 3.714057811293449*^9, 3.714064245884507*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Routh\[CloseCurlyQuote]s criterion", "Title",
 CellChangeTimes->{3.7140438716267977`*^9}],

Cell[CellGroupData[{

Cell["Controllable canonical form", "Chapter",
 CellChangeTimes->{{3.7120541198105907`*^9, 3.71205412486038*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"addrow", "[", "a_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"UnitVector", "[", 
       RowBox[{
        RowBox[{"Length", "[", "a", "]"}], ",", 
        RowBox[{
         RowBox[{"Length", "[", "a", "]"}], "+", "1", "-", 
         RowBox[{
          RowBox[{"Dimensions", "[", "#", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], "}"}], ",", "#"}], "]"}],
    "&"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC", "[", "a_", "]"}], ":=", 
  RowBox[{"Nest", "[", 
   RowBox[{
    RowBox[{"addrow", "[", "a", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"-", "a"}], "}"}], ",", 
    RowBox[{
     RowBox[{"Length", "[", "a", "]"}], "-", "1"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC", "[", 
   RowBox[{"{", 
    RowBox[{"a0", ",", "a1", ",", "a2"}], "}"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC", "[", 
   RowBox[{"{", 
    RowBox[{"a0", ",", "a1", ",", "a2", ",", "a3"}], "}"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC", "[", 
   RowBox[{"{", 
    RowBox[{"a0", ",", "a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}], "]"}], 
  "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7120552813651543`*^9, 3.712055332502823*^9}, {
  3.712055374880151*^9, 3.7120554005155563`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0"},
     {"0", "0", "1"},
     {
      RowBox[{"-", "a0"}], 
      RowBox[{"-", "a1"}], 
      RowBox[{"-", "a2"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.71205530000025*^9, 3.712055333328465*^9}, {
   3.712055390029583*^9, 3.712055400759265*^9}, 3.71205573325695*^9, 
   3.7121542746987667`*^9, 3.712156632599451*^9, 3.712161859194921*^9, 
   3.712165302505271*^9, 3.7123963734878473`*^9, 3.713020734005403*^9, 
   3.714055969645577*^9, 3.7140563810543003`*^9, 3.714056482717507*^9, 
   3.714057811370043*^9, 3.714064245936193*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"},
     {
      RowBox[{"-", "a0"}], 
      RowBox[{"-", "a1"}], 
      RowBox[{"-", "a2"}], 
      RowBox[{"-", "a3"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.71205530000025*^9, 3.712055333328465*^9}, {
   3.712055390029583*^9, 3.712055400759265*^9}, 3.71205573325695*^9, 
   3.7121542746987667`*^9, 3.712156632599451*^9, 3.712161859194921*^9, 
   3.712165302505271*^9, 3.7123963734878473`*^9, 3.713020734005403*^9, 
   3.714055969645577*^9, 3.7140563810543003`*^9, 3.714056482717507*^9, 
   3.714057811370043*^9, 3.714064245955079*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0"},
     {"0", "0", "1", "0", "0"},
     {"0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "1"},
     {
      RowBox[{"-", "a0"}], 
      RowBox[{"-", "a1"}], 
      RowBox[{"-", "a2"}], 
      RowBox[{"-", "a3"}], 
      RowBox[{"-", "a4"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.71205530000025*^9, 3.712055333328465*^9}, {
   3.712055390029583*^9, 3.712055400759265*^9}, 3.71205573325695*^9, 
   3.7121542746987667`*^9, 3.712156632599451*^9, 3.712161859194921*^9, 
   3.712165302505271*^9, 3.7123963734878473`*^9, 3.713020734005403*^9, 
   3.714055969645577*^9, 3.7140563810543003`*^9, 3.714056482717507*^9, 
   3.714057811370043*^9, 3.714064245968485*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Hurwitz conditions", "Chapter",
 CellChangeTimes->{{3.7120554792779493`*^9, 3.712055483753387*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NotebookEvaluate", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<hurwitz_conditions.nb\>\""}], "}"}], "]"}], "]"}], ";"}]], "Input",\

 CellChangeTimes->{{3.71005535745792*^9, 3.710055358482471*^9}, {
   3.710055419189004*^9, 3.710055459554541*^9}, {3.7100555370149403`*^9, 
   3.710055548671946*^9}, 3.710055638835634*^9, 3.710057803745392*^9, {
   3.7100599861952877`*^9, 3.710059990024391*^9}, 3.7101574160581427`*^9, {
   3.710157992771703*^9, 3.710157993807963*^9}, {3.712055524490918*^9, 
   3.712055546142333*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["C3", "Chapter",
 CellChangeTimes->{{3.7120554182278137`*^9, 3.712055419427719*^9}, {
  3.7120557198662043`*^9, 3.712055720104171*^9}, {3.7140559657180443`*^9, 
  3.714055966913781*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[CapitalGamma]\[CapitalGamma]3", "=", 
  RowBox[{"{", 
   RowBox[{"a0", ",", "a1", " ", ",", "a2"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC", "[", "\[CapitalGamma]\[CapitalGamma]3", "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Step4", "[", 
   RowBox[{"CC", "[", "\[CapitalGamma]\[CapitalGamma]3", "]"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7120554261282387`*^9, 3.7120554724783382`*^9}, {
  3.712055569984881*^9, 3.712055578546554*^9}, {3.714055954473703*^9, 
  3.714055963735249*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"a0", ",", "a1", ",", "a2"}], "}"}]], "Output",
 CellChangeTimes->{{3.712055460837102*^9, 3.7120554651485786`*^9}, {
   3.712055575169319*^9, 3.7120555788405037`*^9}, 3.712055735328806*^9, 
   3.712154280712085*^9, 3.712156635951193*^9, 3.7121618612552147`*^9, 
   3.712165305432456*^9, 3.712396375335417*^9, 3.7130207361398087`*^9, 
   3.7140559741018257`*^9, 3.714056383111548*^9, 3.7140564849542513`*^9, 
   3.714057813575218*^9, 3.7140642480051126`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0"},
     {"0", "0", "1"},
     {
      RowBox[{"-", "a0"}], 
      RowBox[{"-", "a1"}], 
      RowBox[{"-", "a2"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.712055460837102*^9, 3.7120554651485786`*^9}, {
   3.712055575169319*^9, 3.7120555788405037`*^9}, 3.712055735328806*^9, 
   3.712154280712085*^9, 3.712156635951193*^9, 3.7121618612552147`*^9, 
   3.712165305432456*^9, 3.712396375335417*^9, 3.7130207361398087`*^9, 
   3.7140559741018257`*^9, 3.714056383111548*^9, 3.7140564849542513`*^9, 
   3.714057813575218*^9, 3.714064248023822*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"1"},
      {"a2"},
      {
       RowBox[{
        RowBox[{"-", "a0"}], "+", 
        RowBox[{"a1", " ", "a2"}]}]},
      {"a0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.712055460837102*^9, 3.7120554651485786`*^9}, {
   3.712055575169319*^9, 3.7120555788405037`*^9}, 3.712055735328806*^9, 
   3.712154280712085*^9, 3.712156635951193*^9, 3.7121618612552147`*^9, 
   3.712165305432456*^9, 3.712396375335417*^9, 3.7130207361398087`*^9, 
   3.7140559741018257`*^9, 3.714056383111548*^9, 3.7140564849542513`*^9, 
   3.714057813575218*^9, 3.714064248035157*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[CapitalGamma]4 (all terms need to be positive)", "Chapter",
 CellChangeTimes->{{3.7120554182278137`*^9, 3.712055419427719*^9}, {
  3.712055595766025*^9, 3.712055596366538*^9}, {3.712055718178494*^9, 
  3.712055718429797*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalGamma]\[CapitalGamma]4", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fp", " ", "kp"}], ",", 
     RowBox[{"fp", "  ", "kv"}], ",", 
     RowBox[{"kp", "+", 
      RowBox[{"fp", 
       RowBox[{"(", " ", 
        RowBox[{"1", "+", "pp"}], ")"}]}]}], ",", "kv"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC", "[", "\[CapitalGamma]\[CapitalGamma]4", "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Step4", "[", 
   RowBox[{"CC", "[", "\[CapitalGamma]\[CapitalGamma]4", "]"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7120554261282387`*^9, 3.7120554724783382`*^9}, {
  3.712055569984881*^9, 3.712055660316914*^9}, {3.7123963787706137`*^9, 
  3.71239639648423*^9}, {3.712397311433783*^9, 3.712397328106955*^9}, {
  3.712397601258409*^9, 3.712397603489622*^9}, {3.713020723047752*^9, 
  3.7130207267376213`*^9}, {3.714055986337946*^9, 3.7140560169101763`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"},
     {
      RowBox[{
       RowBox[{"-", "fp"}], " ", "kp"}], 
      RowBox[{
       RowBox[{"-", "fp"}], " ", "kv"}], 
      RowBox[{
       RowBox[{"-", "kp"}], "-", 
       RowBox[{"fp", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "pp"}], ")"}]}]}], 
      RowBox[{"-", "kv"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.712055660818775*^9, 3.712055735445222*^9, 3.71215428081413*^9, 
   3.712156636053732*^9, 3.7121618613672247`*^9, 3.712165305600306*^9, {
   3.712396375421197*^9, 3.7123964007573843`*^9}, 3.712397329015139*^9, 
   3.7123976093705893`*^9, 3.713020736246664*^9, {3.714056004189702*^9, 
   3.714056017343246*^9}, 3.7140563832089376`*^9, 3.714056485072136*^9, 
   3.714057813693164*^9, 3.714064248087398*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"1"},
      {"kv"},
      {
       RowBox[{"kv", " ", 
        RowBox[{"(", 
         RowBox[{"kp", "+", 
          RowBox[{"fp", " ", "pp"}]}], ")"}]}]},
      {
       RowBox[{
        SuperscriptBox["fp", "2"], " ", 
        SuperscriptBox["kv", "2"], " ", "pp"}]},
      {
       RowBox[{"fp", " ", "kp"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.712055660818775*^9, 3.712055735445222*^9, 3.71215428081413*^9, 
   3.712156636053732*^9, 3.7121618613672247`*^9, 3.712165305600306*^9, {
   3.712396375421197*^9, 3.7123964007573843`*^9}, 3.712397329015139*^9, 
   3.7123976093705893`*^9, 3.713020736246664*^9, {3.714056004189702*^9, 
   3.714056017343246*^9}, 3.7140563832089376`*^9, 3.714056485072136*^9, 
   3.714057813693164*^9, 3.714064248107139*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Crane system", "Title",
 CellChangeTimes->{{3.714043875169298*^9, 3.714043879175914*^9}}],

Cell["check notebook crane_system.nb", "Chapter",
 CellChangeTimes->{{3.714056081909184*^9, 3.714056100131195*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Manipulator free of actuation", "Title",
 CellChangeTimes->{3.7140438873314037`*^9}],

Cell[CellGroupData[{

Cell["\<\
special point: jerk does not depend on gains (jerk of other points do)\
\>", "Chapter",
 CellChangeTimes->{{3.712408836072962*^9, 3.7124088578216343`*^9}, {
  3.712409622752447*^9, 3.712409633418105*^9}, {3.712723110611459*^9, 
  3.712723110617111*^9}, {3.712723142110758*^9, 3.712723142116228*^9}, {
  3.71405632634144*^9, 3.714056333959029*^9}, {3.714056502213894*^9, 
  3.714056507964816*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"e", "[", "i_", "]"}], ":=", 
   RowBox[{"UnitVector", "[", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"Length", "[", "qt", "]"}]}], ",", "i"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"e", "[", "1", "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"e", "[", "4", "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"e", "[", "5", "]"}], "}"}]}], "]"}], ".", "AMatrix", ".", 
       "AMatrix", ".", "AMatrix"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"MM", "\[Rule]", " ", "0"}], ",", 
        RowBox[{"JM", "\[Rule]", " ", "0"}], ",", 
        RowBox[{"k\[Tau]2p", "\[Rule]", " ", "0"}], ",", 
        RowBox[{"k\[Tau]2d", "\[Rule]", " ", "0"}]}], "}"}]}], "//", 
     "Simplify"}], "//", "MatrixForm"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ps", " ", "=", " ", 
   RowBox[{
    RowBox[{"e", "[", "1", "]"}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"JM", "-", 
       RowBox[{"lm", " ", 
        RowBox[{"(", 
         RowBox[{"l2", "-", "lm"}], ")"}], " ", "MM"}]}], 
      RowBox[{
       RowBox[{"lm", " ", "m"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"l2", "-", "lm"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", "MM"}], ")"}]}]}]], 
     RowBox[{"e", "[", "4", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", "ps", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"e", "[", "1", "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"e", "[", "4", "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"e", "[", "5", "]"}], "}"}]}], "]"}], ".", "AMatrix", ".", 
    "AMatrix", ".", "AMatrix"}], "//", "Simplify"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.712394013101008*^9, 3.712394030403469*^9}, {
   3.7123940713257227`*^9, 3.7123940973298798`*^9}, 3.712408819374737*^9, {
   3.7124662533004*^9, 3.712466254838533*^9}, 3.7124662900987186`*^9, {
   3.712723110632769*^9, 3.7127231106382017`*^9}, {3.7127231421296577`*^9, 
   3.712723142134173*^9}, {3.712723326693326*^9, 3.712723343872018*^9}, {
   3.714056348212861*^9, 3.714056348670372*^9}, {3.714056418404934*^9, 
   3.714056424832775*^9}, 3.7140564880755033`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d2"}], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "lm"}], " ", "MM"}], "+", 
           RowBox[{"l2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{"gravity", " ", "l2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "M1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "lm"}], " ", "MM"}], "+", 
          RowBox[{"l2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}]]},
     {
      FractionBox[
       RowBox[{"kdx2", " ", "kpx2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"JM", "+", 
          RowBox[{"lm", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "l2"}], "+", "lm"}], ")"}], " ", "MM"}]}], ")"}], 
        " ", 
        RowBox[{"(", 
         RowBox[{"JM", "-", 
          RowBox[{"2", " ", "l2", " ", "lm", " ", "MM"}], "+", 
          RowBox[{
           SuperscriptBox["lm", "2"], " ", "MM"}], "+", 
          RowBox[{
           SuperscriptBox["l2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
          "+", 
          RowBox[{
           SuperscriptBox["lm", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
          RowBox[{
           SuperscriptBox["l2", "2"], " ", "M2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"JM", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]], "0",
       "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kdx2", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{"lm", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "l2"}], "+", "lm"}], ")"}], " ", "MM"}]}], ")"}], 
         " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d2"}], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"JM", " ", "kpx2"}], "+", 
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "lm"}], " ", "MM"}], "+", 
                 RowBox[{"l2", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
              RowBox[{"kpx2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "MM"}], "+", 
                 
                 RowBox[{
                  SuperscriptBox["lm", "2"], " ", "MM"}], "+", 
                 RowBox[{
                  SuperscriptBox["l2", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
           "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "lm"}], " ", "MM"}], "+", 
                 RowBox[{"l2", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
              RowBox[{"kpx2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"JM", "-", 
                 RowBox[{"2", " ", "l2", " ", "lm", " ", "MM"}], "+", 
                 RowBox[{
                  SuperscriptBox["lm", "2"], " ", "MM"}], "+", 
                 RowBox[{
                  SuperscriptBox["l2", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}],
             "+", 
            RowBox[{
             SuperscriptBox["lm", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
            RowBox[{
             SuperscriptBox["l2", "2"], " ", "M2", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"JM", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], 
          "2"]}]]}], 
      FractionBox[
       RowBox[{"gravity", " ", "kdx2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "M1"}], "-", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"M2", "+", "MM"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{"lm", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "l2"}], "+", "lm"}], ")"}], " ", "MM"}]}], ")"}], 
         "2"]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{"lm", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "l2"}], "+", "lm"}], ")"}], " ", "MM"}]}], ")"}], 
         " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["kdx2", "2"]}], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"kpx2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", 
               "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", "M2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox["kdx2", "2"]}], " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
              RowBox[{"kpx2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]]}], 
      "0", "0", 
      FractionBox[
       RowBox[{"l2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}]}], " ", 
           SuperscriptBox["kdx2", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"JM", "+", 
              RowBox[{"lm", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "l2"}], "+", "lm"}], ")"}], " ", "MM"}]}], 
             ")"}], "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", 
           SuperscriptBox["kdx2", "2"], " ", "l2", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "JM"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"l2", "-", "lm"}], ")"}], " ", "lm", " ", "MM"}]}], 
            ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "lm"}], " ", "MM"}], "+", 
             RowBox[{"l2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", "kpx2", " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"JM", "+", 
             RowBox[{
              SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
             RowBox[{
              SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], "-", 
             RowBox[{
              SuperscriptBox["lm", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "-", 
             RowBox[{
              SuperscriptBox["l2", "2"], " ", "M2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "MM"}], ")"}]}], "-", 
             RowBox[{"JM", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"l2", " ", "M2"}], "+", 
             RowBox[{"lm", " ", "MM"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], "-", 
             RowBox[{
              SuperscriptBox["lm", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "-", 
             RowBox[{
              SuperscriptBox["l2", "2"], " ", "M2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "MM"}], ")"}]}], "-", 
             RowBox[{"JM", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "d2"}], " ", 
              RowBox[{"(", 
               RowBox[{"gravity", "+", 
                RowBox[{"kpx2", " ", "l2"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
             RowBox[{"d1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"kpx2", " ", "l2", " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
                RowBox[{"gravity", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
            ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}]], 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "M1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"JM", "+", 
          RowBox[{
           SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
          RowBox[{
           SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
          "+", 
          RowBox[{
           SuperscriptBox["lm", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
          RowBox[{
           SuperscriptBox["l2", "2"], " ", "M2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"JM", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kdx2", " ", "kpx2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "lm"}], " ", "MM"}], "+", 
           RowBox[{"l2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"JM", "-", 
           RowBox[{"2", " ", "l2", " ", "lm", " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]]}], 
      "0", "0", 
      FractionBox[
       RowBox[{"kdx2", " ", "l2", " ", 
        RowBox[{"(", 
         RowBox[{"M2", "+", "MM"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "lm"}], " ", "MM"}], "+", 
          RowBox[{"l2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"JM", " ", "kpx2"}], "+", 
             RowBox[{"gravity", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "lm"}], " ", "MM"}], "+", 
                RowBox[{"l2", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
             RowBox[{"kpx2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"gravity", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "lm"}], " ", "MM"}], "+", 
                RowBox[{"l2", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
             RowBox[{"kpx2", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"JM", "-", 
                RowBox[{"2", " ", "l2", " ", "lm", " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}]], 
      FractionBox[
       RowBox[{"gravity", " ", "kdx2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "M1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"M2", "+", "MM"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"JM", "+", 
          RowBox[{"lm", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "l2"}], "+", "lm"}], ")"}], " ", "MM"}]}], ")"}], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "lm"}], " ", "MM"}], "+", 
          RowBox[{"l2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"M2", "+", "MM"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "lm"}], " ", "MM"}], "+", 
          RowBox[{"l2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["kdx2", "2"]}], " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "MM"}], "+", 
             RowBox[{
              SuperscriptBox["lm", "2"], " ", "MM"}], "+", 
             RowBox[{
              SuperscriptBox["l2", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"kpx2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", 
              "MM"}], "+", 
             RowBox[{
              SuperscriptBox["lm", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
             RowBox[{
              SuperscriptBox["l2", "2"], " ", "M2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"JM", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["kdx2", "2"]}], " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
             RowBox[{"kpx2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
          "+", 
          RowBox[{
           SuperscriptBox["lm", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
          RowBox[{
           SuperscriptBox["l2", "2"], " ", "M2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"JM", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]], "0",
       "0", 
      FractionBox[
       RowBox[{"l2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", 
           SuperscriptBox["kdx2", "2"], " ", "l2", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"lm", " ", "MM"}], "-", 
              RowBox[{"l2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", 
           SuperscriptBox["kdx2", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "JM"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"l2", "-", "lm"}], ")"}], " ", "lm", " ", "MM"}]}], 
            ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "lm"}], " ", "MM"}], "+", 
             RowBox[{"l2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", "kpx2", " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"l2", " ", "M2"}], "+", 
             RowBox[{"lm", " ", "MM"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], "-", 
             RowBox[{
              SuperscriptBox["lm", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "-", 
             RowBox[{
              SuperscriptBox["l2", "2"], " ", "M2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "MM"}], ")"}]}], "-", 
             RowBox[{"JM", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], "-", 
             RowBox[{
              SuperscriptBox["lm", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "-", 
             RowBox[{
              SuperscriptBox["l2", "2"], " ", "M2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "MM"}], ")"}]}], "-", 
             RowBox[{"JM", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "d2"}], " ", 
              RowBox[{"(", 
               RowBox[{"gravity", "+", 
                RowBox[{"kpx2", " ", "l2"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
             RowBox[{"d1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"kpx2", " ", "l2", " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
                RowBox[{"gravity", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
            ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}]], 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "M1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l2", " ", "M2"}], "+", 
          RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
          "+", 
          RowBox[{
           SuperscriptBox["lm", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
          RowBox[{
           SuperscriptBox["l2", "2"], " ", "M2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"JM", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"kdx2", " ", "kpx2", " ", 
          RowBox[{"(", 
           RowBox[{"l2", "-", "lm"}], ")"}], " ", "lm", " ", "MM", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "MM"}], "+", 
            RowBox[{
             SuperscriptBox["lm", "2"], " ", "MM"}], "+", 
            RowBox[{
             SuperscriptBox["l2", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"kdx1", " ", "kpx1", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", 
              "MM"}], "+", 
             RowBox[{
              SuperscriptBox["lm", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
             RowBox[{
              SuperscriptBox["l2", "2"], " ", "M2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], "+", 
         RowBox[{
          SuperscriptBox["JM", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "kdx2"}], " ", "kpx2", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}], "2"]}], "+", 
            RowBox[{"kdx1", " ", "kpx1", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], "2"]}]}], ")"}]}], 
         "-", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kdx2", " ", "kpx2", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "3"}], " ", "l2", " ", "lm", " ", "MM"}], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["lm", "2"], " ", "MM"}], "+", 
               RowBox[{
                SuperscriptBox["l2", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}], "-", 
            RowBox[{"2", " ", "kdx1", " ", "kpx1", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", 
                "MM"}], "+", 
               RowBox[{
                SuperscriptBox["lm", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
               RowBox[{
                SuperscriptBox["l2", "2"], " ", "M2", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
        RowBox[{"l1", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}],
             "+", 
            RowBox[{
             SuperscriptBox["lm", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
            RowBox[{
             SuperscriptBox["l2", "2"], " ", "M2", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"JM", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], 
          "2"]}]]}], "0", "0", 
      FractionBox[
       RowBox[{"kdx2", " ", "l2", " ", 
        RowBox[{"(", 
         RowBox[{"M2", "+", "MM"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "JM"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"l2", "-", "lm"}], ")"}], " ", "lm", " ", "MM"}]}], ")"}],
         " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"JM", " ", "kpx2"}], "+", 
             RowBox[{"gravity", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "lm"}], " ", "MM"}], "+", 
                RowBox[{"l2", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
             RowBox[{"kpx2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"gravity", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "lm"}], " ", "MM"}], "+", 
                RowBox[{"l2", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
             RowBox[{"kpx2", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"JM", "-", 
                RowBox[{"2", " ", "l2", " ", "lm", " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "l1", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"gravity", " ", "kdx2", " ", "l2", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "M1"}], "-", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "JM"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"l2", "-", "lm"}], ")"}], " ", "lm", " ", "MM"}]}], 
          ")"}]}], "-", 
        RowBox[{"gravity", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "M1"}], "-", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kdx2", " ", 
            RowBox[{"(", 
             RowBox[{"l2", "-", "lm"}], ")"}], " ", "lm", " ", "MM", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"kdx1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", 
               "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", "M2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kdx2"}], " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
              RowBox[{"kdx1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], "-", 
        RowBox[{"kdx1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " ", "kpx1", " ", "l1", " ", 
            SuperscriptBox["M1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"JM", "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d1", " ", 
               RowBox[{"(", 
                RowBox[{"gravity", "+", 
                 RowBox[{"kpx1", " ", "l1"}]}], ")"}], " ", "M1"}], "-", 
              RowBox[{"d2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kpx1", " ", "l1", " ", "M1"}], "+", 
                 RowBox[{"gravity", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], "-", 
              
              RowBox[{
               SuperscriptBox["lm", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M1", "+", "M2"}], ")"}], " ", "MM"}], "-", 
              
              RowBox[{
               SuperscriptBox["l2", "2"], " ", "M2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M1", "+", "MM"}], ")"}]}], "-", 
              RowBox[{"JM", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
             ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "l1", " ", "M1", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"kpx1", " ", 
         SuperscriptBox["l2", "4"], " ", 
         SuperscriptBox["m", "2"], " ", 
         SuperscriptBox["M2", "2"]}], "+", 
        RowBox[{"2", " ", "kpx1", " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["lm", "2"], " ", 
         SuperscriptBox["m", "2"], " ", "M2", " ", "MM"}], "+", 
        RowBox[{"2", " ", "kpx1", " ", 
         SuperscriptBox["l2", "4"], " ", "m", " ", 
         SuperscriptBox["M2", "2"], " ", "MM"}], "-", 
        RowBox[{
         SuperscriptBox["kdx2", "2"], " ", 
         SuperscriptBox["l2", "3"], " ", "lm", " ", "m", " ", 
         SuperscriptBox["M2", "2"], " ", "MM"}], "-", 
        RowBox[{"4", " ", "kpx1", " ", 
         SuperscriptBox["l2", "3"], " ", "lm", " ", "m", " ", 
         SuperscriptBox["M2", "2"], " ", "MM"}], "+", 
        RowBox[{"kpx2", " ", 
         SuperscriptBox["l2", "3"], " ", "lm", " ", "m", " ", 
         SuperscriptBox["M2", "2"], " ", "MM"}], "+", 
        RowBox[{
         SuperscriptBox["kdx2", "2"], " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["lm", "2"], " ", "m", " ", 
         SuperscriptBox["M2", "2"], " ", "MM"}], "+", 
        RowBox[{"2", " ", "kpx1", " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["lm", "2"], " ", "m", " ", 
         SuperscriptBox["M2", "2"], " ", "MM"}], "-", 
        RowBox[{"kpx2", " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["lm", "2"], " ", "m", " ", 
         SuperscriptBox["M2", "2"], " ", "MM"}], "+", 
        RowBox[{"kpx1", " ", 
         SuperscriptBox["lm", "4"], " ", 
         SuperscriptBox["m", "2"], " ", 
         SuperscriptBox["MM", "2"]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["kdx2", "2"], " ", 
         SuperscriptBox["l2", "3"], " ", "lm", " ", "m", " ", "M2", " ", 
         SuperscriptBox["MM", "2"]}], "+", 
        RowBox[{"kpx2", " ", 
         SuperscriptBox["l2", "3"], " ", "lm", " ", "m", " ", "M2", " ", 
         SuperscriptBox["MM", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["kdx2", "2"], " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["lm", "2"], " ", "m", " ", "M2", " ", 
         SuperscriptBox["MM", "2"]}], "+", 
        RowBox[{"2", " ", "kpx1", " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["lm", "2"], " ", "m", " ", "M2", " ", 
         SuperscriptBox["MM", "2"]}], "-", 
        RowBox[{"kpx2", " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["lm", "2"], " ", "m", " ", "M2", " ", 
         SuperscriptBox["MM", "2"]}], "-", 
        RowBox[{"4", " ", "kpx1", " ", "l2", " ", 
         SuperscriptBox["lm", "3"], " ", "m", " ", "M2", " ", 
         SuperscriptBox["MM", "2"]}], "+", 
        RowBox[{"kpx2", " ", "l2", " ", 
         SuperscriptBox["lm", "3"], " ", "m", " ", "M2", " ", 
         SuperscriptBox["MM", "2"]}], "+", 
        RowBox[{"2", " ", "kpx1", " ", 
         SuperscriptBox["lm", "4"], " ", "m", " ", "M2", " ", 
         SuperscriptBox["MM", "2"]}], "-", 
        RowBox[{"kpx2", " ", 
         SuperscriptBox["lm", "4"], " ", "m", " ", "M2", " ", 
         SuperscriptBox["MM", "2"]}], "+", 
        RowBox[{"kpx1", " ", 
         SuperscriptBox["l2", "4"], " ", 
         SuperscriptBox["M2", "2"], " ", 
         SuperscriptBox["MM", "2"]}], "-", 
        RowBox[{
         SuperscriptBox["kdx2", "2"], " ", 
         SuperscriptBox["l2", "3"], " ", "lm", " ", 
         SuperscriptBox["M2", "2"], " ", 
         SuperscriptBox["MM", "2"]}], "-", 
        RowBox[{"4", " ", "kpx1", " ", 
         SuperscriptBox["l2", "3"], " ", "lm", " ", 
         SuperscriptBox["M2", "2"], " ", 
         SuperscriptBox["MM", "2"]}], "+", 
        RowBox[{"kpx2", " ", 
         SuperscriptBox["l2", "3"], " ", "lm", " ", 
         SuperscriptBox["M2", "2"], " ", 
         SuperscriptBox["MM", "2"]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["kdx2", "2"], " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["lm", "2"], " ", 
         SuperscriptBox["M2", "2"], " ", 
         SuperscriptBox["MM", "2"]}], "+", 
        RowBox[{"6", " ", "kpx1", " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["lm", "2"], " ", 
         SuperscriptBox["M2", "2"], " ", 
         SuperscriptBox["MM", "2"]}], "-", 
        RowBox[{"3", " ", "kpx2", " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["lm", "2"], " ", 
         SuperscriptBox["M2", "2"], " ", 
         SuperscriptBox["MM", "2"]}], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["kdx2", "2"], " ", "l2", " ", 
         SuperscriptBox["lm", "3"], " ", 
         SuperscriptBox["M2", "2"], " ", 
         SuperscriptBox["MM", "2"]}], "-", 
        RowBox[{"4", " ", "kpx1", " ", "l2", " ", 
         SuperscriptBox["lm", "3"], " ", 
         SuperscriptBox["M2", "2"], " ", 
         SuperscriptBox["MM", "2"]}], "+", 
        RowBox[{"3", " ", "kpx2", " ", "l2", " ", 
         SuperscriptBox["lm", "3"], " ", 
         SuperscriptBox["M2", "2"], " ", 
         SuperscriptBox["MM", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["kdx2", "2"], " ", 
         SuperscriptBox["lm", "4"], " ", 
         SuperscriptBox["M2", "2"], " ", 
         SuperscriptBox["MM", "2"]}], "+", 
        RowBox[{"kpx1", " ", 
         SuperscriptBox["lm", "4"], " ", 
         SuperscriptBox["M2", "2"], " ", 
         SuperscriptBox["MM", "2"]}], "-", 
        RowBox[{"kpx2", " ", 
         SuperscriptBox["lm", "4"], " ", 
         SuperscriptBox["M2", "2"], " ", 
         SuperscriptBox["MM", "2"]}], "-", 
        RowBox[{
         SuperscriptBox["kdx2", "2"], " ", 
         SuperscriptBox["l2", "3"], " ", "lm", " ", "m", " ", 
         SuperscriptBox["MM", "3"]}], "+", 
        RowBox[{
         SuperscriptBox["kdx2", "2"], " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["lm", "2"], " ", "m", " ", 
         SuperscriptBox["MM", "3"]}], "+", 
        RowBox[{"kpx2", " ", "l2", " ", 
         SuperscriptBox["lm", "3"], " ", "m", " ", 
         SuperscriptBox["MM", "3"]}], "-", 
        RowBox[{"kpx2", " ", 
         SuperscriptBox["lm", "4"], " ", "m", " ", 
         SuperscriptBox["MM", "3"]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["kdx2", "2"], " ", 
         SuperscriptBox["l2", "3"], " ", "lm", " ", "M2", " ", 
         SuperscriptBox["MM", "3"]}], "+", 
        RowBox[{"kpx2", " ", 
         SuperscriptBox["l2", "3"], " ", "lm", " ", "M2", " ", 
         SuperscriptBox["MM", "3"]}], "+", 
        RowBox[{"6", " ", 
         SuperscriptBox["kdx2", "2"], " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["lm", "2"], " ", "M2", " ", 
         SuperscriptBox["MM", "3"]}], "-", 
        RowBox[{"3", " ", "kpx2", " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["lm", "2"], " ", "M2", " ", 
         SuperscriptBox["MM", "3"]}], "-", 
        RowBox[{"6", " ", 
         SuperscriptBox["kdx2", "2"], " ", "l2", " ", 
         SuperscriptBox["lm", "3"], " ", "M2", " ", 
         SuperscriptBox["MM", "3"]}], "+", 
        RowBox[{"3", " ", "kpx2", " ", "l2", " ", 
         SuperscriptBox["lm", "3"], " ", "M2", " ", 
         SuperscriptBox["MM", "3"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["kdx2", "2"], " ", 
         SuperscriptBox["lm", "4"], " ", "M2", " ", 
         SuperscriptBox["MM", "3"]}], "-", 
        RowBox[{"kpx2", " ", 
         SuperscriptBox["lm", "4"], " ", "M2", " ", 
         SuperscriptBox["MM", "3"]}], "-", 
        RowBox[{
         SuperscriptBox["kdx2", "2"], " ", 
         SuperscriptBox["l2", "3"], " ", "lm", " ", 
         SuperscriptBox["MM", "4"]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["kdx2", "2"], " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["lm", "2"], " ", 
         SuperscriptBox["MM", "4"]}], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["kdx2", "2"], " ", "l2", " ", 
         SuperscriptBox["lm", "3"], " ", 
         SuperscriptBox["MM", "4"]}], "+", 
        RowBox[{
         SuperscriptBox["kdx2", "2"], " ", 
         SuperscriptBox["lm", "4"], " ", 
         SuperscriptBox["MM", "4"]}], "-", 
        RowBox[{
         SuperscriptBox["kdx1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}],
             "+", 
            RowBox[{
             SuperscriptBox["lm", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
            RowBox[{
             SuperscriptBox["l2", "2"], " ", "M2", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], "-", 
        RowBox[{
         SuperscriptBox["JM", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["kdx1", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], "2"]}], "-", 
           RowBox[{"kpx1", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox["kdx2", "2"]}], " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
              RowBox[{"kpx2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], "+", 
        RowBox[{"JM", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            SuperscriptBox["kdx1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", 
               "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", "M2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"2", " ", "kpx1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", 
               "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", "M2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["kdx2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "3"}], " ", "l2", " ", "lm", " ", "MM"}], "+", 
                 
                 RowBox[{"2", " ", 
                  SuperscriptBox["lm", "2"], " ", "MM"}], "+", 
                 RowBox[{
                  SuperscriptBox["l2", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}], "-", 
              RowBox[{"kpx2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["l2", "2"], " ", "M2", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
                 RowBox[{
                  SuperscriptBox["lm", "2"], " ", "MM", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", " ", "m"}], "+", 
                    RowBox[{"2", " ", "M2"}], "+", "MM"}], ")"}]}], "-", 
                 RowBox[{"l2", " ", "lm", " ", "MM", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", 
                    RowBox[{"3", " ", "M2"}], "+", "MM"}], ")"}]}]}], 
                ")"}]}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{"l1", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}]], 
      "0", "0", 
      FractionBox[
       RowBox[{"l2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", 
           SuperscriptBox["kdx2", "2"], " ", "l2", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "JM"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"l2", "-", "lm"}], ")"}], " ", "lm", " ", "MM"}]}], 
            ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "lm"}], " ", "MM"}], "+", 
             RowBox[{"l2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", "kpx2", " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"JM", "+", 
             RowBox[{
              SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
             RowBox[{
              SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], "-", 
             RowBox[{
              SuperscriptBox["lm", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "-", 
             RowBox[{
              SuperscriptBox["l2", "2"], " ", "M2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "MM"}], ")"}]}], "-", 
             RowBox[{"JM", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", "kdx1", " ", "kdx2", " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "JM"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"l2", "-", "lm"}], ")"}], " ", "lm", " ", "MM"}]}], 
            ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", 
              "MM"}], "+", 
             RowBox[{
              SuperscriptBox["lm", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
             RowBox[{
              SuperscriptBox["l2", "2"], " ", "M2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
             RowBox[{"JM", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"l2", " ", "M2"}], "+", 
             RowBox[{"lm", " ", "MM"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], "-", 
             RowBox[{
              SuperscriptBox["lm", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "-", 
             RowBox[{
              SuperscriptBox["l2", "2"], " ", "M2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "MM"}], ")"}]}], "-", 
             RowBox[{"JM", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "d2"}], " ", 
              RowBox[{"(", 
               RowBox[{"gravity", "+", 
                RowBox[{"kpx2", " ", "l2"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
             RowBox[{"d1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"kpx2", " ", "l2", " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
                RowBox[{"gravity", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
            ")"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", "kdx2", " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "JM"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"l2", "-", "lm"}], ")"}], " ", "lm", " ", "MM"}]}], 
            ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"kdx2", " ", 
              RowBox[{"(", 
               RowBox[{"l2", "-", "lm"}], ")"}], " ", "lm", " ", "MM", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
             RowBox[{"kdx1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", 
                 "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", "M2", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
             RowBox[{"JM", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "kdx2"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
                RowBox[{"kdx1", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
            ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "l1", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}]], 
      RowBox[{
       SuperscriptBox["kdx1", "2"], "+", 
       FractionBox[
        RowBox[{"kpx1", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpx1"}], " ", "l1", " ", "M1"}], "+", 
           FractionBox[
            RowBox[{"gravity", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "d1"}], " ", "M1"}], "+", 
               RowBox[{"d2", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}]}], 
            RowBox[{"d1", "-", "d2"}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}], 
        RowBox[{"l1", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.714056387998537*^9, 3.714056402404583*^9}, {
   3.7140564905660257`*^9, 3.714056497186961*^9}, 3.714057818815239*^9, 
   3.714064253040938*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ps", ".", "AMatrix", ".", "AMatrix", ".", "AMatrix"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.712758989594449*^9, 3.7127589922919073`*^9}, {
  3.712759062730459*^9, 3.712759072876652*^9}, {3.7140564277396173`*^9, 
  3.714056444098071*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"gravity", " ", "l2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d2"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d1", "-", "d2"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "lm"}], " ", "MM"}], "+", 
        RowBox[{"l2", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}]]}], ",", 
   FractionBox[
    RowBox[{"gravity", " ", "l2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "d1"}], " ", "M1"}], "+", 
       RowBox[{"d2", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"d1", "-", "d2"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "lm"}], " ", "MM"}], "+", 
       RowBox[{"l2", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.712758994204515*^9, 3.7127590732754507`*^9, 
  3.712761003025012*^9, 3.7127618459129877`*^9, 3.7127623732205687`*^9, 
  3.7127664449648952`*^9, 3.71276712385712*^9, 3.7127679794266148`*^9, 
  3.7127686445703917`*^9, 3.71276954890982*^9, 3.7127699778088617`*^9, 
  3.7128277090034924`*^9, 3.713065025241403*^9, 3.71306528154767*^9, 
  3.713065425721046*^9, 3.713065597493137*^9, 3.713065874984508*^9, 
  3.7136336379989653`*^9, 3.713707545213378*^9, 3.714056490933104*^9, 
  3.714057818965214*^9, 3.714064253181201*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["similarity matrix", "Chapter",
 CellChangeTimes->{{3.7124089815949183`*^9, 3.712408988372088*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P", "=", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"e", "[", "2", "]"}], ",", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ".", "AMatrix"}], ",", 
       RowBox[{"(*", 
        RowBox[{"z", " ", "bar", " ", "linear", " ", "motion"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ".", "AMatrix"}], ",", 
       RowBox[{"(*", 
        RowBox[{"bar", " ", "angular", " ", "motion"}], "*)"}], 
       "\[IndentingNewLine]", "ps", ",", 
       RowBox[{"ps", ".", "AMatrix"}], ",", 
       RowBox[{"ps", ".", "AMatrix", ".", "AMatrix"}], ",", 
       RowBox[{"ps", ".", "AMatrix", ".", "AMatrix", ".", "AMatrix"}], ",", 
       RowBox[{"(*", 
        RowBox[{"special", " ", "point", " ", "motion", " ", "cable"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"l2", " ", 
          RowBox[{"e", "[", "4", "]"}]}], "-", 
         RowBox[{"l1", " ", 
          RowBox[{"e", "[", "5", "]"}]}]}], ")"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l2", " ", 
           RowBox[{"e", "[", "4", "]"}]}], "-", 
          RowBox[{"l1", " ", 
           RowBox[{"e", "[", "5", "]"}]}]}], ")"}], ".", "AMatrix"}]}], " ", 
      RowBox[{"(*", 
       RowBox[{"angle", " ", "difference", " ", "motion"}], "*)"}], 
      "\[IndentingNewLine]", "}"}], "//", "Simplify"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.712394159969154*^9, 3.712394170517374*^9}, 
   3.7123945894434*^9, 3.7124092519420977`*^9, {3.7124095945150537`*^9, 
   3.7124096048249397`*^9}, {3.712467229859316*^9, 3.7124672726388273`*^9}, {
   3.712467402025887*^9, 3.712467412954605*^9}, {3.712467769641306*^9, 
   3.7124677765999727`*^9}, {3.712468033232441*^9, 3.7124680519759417`*^9}, {
   3.712468951766073*^9, 3.712469006514605*^9}, {3.712723113308708*^9, 
   3.712723113356555*^9}, {3.712723144820746*^9, 3.712723144871162*^9}, {
   3.712723374675494*^9, 3.7127234022923937`*^9}, {3.712762379595105*^9, 
   3.7127623872714148`*^9}, {3.712762457342751*^9, 3.71276246141744*^9}, {
   3.712766406166093*^9, 3.712766419895014*^9}, {3.712766957981159*^9, 
   3.7127669669810333`*^9}, {3.712767029690189*^9, 3.7127670389672203`*^9}, {
   3.712767181525818*^9, 3.712767185709366*^9}, {3.712767239838916*^9, 
   3.712767244592454*^9}, {3.712767299536499*^9, 3.7127673022744904`*^9}, {
   3.712767403817275*^9, 3.7127674090436583`*^9}, {3.712767466498908*^9, 
   3.7127674674088917`*^9}, {3.712769852028399*^9, 3.712769896674177*^9}, {
   3.712769936120111*^9, 3.7127699413621473`*^9}, {3.713065057411643*^9, 
   3.713065081795656*^9}, {3.7130651688160267`*^9, 3.713065229373066*^9}, {
   3.713065293798737*^9, 3.7130652956431*^9}, {3.7130653500416317`*^9, 
   3.7130653528883343`*^9}, {3.7130654024918623`*^9, 
   3.7130654078889637`*^9}, {3.713065643281951*^9, 3.713065646026826*^9}, {
   3.7140565231323*^9, 3.7140565692832747`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Similar state matrix: it is block triangular", "Chapter",
 CellChangeTimes->{{3.714056584636355*^9, 3.714056588788849*^9}, {
  3.714056750017456*^9, 3.714056759509144*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AT", "=", 
   RowBox[{"P", ".", "AMatrix", ".", 
    RowBox[{"Inverse", "[", "P", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7123847134213867`*^9, 3.712384827780115*^9}, {
   3.7123850076117983`*^9, 3.7123850098161*^9}, {3.712386697154078*^9, 
   3.7123867063382053`*^9}, {3.712386914718993*^9, 3.71238692572136*^9}, 
   3.712394615038212*^9, {3.712409256546166*^9, 3.712409258882004*^9}, 
   3.714056574043508*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AT", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
      RowBox[{"d2", "\[Rule]", 
       RowBox[{"-", "d"}]}], ",", 
      RowBox[{"lm", "\[Rule]", " ", "l2"}]}], "}"}]}], "//", "Simplify"}], "//",
   "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.712465948912613*^9, 3.712465979724781*^9}, 
   3.712723113374526*^9, {3.712723409694367*^9, 3.712723411381716*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"kpz1", "+", "kpz2"}], ")"}], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kpz1", " ", "M1"}], "+", 
            RowBox[{"kpz2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "M1", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"m", " ", 
             RowBox[{"(", 
              RowBox[{"M1", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"kdz1", "+", "kdz2"}], ")"}], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kdz1", " ", "M1"}], "+", 
            RowBox[{"kdz2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "M1", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"m", " ", 
             RowBox[{"(", 
              RowBox[{"M1", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}]]}], 
      FractionBox[
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           SuperscriptBox["d", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"kpz1", "-", "kpz2"}], ")"}], " ", "M1", " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"Jbar", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "kpz1"}], " ", "M1"}], "+", 
             RowBox[{"kpz2", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"Jbar", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"m", " ", 
            RowBox[{"(", 
             RowBox[{"M1", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}]], 
      FractionBox[
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           SuperscriptBox["d", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"kdz1", "-", "kdz2"}], ")"}], " ", "M1", " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"Jbar", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "kdz1"}], " ", "M1"}], "+", 
             RowBox[{"kdz2", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"Jbar", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"m", " ", 
            RowBox[{"(", 
             RowBox[{"M1", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}]], "0",
       "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"kpz2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "-", 
          RowBox[{"kpz1", " ", "M1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"Jbar", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"m", " ", 
            RowBox[{"(", 
             RowBox[{"M1", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}]], 
      FractionBox[
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"kdz2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "-", 
          RowBox[{"kdz1", " ", "M1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"Jbar", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"m", " ", 
            RowBox[{"(", 
             RowBox[{"M1", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpz2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"kpz1", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "M1", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"m", " ", 
             RowBox[{"(", 
              RowBox[{"M1", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kdz2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"kdz1", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "M1", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"m", " ", 
             RowBox[{"(", 
              RowBox[{"M1", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}]]}], 
      "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kpx2"}], " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
              RowBox[{"kpx1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
           
           RowBox[{"l2", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpx1", " ", "l2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
              RowBox[{"kpx2", " ", "l1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}]}],
           ")"}]}], 
        RowBox[{"2", " ", "l1", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kdx2"}], " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
              RowBox[{"kdx1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
           
           RowBox[{"l2", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kdx1", " ", "l2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
              RowBox[{"kdx2", " ", "l1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}]}],
           ")"}]}], 
        RowBox[{"2", " ", "l1", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"gravity", " ", 
          SuperscriptBox["l2", "2"], " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["l2", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M1"}], ")"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"m", "+", 
                RowBox[{"2", " ", "M1"}]}], ")"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"JM", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"m", "+", 
                RowBox[{"2", " ", "M1"}]}], ")"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"2", " ", "l1", " ", "l2", " ", "M1", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", 
               RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["l1", "2"], " ", "M1", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"m", "+", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}]}], 
           ")"}]}], "+", 
         RowBox[{"2", " ", "l1", " ", 
          RowBox[{"(", 
           RowBox[{"JM", "+", 
            RowBox[{
             SuperscriptBox["l2", "2"], " ", "m"}]}], ")"}], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"JM", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", 
               RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "kpx2"}], " ", 
                RowBox[{"(", 
                 RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
               RowBox[{"kpx1", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
            RowBox[{"l2", " ", "m", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"kpx1", " ", "l2", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", 
                  RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
               RowBox[{"kpx2", " ", "l1", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", 
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
              ")"}]}]}], ")"}]}]}], 
        RowBox[{"2", " ", "l1", " ", "l2", " ", "m", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
           RowBox[{"l1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "m"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kdx2"}], " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
              RowBox[{"kdx1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
           
           RowBox[{"l2", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kdx1", " ", "l2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
              RowBox[{"kdx2", " ", "l1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}]}],
           ")"}]}], 
        RowBox[{"l2", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
           RowBox[{"l1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"JM", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", "M1"}]}], ")"}]}], "-", 
              RowBox[{"l1", " ", "l2", " ", "m", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}], 
            " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"kpx1", "-", "kpx2"}], ")"}], " ", 
               SuperscriptBox["l2", "2"], " ", "m", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
              RowBox[{"JM", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kpx2"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
                 RowBox[{"kpx1", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
             ")"}]}], "+", 
           RowBox[{"gravity", " ", "l2", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"JM", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
              
              RowBox[{"l2", " ", "m", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"l2", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", 
                    RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"M2", "+", "MM"}], ")"}]}], "-", 
                 RowBox[{"l1", " ", "M1", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
                ")"}]}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"4", " ", "l1", " ", "l2", " ", 
         SuperscriptBox["m", "2"], " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
           RowBox[{"l1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"JM", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M1"}]}], ")"}]}], "-", 
          RowBox[{"l1", " ", "l2", " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"kdx1", "-", "kdx2"}], ")"}], " ", 
           SuperscriptBox["l2", "2"], " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"JM", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "kdx2"}], " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
             RowBox[{"kdx1", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], 
       RowBox[{"2", " ", "l1", " ", "l2", " ", 
        SuperscriptBox["m", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["l2", "2"], " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"JM", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
          RowBox[{"l1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}]]},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1"},
     {"0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"kpx1", "-", "kpx2"}], ")"}], " ", 
          SuperscriptBox["l2", "2"], " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "kpx2"}], " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"kpx1", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"kdx1", "-", "kdx2"}], ")"}], " ", 
          SuperscriptBox["l2", "2"], " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "kdx2"}], " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"kdx1", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "l1", " ", 
          RowBox[{"(", 
           RowBox[{"JM", "+", 
            RowBox[{
             SuperscriptBox["l2", "2"], " ", "m"}]}], ")"}], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"kpx1", "-", "kpx2"}], ")"}], " ", 
             SuperscriptBox["l2", "2"], " ", "m", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"JM", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "kpx2"}], " ", 
                RowBox[{"(", 
                 RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
               RowBox[{"kpx1", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
           ")"}]}], "+", 
         RowBox[{"gravity", " ", 
          SuperscriptBox["l2", "2"], " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"JM", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", 
               RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"l2", " ", "m", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"l2", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", 
                  RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"M2", "+", "MM"}], ")"}]}], "-", 
               RowBox[{"l1", " ", "M1", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", 
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
              ")"}]}]}], ")"}]}]}], 
        RowBox[{"gravity", " ", "l2", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
           RowBox[{"l1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "l1", " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "m"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"kdx1", "-", "kdx2"}], ")"}], " ", 
            SuperscriptBox["l2", "2"], " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kdx2"}], " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
              RowBox[{"kdx1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], 
        RowBox[{"gravity", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
           RowBox[{"l1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "gravity"}], " ", "l2", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}], "+", 
        RowBox[{"2", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["JM", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kpx2"}], " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
              RowBox[{"kpx1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], "-", 
           
           RowBox[{
            SuperscriptBox["l2", "3"], " ", 
            SuperscriptBox["m", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpx2", " ", "l2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
              RowBox[{"kpx1", " ", "l1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
           "-", 
           RowBox[{"JM", " ", "l2", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "kpx2", " ", "l2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
              RowBox[{"kpx1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "l2"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", 
                    RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
                 RowBox[{"l1", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["m", "2"], "+", 
                    RowBox[{"3", " ", "m", " ", 
                    RowBox[{"(", 
                    RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"M2", "+", "MM"}], ")"}], "2"]}]}], ")"}]}]}], 
                ")"}]}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{"2", " ", "l2", " ", "m", " ", "M1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["l2", "2"], " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"JM", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
          RowBox[{"l1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["JM", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kdx2"}], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"kdx1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], "-", 
        RowBox[{
         SuperscriptBox["l2", "3"], " ", 
         SuperscriptBox["m", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kdx2", " ", "l2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
           RowBox[{"kdx1", " ", "l1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}], "-", 
        RowBox[{"JM", " ", "l2", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "kdx2", " ", "l2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"kdx1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "l2"}], " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
              RowBox[{"l1", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["m", "2"], "+", 
                 RowBox[{"3", " ", "m", " ", 
                  RowBox[{"(", 
                   RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
                 RowBox[{"2", " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"M2", "+", "MM"}], ")"}], "2"]}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}]}], 
       RowBox[{"l2", " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["l2", "2"], " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"JM", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
          RowBox[{"l1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7127234164090033`*^9, 3.712723573494348*^9, 3.712761005625692*^9, 
   3.7127618474460907`*^9, 3.7127623934810467`*^9, 3.7127624658215027`*^9, 
   3.712766446706587*^9, 3.712767257167861*^9, 3.712767313437351*^9, 
   3.71276747265055*^9, 3.712767981189618*^9, 3.712768645935603*^9, 
   3.712769551272025*^9, 3.712769869414138*^9, {3.7127699021583643`*^9, 
   3.7127699070421762`*^9}, 3.7127699457286587`*^9, 3.7127699790164413`*^9, 
   3.712827712179916*^9, 3.713065027654657*^9, 3.7130650901779833`*^9, 
   3.7130651882924557`*^9, {3.713065234557905*^9, 3.7130652455924873`*^9}, 
   3.7130652833622313`*^9, 3.71306536157056*^9, 3.713065432831092*^9, 
   3.71306565838931*^9, 3.713065876251315*^9, 3.713633652979382*^9, 
   3.7137075478613787`*^9, 3.7140565780894823`*^9, 3.714057821428543*^9, 
   3.714064255711429*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["diagonalize first block in similar state matrix", "Chapter",
 CellChangeTimes->{{3.714056732202793*^9, 3.714056767987051*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{"AT", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "4"}], ",", 
      RowBox[{"1", ";;", "4"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"solz", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"AofInterest", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}], ",", 
        RowBox[{"AofInterest", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "4"}], "]"}], "]"}]}], "}"}], "\[Equal]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"kpz1", ",", "kdz1"}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.7081841199666452`*^9, 3.708184154982211*^9}, {
  3.708184199145011*^9, 3.708184207749238*^9}, {3.712202462004678*^9, 
  3.712202462027454*^9}, {3.71220282361909*^9, 3.712202823622756*^9}, {
  3.7123808688299522`*^9, 3.712380909067647*^9}, {3.714056803567523*^9, 
  3.714056851345241*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"kpz1", "\[Rule]", 
     FractionBox[
      RowBox[{"d2", " ", "kpz2", " ", 
       RowBox[{"(", 
        RowBox[{"Jbar", "+", 
         RowBox[{"d1", " ", 
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", "M1"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"M2", "+", "MM"}], ")"}]}], 
      RowBox[{"d1", " ", "M1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "Jbar"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]]}], ",", 
    RowBox[{"kdz1", "\[Rule]", 
     FractionBox[
      RowBox[{"d2", " ", "kdz2", " ", 
       RowBox[{"(", 
        RowBox[{"Jbar", "+", 
         RowBox[{"d1", " ", 
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", "M1"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"M2", "+", "MM"}], ")"}]}], 
      RowBox[{"d1", " ", "M1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "Jbar"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.712203666065926*^9, 3.712204244531665*^9, 3.71220470996702*^9, 
   3.712204769066145*^9, 3.7122048774568367`*^9, 3.712205865159634*^9, 
   3.712209557401576*^9, 3.712209667402553*^9, 3.7122124754336348`*^9, 
   3.7122130644206123`*^9, 3.712256367177785*^9, 3.71225688072619*^9, 
   3.7122569763349133`*^9, 3.7122910711066093`*^9, 3.7122925611294613`*^9, 
   3.712338975292409*^9, 3.712342653573966*^9, 3.712344343667796*^9, 
   3.712380751470664*^9, 3.7123809098966846`*^9, 3.7123846792609262`*^9, 
   3.7123850037354*^9, 3.712385198545125*^9, 3.712385372346058*^9, 
   3.712386731827084*^9, 3.712386909873889*^9, 3.712387544521954*^9, 
   3.712389499097478*^9, 3.7123913388843727`*^9, 3.712394555913679*^9, 
   3.712395933717825*^9, 3.712408417234202*^9, 3.712409157578464*^9, 
   3.7124117684364567`*^9, 3.7124131765664*^9, 3.712414114425144*^9, 
   3.7124656957880096`*^9, 3.712465945228825*^9, 3.712466740771186*^9, 
   3.7124670065146313`*^9, 3.7124672151237288`*^9, 3.712467589912981*^9, 
   3.71246780416518*^9, 3.712468085506937*^9, 3.712468166276552*^9, 
   3.712468292103978*^9, 3.712469094269301*^9, 3.712469308651083*^9, 
   3.7124694588885727`*^9, 3.712469627169257*^9, 3.7124706208258877`*^9, 
   3.712723288819703*^9, 3.712723567164588*^9, 3.712758980589326*^9, 
   3.712761001182406*^9, 3.712761844287571*^9, 3.712762371585347*^9, 
   3.712766443408937*^9, 3.7127671179982777`*^9, 3.7127679757128887`*^9, 
   3.7127686417813997`*^9, 3.712769543736648*^9, 3.71276997397716*^9, 
   3.712827702900498*^9, 3.713065019622829*^9, 3.713065278071267*^9, 
   3.713065423240157*^9, 3.713065591116768*^9, 3.713065872426589*^9, 
   3.7136336324227448`*^9, 3.713707539545937*^9, {3.714056825018305*^9, 
   3.71405685181713*^9}, 3.7140578215840883`*^9, 3.714064255821048*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"solz", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", " ", 
      RowBox[{"-", "d"}]}]}], "}"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.712380775126637*^9, 3.712380795700889*^9}, {
   3.712380916099079*^9, 3.712380921936911*^9}, 3.7140568492153*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"kpz1", "\[Rule]", 
     FractionBox[
      RowBox[{"kpz2", " ", 
       RowBox[{"(", 
        RowBox[{"Jbar", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M1"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"M2", "+", "MM"}], ")"}]}], 
      RowBox[{"M1", " ", 
       RowBox[{"(", 
        RowBox[{"Jbar", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]]}], ",", 
    RowBox[{"kdz1", "\[Rule]", 
     FractionBox[
      RowBox[{"kdz2", " ", 
       RowBox[{"(", 
        RowBox[{"Jbar", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M1"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"M2", "+", "MM"}], ")"}]}], 
      RowBox[{"M1", " ", 
       RowBox[{"(", 
        RowBox[{"Jbar", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.71238079601192*^9, 3.712380922852584*^9, 3.7123846794013968`*^9, 
   3.71238500388472*^9, 3.712385198651539*^9, 3.712385372428156*^9, 
   3.7123867318606863`*^9, 3.712386909903964*^9, 3.7123875446071157`*^9, 
   3.712389499231382*^9, 3.712391338995213*^9, 3.712394556019561*^9, 
   3.71239593383759*^9, 3.712408419087373*^9, 3.712409160071753*^9, 
   3.712411768713039*^9, 3.7124131768148117`*^9, 3.712414114483572*^9, 
   3.712465695850668*^9, 3.712465945482337*^9, 3.712466740839179*^9, 
   3.712467006582162*^9, 3.7124672151972218`*^9, 3.712467589973249*^9, 
   3.7124678042303963`*^9, 3.712468085570627*^9, 3.712468166341384*^9, 
   3.7124682921700907`*^9, 3.712469095467164*^9, 3.712469308719329*^9, 
   3.712469459059552*^9, 3.7124696273606853`*^9, 3.7124706209950123`*^9, 
   3.7127235673589363`*^9, 3.712758980779814*^9, 3.712761001544443*^9, 
   3.712761844429339*^9, 3.712762371759272*^9, 3.7127664435207767`*^9, 
   3.712767118380591*^9, 3.712767975886332*^9, 3.712768641933867*^9, 
   3.7127695438916388`*^9, 3.712769974120865*^9, 3.712827703040038*^9, 
   3.713065019841597*^9, 3.7130652783213863`*^9, 3.713065423369834*^9, 
   3.713065591529605*^9, 3.713065872651513*^9, 3.7136336326548033`*^9, 
   3.713707539691613*^9, {3.7140568322955008`*^9, 3.71405685280504*^9}, 
   3.714057821647976*^9, 3.7140642558633013`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[OpenCurlyDoubleQuote]semi-block diagonalize matrix\
\[CloseCurlyDoubleQuote]", "Chapter",
 CellChangeTimes->{{3.714056611525387*^9, 3.714056617895162*^9}, {
  3.714056657932118*^9, 3.714056663562141*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["find relation between gains such that motion of ", "Subsubsection"],
 StyleBox[Cell[BoxData[
  RowBox[{
   RowBox[{"e", "[", "1", "]"}], "+", 
   RowBox[{
    FractionBox[
     RowBox[{"JM", "-", 
      RowBox[{"lm", " ", "l2", " ", "MM"}]}], 
     RowBox[{
      RowBox[{"lm", " ", "m"}], "+", 
      RowBox[{"l2", " ", 
       RowBox[{"(", 
        RowBox[{"m", "+", "MM"}], ")"}]}]}]], 
    RowBox[{"e", "[", "4", "]"}]}]}]], "Subsubsection",
  CellChangeTimes->{{3.712394159969154*^9, 3.712394170517374*^9}, 
    3.7123945894434*^9}], "Subsubsection"],
 StyleBox[" does not depend on motion of e[2] and e[3]", "Subsubsection"]
}], "Subsection",
 CellChangeTimes->{{3.712409013260845*^9, 3.7124090685514317`*^9}, {
  3.712723113416411*^9, 3.712723113422537*^9}, {3.7127231455122023`*^9, 
  3.712723145517951*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"solx", "=", 
     RowBox[{
      RowBox[{"Solve", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"4", ",", "5"}], "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"4", ",", "6"}], "]"}], "]"}]}], "}"}], "&"}], "[", 
          RowBox[{"AT", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"5", ";;", "10"}], ",", 
             RowBox[{"5", ";;", "10"}]}], "]"}], "]"}], "]"}], "\[Equal]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"kpx2", ",", "kdx2"}], "}"}]}], "\[IndentingNewLine]", "]"}],
       "//", "Simplify"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"solx", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
        RowBox[{"d2", "\[Rule]", 
         RowBox[{"-", "d"}]}], ",", 
        RowBox[{"lm", "\[Rule]", " ", "l2"}]}], "}"}]}], "//", 
     "FullSimplify"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"solx", "/.", "PhysicalConstants"}], "//", "Simplify"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.712394303644683*^9, 3.712394396319553*^9}, 
   3.712409266187244*^9, {3.712467014449499*^9, 3.712467015461554*^9}, 
   3.712723113432849*^9, 3.712723446426311*^9, {3.712761909349329*^9, 
   3.712761932469701*^9}, {3.714056653716567*^9, 3.714056672839273*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"solx", "=", 
   RowBox[{
    RowBox[{"Solve", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "-", 
              RowBox[{"(", 
               RowBox[{"#", "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"kpx1", "\[Rule]", " ", "0"}], ",", 
                  RowBox[{"kpx2", "\[Rule]", " ", "0"}]}], "}"}]}], ")"}]}], 
             ")"}], "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "5"}], "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "6"}], "]"}], "]"}]}], "}"}], "&"}], "[", 
        RowBox[{"AT", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"5", ";;", "10"}], ",", 
           RowBox[{"5", ";;", "10"}]}], "]"}], "]"}], "]"}], "\[Equal]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"kpx2", ",", "kdx2"}], "}"}]}], "\[IndentingNewLine]", "]"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solx", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", 
      RowBox[{"-", "d"}]}], ",", 
     RowBox[{"lm", "\[Rule]", " ", "l2"}]}], "}"}]}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.712394303644683*^9, 3.712394396319553*^9}, 
   3.712409266187244*^9, {3.712466699935463*^9, 3.71246671075944*^9}, {
   3.7124667690942907`*^9, 3.71246680818429*^9}, {3.712466972024969*^9, 
   3.712466972271887*^9}, 3.712467522538987*^9, 3.712723113448471*^9, 
   3.7127234464333973`*^9, {3.7127236254812927`*^9, 3.7127236263463717`*^9}, 
   3.7127686213566113`*^9, 3.7127695061880903`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"kpx2", "\[Rule]", 
     FractionBox[
      RowBox[{"kpx1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"JM", "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "m"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"M2", "+", "MM"}], ")"}]}]]}], ",", 
    RowBox[{"kdx2", "\[Rule]", 
     FractionBox[
      RowBox[{"kdx1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"JM", "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "m"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"M2", "+", "MM"}], ")"}]}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.712769559701955*^9, 3.7127698777644444`*^9, {3.712769954014907*^9, 
   3.7127699797533693`*^9}, 3.7127700207701283`*^9, 3.7128277214799557`*^9, 
   3.713065038385947*^9, 3.713065662703087*^9, 3.713065881051791*^9, 
   3.713633731667082*^9, 3.713707557403384*^9, 3.714056677226651*^9, 
   3.714057823027152*^9, 3.714064257637002*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["create gains relations list", "Chapter",
 CellChangeTimes->{{3.7140566885805597`*^9, 3.714056696595478*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gainsRelations", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gainsRelations", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"gainsRelations", ",", 
     RowBox[{"solx", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"solz", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7124090961971817`*^9, 3.712409114994296*^9}, {
   3.712409228755076*^9, 3.712409230520919*^9}, 3.712409277734993*^9, {
   3.714056681655917*^9, 3.714056703316988*^9}, {3.714056837543095*^9, 
   3.7140568418777933`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["State matrix if gains choices satisfy relations above", "Chapter",
 CellChangeTimes->{{3.714056706564246*^9, 3.7140567092781677`*^9}, {
  3.7140568671935368`*^9, 3.714056879850575*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AT", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"P", ".", "AMatrix", ".", 
      RowBox[{"Inverse", "[", "P", "]"}]}], "/.", "gainsRelations"}], "//", 
    "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.714057177699905*^9, 3.7140571834832478`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["See structure of state matrix", "Chapter",
 CellChangeTimes->{{3.714056884047761*^9, 3.714056893302004*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"AT", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "4"}], ",", 
        RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "//", "Simplify"}], "//", 
    "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AT", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "4"}], ",", 
        RowBox[{"5", ";;", "10"}]}], "]"}], "]"}], "//", "Simplify"}], "//", 
    "MatrixForm"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AT", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"5", ";;", "10"}], ",", 
        RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "//", "Simplify"}], "//", 
    "MatrixForm"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"AT", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"5", ";;", "10"}], ",", 
         RowBox[{"5", ";;", "10"}]}], "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "4"}], ",", 
        RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "//", "Simplify"}], "//", 
    "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"AT", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"5", ";;", "10"}], ",", 
         RowBox[{"5", ";;", "10"}]}], "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "4"}], ",", 
        RowBox[{"5", ";;", "6"}]}], "]"}], "]"}], "//", "Simplify"}], "//", 
    "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"AT", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"5", ";;", "10"}], ",", 
         RowBox[{"5", ";;", "10"}]}], "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"5", ";;", "6"}], ",", 
        RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "//", "Simplify"}], "//", 
    "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"AT", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"5", ";;", "10"}], ",", 
         RowBox[{"5", ";;", "10"}]}], "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"5", ";;", "6"}], ",", 
        RowBox[{"5", ";;", "6"}]}], "]"}], "]"}], "//", "Simplify"}], "//", 
    "MatrixForm"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.714056912393461*^9, 3.71405696877542*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "kpz2", " ", 
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " ", "M1"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"Jbar", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "kdz2", " ", 
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " ", "M1"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"Jbar", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}]]}], "0", "0"},
     {"0", "0", "0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "kpz2", " ", 
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{"d1", " ", "d2", " ", "m"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "M1"}], "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Jbar"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"Jbar", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "kdz2", " ", 
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{"d1", " ", "d2", " ", "m"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "M1"}], "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Jbar"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"Jbar", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", "kpz2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{
         RowBox[{"-", "Jbar"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", "kdz2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{
         RowBox[{"-", "Jbar"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.714056894334399*^9, 3.71405696925101*^9, 
  3.714057191507319*^9, 3.7140578317470903`*^9, 3.714064269470093*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.714056894334399*^9, 3.71405696925101*^9, 
  3.714057191507319*^9, 3.7140578317470903`*^9, 3.714064269487007*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.714056894334399*^9, 3.71405696925101*^9, 
  3.714057191507319*^9, 3.7140578317470903`*^9, 3.714064269496467*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpx1", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d2"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"l2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M1"}], ")"}]}], "+", 
              RowBox[{"l1", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"l2", " ", "M1"}], "+", 
              RowBox[{"l1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "l1", " ", 
         RowBox[{"(", 
          RowBox[{"JM", "-", 
           RowBox[{"2", " ", "l2", " ", "lm", " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kdx1", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d2"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"l2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M1"}], ")"}]}], "+", 
              RowBox[{"l1", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"l2", " ", "M1"}], "+", 
              RowBox[{"l1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "l1", " ", 
         RowBox[{"(", 
          RowBox[{"JM", "-", 
           RowBox[{"2", " ", "l2", " ", "lm", " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["d2", "2"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpx1", " ", "l1", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"l2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M1"}], ")"}]}], "+", 
              RowBox[{"l1", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", 
               "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", "M2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
              RowBox[{"JM", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
           
           RowBox[{"gravity", " ", "l2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["l1", "2"], " ", "m", " ", "M1", " ", 
               SuperscriptBox["M2", "2"]}], "+", 
              RowBox[{
               SuperscriptBox["l1", "2"], " ", "M1", " ", 
               SuperscriptBox["M2", "3"]}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", 
               SuperscriptBox["m", "3"], " ", "MM"}], "+", 
              RowBox[{"3", " ", 
               SuperscriptBox["lm", "2"], " ", 
               SuperscriptBox["m", "2"], " ", "M1", " ", "MM"}], "+", 
              RowBox[{"3", " ", 
               SuperscriptBox["lm", "2"], " ", "m", " ", 
               SuperscriptBox["M1", "2"], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", 
               SuperscriptBox["M1", "3"], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", 
               SuperscriptBox["m", "2"], " ", "M2", " ", "MM"}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["l1", "2"], " ", "m", " ", "M1", " ", "M2", " ",
                "MM"}], "+", 
              RowBox[{
              "2", " ", "l1", " ", "lm", " ", "m", " ", "M1", " ", "M2", " ", 
               "MM"}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["lm", "2"], " ", "m", " ", "M1", " ", "M2", " ",
                "MM"}], "+", 
              RowBox[{"2", " ", "l1", " ", "lm", " ", 
               SuperscriptBox["M1", "2"], " ", "M2", " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", 
               SuperscriptBox["M1", "2"], " ", "M2", " ", "MM"}], "+", 
              RowBox[{"3", " ", 
               SuperscriptBox["l1", "2"], " ", "M1", " ", 
               SuperscriptBox["M2", "2"], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["l1", "2"], " ", "m", " ", "M1", " ", 
               SuperscriptBox["MM", "2"]}], "+", 
              RowBox[{"2", " ", "l1", " ", "lm", " ", "m", " ", "M1", " ", 
               SuperscriptBox["MM", "2"]}], "+", 
              RowBox[{"2", " ", "l1", " ", "lm", " ", 
               SuperscriptBox["M1", "2"], " ", 
               SuperscriptBox["MM", "2"]}], "+", 
              RowBox[{"3", " ", 
               SuperscriptBox["l1", "2"], " ", "M1", " ", "M2", " ", 
               SuperscriptBox["MM", "2"]}], "+", 
              RowBox[{
               SuperscriptBox["l1", "2"], " ", "M1", " ", 
               SuperscriptBox["MM", "3"]}], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"m", "+", "M1"}], ")"}], "2"], " ", "M2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M1", "+", "MM"}], ")"}]}], "+", 
              RowBox[{"JM", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"m", "+", "M1"}], ")"}], "2"], " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
              
              RowBox[{"2", " ", "l2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M1"}], ")"}], " ", "M2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "lm"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "M1"}], ")"}], " ", "MM"}], "+", 
                 RowBox[{"l1", " ", "M1", " ", 
                  RowBox[{"(", 
                   RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}]}],
           ")"}]}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpx1", " ", "l1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", 
               "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", "M2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"l2", " ", "M1"}], "+", 
              RowBox[{"l1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
           
           RowBox[{"gravity", " ", "l2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["l1", "2"], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], "3"]}], "+", 
              RowBox[{"2", " ", "l1", " ", "M1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"l2", " ", "M2"}], "+", 
                 RowBox[{"lm", " ", "MM"}]}], ")"}]}], "+", 
              RowBox[{"M1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", 
                  "MM"}], "+", 
                 RowBox[{
                  SuperscriptBox["lm", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "M1", "+", "M2"}], ")"}], " ", "MM"}], 
                 "+", 
                 RowBox[{
                  SuperscriptBox["l2", "2"], " ", "M2", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "M1", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
             ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gravity", " ", "l2", " ", "M1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
              
              RowBox[{"kpx1", " ", "l1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"l2", " ", "M1"}], "+", 
                 RowBox[{"l1", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}], "+", 
        RowBox[{"d1", " ", "d2", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpx1", " ", "l1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", 
               "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", "M2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"l2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
              RowBox[{"l1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
           "+", 
           RowBox[{"2", " ", "gravity", " ", "l2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["l1", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], "2"]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "+", "M1"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", 
                  "MM"}], "+", 
                 RowBox[{
                  SuperscriptBox["lm", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "M1", "+", "M2"}], ")"}], " ", "MM"}], 
                 "+", 
                 RowBox[{
                  SuperscriptBox["l2", "2"], " ", "M2", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "M1", "+", "MM"}], ")"}]}]}], ")"}]}], 
              "+", 
              RowBox[{"l1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"l2", " ", "M2"}], "+", 
                 RowBox[{"lm", " ", "MM"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["m", "2"], "+", 
                 RowBox[{"2", " ", "M1", " ", 
                  RowBox[{"(", 
                   RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
                 RowBox[{"m", " ", 
                  RowBox[{"(", 
                   RowBox[{"M1", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}],
              ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "gravity", " ", "l2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M1"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
              
              RowBox[{"kpx1", " ", "l1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"l2", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", 
                    RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
                 RowBox[{"l1", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
                ")"}]}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "l1", " ", "M1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
          "+", 
          RowBox[{
           SuperscriptBox["lm", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
          RowBox[{
           SuperscriptBox["l2", "2"], " ", "M2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"JM", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"l2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M1"}], ")"}]}], "+", 
             RowBox[{"l1", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"l2", " ", "M1"}], "+", 
             RowBox[{"l1", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]], 
      RowBox[{"-", "kdx1"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.714056894334399*^9, 3.71405696925101*^9, 
  3.714057191507319*^9, 3.7140578317470903`*^9, 3.714064269598325*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0"},
     {"0", "0"},
     {"0", "0"},
     {
      FractionBox[
       RowBox[{
        SuperscriptBox["gravity", "2"], " ", "l2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "M1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "-", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "M1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["l2", "2"], " ", "m", " ", "M2"}], "+", 
             RowBox[{
              SuperscriptBox["lm", "2"], " ", "m", " ", "MM"}], "-", 
             RowBox[{"l2", " ", "lm", " ", "M1", " ", "MM"}], "+", 
             RowBox[{
              SuperscriptBox["lm", "2"], " ", "M1", " ", "MM"}], "+", 
             RowBox[{
              SuperscriptBox["l2", "2"], " ", "M2", " ", "MM"}], "-", 
             RowBox[{"2", " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], "+", 
             RowBox[{
              SuperscriptBox["lm", "2"], " ", "M2", " ", "MM"}], "+", 
             RowBox[{"JM", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "-", 
             RowBox[{"l1", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "lm"}], " ", "MM"}], "+", 
                RowBox[{"l2", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["l2", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M1"}], ")"}], " ", "M2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
             RowBox[{"JM", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M1"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
             RowBox[{"lm", " ", "MM", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"lm", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "M1"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "M1", "+", "M2"}], ")"}]}], "+", 
                RowBox[{"l1", " ", "M1", " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], "-", 
             RowBox[{"l2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"lm", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "M1"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"M1", "+", 
                   RowBox[{"2", " ", "M2"}]}], ")"}], " ", "MM"}], "+", 
                RowBox[{"l1", " ", "M1", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "MM"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "l1", " ", "M1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "lm"}], " ", "MM"}], "+", 
          RowBox[{"l2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
          "+", 
          RowBox[{
           SuperscriptBox["lm", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
          RowBox[{
           SuperscriptBox["l2", "2"], " ", "M2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"JM", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"l2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M1"}], ")"}]}], "+", 
             RowBox[{"l1", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"l2", " ", "M1"}], "+", 
             RowBox[{"l1", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.714056894334399*^9, 3.71405696925101*^9, 
  3.714057191507319*^9, 3.7140578317470903`*^9, 3.714064270109982*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "lm"}], " ", "MM"}], "+", 
          RowBox[{"l2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "M1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["l2", "2"], " ", "m", " ", "M2"}], "+", 
             RowBox[{
              SuperscriptBox["lm", "2"], " ", "m", " ", "MM"}], "-", 
             RowBox[{"l2", " ", "lm", " ", "M1", " ", "MM"}], "+", 
             RowBox[{
              SuperscriptBox["lm", "2"], " ", "M1", " ", "MM"}], "+", 
             RowBox[{
              SuperscriptBox["l2", "2"], " ", "M2", " ", "MM"}], "-", 
             RowBox[{"2", " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], "+", 
             RowBox[{
              SuperscriptBox["lm", "2"], " ", "M2", " ", "MM"}], "+", 
             RowBox[{"JM", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "-", 
             RowBox[{"l1", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "lm"}], " ", "MM"}], "+", 
                RowBox[{"l2", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["l2", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M1"}], ")"}], " ", "M2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
             RowBox[{"JM", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M1"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
             RowBox[{"lm", " ", "MM", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"lm", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "M1"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "M1", "+", "M2"}], ")"}]}], "+", 
                RowBox[{"l1", " ", "M1", " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], "-", 
             RowBox[{"l2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"lm", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "M1"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"M1", "+", 
                   RowBox[{"2", " ", "M2"}]}], ")"}], " ", "MM"}], "+", 
                RowBox[{"l1", " ", "M1", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "MM"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], 
       RowBox[{"M1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
          "+", 
          RowBox[{
           SuperscriptBox["lm", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
          RowBox[{
           SuperscriptBox["l2", "2"], " ", "M2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"JM", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"l2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M1"}], ")"}]}], "+", 
             RowBox[{"l1", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"l2", " ", "M1"}], "+", 
             RowBox[{"l1", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.714056894334399*^9, 3.71405696925101*^9, 
  3.714057191507319*^9, 3.7140578317470903`*^9, 3.714064270147396*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "lm"}], " ", "MM"}], "+", 
           RowBox[{"l2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d2", " ", 
                RowBox[{"(", 
                 RowBox[{"M2", "+", "MM"}], ")"}]}], "-", 
               RowBox[{"d1", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gravity", " ", "l2", " ", "M1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"d1", " ", "M1"}], "-", 
                 RowBox[{"d2", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"l2", " ", "M2"}], "+", 
                 RowBox[{"lm", " ", "MM"}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"d1", "-", "d2"}], ")"}], " ", "kpx1", " ", "l1", " ", 
               SuperscriptBox["M1", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"JM", "+", 
                 RowBox[{
                  SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                 RowBox[{
                  SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"d1", " ", 
                  RowBox[{"(", 
                   RowBox[{"gravity", "+", 
                    RowBox[{"kpx1", " ", "l1"}]}], ")"}], " ", "M1"}], "-", 
                 RowBox[{"d2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"kpx1", " ", "l1", " ", "M1"}], "+", 
                    RowBox[{"gravity", " ", 
                    RowBox[{"(", 
                    RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}]}]}], ")"}], 
               " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
                 "-", 
                 RowBox[{
                  SuperscriptBox["lm", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "M1", "+", "M2"}], ")"}], " ", "MM"}], 
                 "-", 
                 RowBox[{
                  SuperscriptBox["l2", "2"], " ", "M2", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "M1", "+", "MM"}], ")"}]}], "-", 
                 RowBox[{"JM", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
                ")"}]}]}], ")"}]}], "-", 
           RowBox[{"l2", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d1", " ", "M1"}], "-", 
              RowBox[{"d2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "d2"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"JM", " ", "kpx1", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
                 RowBox[{"gravity", " ", 
                  RowBox[{"(", 
                   RowBox[{"M2", "+", "MM"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "lm"}], " ", "MM"}], "+", 
                    RowBox[{"l2", " ", 
                    RowBox[{"(", 
                    RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
                 RowBox[{"kpx1", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", 
                    "MM"}], "+", 
                    RowBox[{
                    SuperscriptBox["lm", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
                    RowBox[{
                    SuperscriptBox["l2", "2"], " ", "M2", " ", 
                    RowBox[{"(", 
                    RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
              "+", 
              RowBox[{"d1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"JM", " ", "kpx1", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
                 RowBox[{"gravity", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "lm"}], " ", "MM"}], "+", 
                    RowBox[{"l2", " ", 
                    RowBox[{"(", 
                    RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
                 RowBox[{"kpx1", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", 
                    "MM"}], "+", 
                    RowBox[{
                    SuperscriptBox["lm", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
                    RowBox[{
                    SuperscriptBox["l2", "2"], " ", "M2", " ", 
                    RowBox[{"(", 
                    RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}]}],
              ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"lm", " ", "MM"}], "-", 
           RowBox[{"l2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d2"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"l2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M1"}], ")"}]}], "+", 
              RowBox[{"l1", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"l2", " ", "M1"}], "+", 
              RowBox[{"l1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]]}], 
      RowBox[{"-", "kdx1"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.714056894334399*^9, 3.71405696925101*^9, 
  3.714057191507319*^9, 3.7140578317470903`*^9, 3.714064270259241*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["with some simplifications", "Chapter",
 CellChangeTimes->{{3.714056973457736*^9, 3.71405697648108*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AT", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"1", ";;", "4"}], ",", 
       RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
      RowBox[{"d2", "\[Rule]", " ", 
       RowBox[{"-", "d"}]}], ",", 
      RowBox[{"lm", "\[Rule]", " ", "l2"}]}], "}"}]}], "//", "Simplify"}], "//",
   "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"AT", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "4"}], ",", 
        RowBox[{"5", ";;", "10"}]}], "]"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
       RowBox[{"d2", "\[Rule]", " ", 
        RowBox[{"-", "d"}]}], ",", 
       RowBox[{"lm", "\[Rule]", " ", "l2"}]}], "}"}]}], "//", "Simplify"}], "//",
    "MatrixForm"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"AT", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"5", ";;", "10"}], ",", 
        RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
       RowBox[{"d2", "\[Rule]", " ", 
        RowBox[{"-", "d"}]}], ",", 
       RowBox[{"lm", "\[Rule]", " ", "l2"}]}], "}"}]}], "//", "Simplify"}], "//",
    "MatrixForm"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"AT", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"5", ";;", "10"}], ",", 
        RowBox[{"5", ";;", "10"}]}], "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"1", ";;", "4"}], ",", 
       RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
      RowBox[{"d2", "\[Rule]", " ", 
       RowBox[{"-", "d"}]}], ",", 
      RowBox[{"lm", "\[Rule]", " ", "l2"}]}], "}"}]}], "//", "Simplify"}], "//",
   "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"AT", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"5", ";;", "10"}], ",", 
        RowBox[{"5", ";;", "10"}]}], "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"1", ";;", "4"}], ",", 
       RowBox[{"5", ";;", "6"}]}], "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
      RowBox[{"d2", "\[Rule]", " ", 
       RowBox[{"-", "d"}]}], ",", 
      RowBox[{"lm", "\[Rule]", " ", "l2"}]}], "}"}]}], "//", "Simplify"}], "//",
   "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"AT", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"5", ";;", "10"}], ",", 
        RowBox[{"5", ";;", "10"}]}], "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"5", ";;", "6"}], ",", 
       RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
      RowBox[{"d2", "\[Rule]", " ", 
       RowBox[{"-", "d"}]}], ",", 
      RowBox[{"lm", "\[Rule]", " ", "l2"}]}], "}"}]}], "//", "Simplify"}], "//",
   "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"AT", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"5", ";;", "10"}], ",", 
        RowBox[{"5", ";;", "10"}]}], "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"5", ";;", "6"}], ",", 
       RowBox[{"5", ";;", "6"}]}], "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
      RowBox[{"d2", "\[Rule]", " ", 
       RowBox[{"-", "d"}]}], ",", 
      RowBox[{"lm", "\[Rule]", " ", "l2"}]}], "}"}]}], "//", "Simplify"}], "//",
   "MatrixForm"}]}], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpz2", " ", 
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "M1"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "M1", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"m", " ", 
             RowBox[{"(", 
              RowBox[{"M1", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kdz2", " ", 
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "M1"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "M1", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"m", " ", 
             RowBox[{"(", 
              RowBox[{"M1", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}]]}], 
      "0", "0"},
     {"0", "0", "0", "1"},
     {
      FractionBox[
       RowBox[{"2", " ", "d", " ", "kpz2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "Jbar"}], "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", "m"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"M2", "+", "MM"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "M1"}], "+", "M2", "+", "MM"}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Jbar", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Jbar", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", "M1", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
             RowBox[{"m", " ", 
              RowBox[{"(", 
               RowBox[{"M1", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]], 
      FractionBox[
       RowBox[{"2", " ", "d", " ", "kdz2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "Jbar"}], "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", "m"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"M2", "+", "MM"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "M1"}], "+", "M2", "+", "MM"}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Jbar", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Jbar", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", "M1", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
             RowBox[{"m", " ", 
              RowBox[{"(", 
               RowBox[{"M1", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kpz2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{"Jbar", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kdz2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{"Jbar", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.714056977883244*^9, 3.71405719538488*^9, 
  3.7140578325888243`*^9, 3.714064270369735*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.714056977883244*^9, 3.71405719538488*^9, 
  3.7140578325888243`*^9, 3.7140642703845873`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.714056977883244*^9, 3.71405719538488*^9, 
  3.7140578325888243`*^9, 3.71406427039747*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpx1", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
           RowBox[{"l1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "l1", " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "m"}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kdx1", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
           RowBox[{"l1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "l1", " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "m"}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "kpx1", " ", "l1", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["l2", "2"], " ", "m", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"JM", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"l2", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", 
               RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
            RowBox[{"l1", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
         "+", 
         RowBox[{"gravity", " ", "l2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["l2", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M1"}], ")"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"m", "+", 
                RowBox[{"2", " ", "M1"}]}], ")"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"JM", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"m", "+", 
                RowBox[{"2", " ", "M1"}]}], ")"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"2", " ", "l1", " ", "l2", " ", "M1", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", 
               RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["l1", "2"], " ", "M1", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"m", "+", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}]}], 
           ")"}]}]}], 
        RowBox[{"2", " ", "l1", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
           RowBox[{"l1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", "kdx1"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.714056977883244*^9, 3.71405719538488*^9, 
  3.7140578325888243`*^9, 3.714064270636672*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0"},
     {"0", "0"},
     {"0", "0"},
     {
      FractionBox[
       RowBox[{
        SuperscriptBox["gravity", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "JM"}], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "-", 
          RowBox[{"l2", " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"l2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", 
                RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}], "-", 
             RowBox[{"l1", " ", "M1", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], 
       RowBox[{"4", " ", "l1", " ", "m", " ", "M1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["l2", "2"], " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"JM", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
          RowBox[{"l1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}]], 
      "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.714056977883244*^9, 3.71405719538488*^9, 
  3.7140578325888243`*^9, 3.714064270712697*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"l2", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"l2", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"l2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}], "-", 
              RowBox[{"l1", " ", "M1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}]}],
           ")"}]}], 
        RowBox[{"M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
           RowBox[{"l1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}]]}], 
      "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.714056977883244*^9, 3.71405719538488*^9, 
  3.7140578325888243`*^9, 3.714064270752843*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"gravity", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["l2", "2"], " ", "m", " ", 
             RowBox[{"(", 
              RowBox[{"M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"JM", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
           ")"}]}], "+", 
         RowBox[{"2", " ", "kpx1", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["l2", "2"], " ", "m", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"JM", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"l2", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", 
               RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
            RowBox[{"l1", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
        RowBox[{"2", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
           RowBox[{"l1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", "kdx1"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.714056977883244*^9, 3.71405719538488*^9, 
  3.7140578325888243`*^9, 3.7140642708985233`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Az and A\[Theta] matrices", "Chapter",
 CellChangeTimes->{{3.714057398938271*^9, 3.714057410842629*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AT", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"1", ";;", "4"}], ",", 
       RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "2"}], ",", 
      RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "//", "Simplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AT", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"1", ";;", "4"}], ",", 
       RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"3", ";;", "4"}], ",", 
      RowBox[{"3", ";;", "4"}]}], "]"}], "]"}], "//", "Simplify"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.714057417087318*^9, 3.714057446592498*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "kpz2", " ", 
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " ", "M1"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"Jbar", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "kdz2", " ", 
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " ", "M1"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"Jbar", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.714057437003685*^9, 3.714057447149685*^9}, 
   3.7140578334297256`*^9, 3.714064270967956*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", "kpz2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{
         RowBox[{"-", "Jbar"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", "kdz2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{
         RowBox[{"-", "Jbar"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.714057437003685*^9, 3.714057447149685*^9}, 
   3.7140578334297256`*^9, 3.714064271003277*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"AT", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "4"}], ",", 
        RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"1", ";;", "2"}], ",", 
       RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
      RowBox[{"d2", "\[Rule]", " ", 
       RowBox[{"-", "d"}]}]}], "}"}]}], "//", "Simplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"AT", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "4"}], ",", 
        RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"3", ";;", "4"}], ",", 
       RowBox[{"3", ";;", "4"}]}], "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
      RowBox[{"d2", "\[Rule]", " ", 
       RowBox[{"-", "d"}]}]}], "}"}]}], "//", "Simplify"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7140574618095007`*^9, 3.714057470498928*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpz2", " ", 
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "M1"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "M1", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"m", " ", 
             RowBox[{"(", 
              RowBox[{"M1", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kdz2", " ", 
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "M1"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "M1", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"m", " ", 
             RowBox[{"(", 
              RowBox[{"M1", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.71405747087954*^9, 3.714057833714642*^9, 
  3.7140642710503902`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kpz2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{"Jbar", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kdz2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{"Jbar", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.71405747087954*^9, 3.714057833714642*^9, 
  3.714064271068439*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ap matrix", "Chapter",
 CellChangeTimes->{{3.712409741633215*^9, 3.712409751009466*^9}, {
  3.712410162335513*^9, 3.712410163746204*^9}, {3.714057323943025*^9, 
  3.714057358306263*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"structure", " ", "to", " ", "polynomial", " ", "coefficients"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[CapitalGamma]4", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p1_", ",", "p2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kp_", ",", "kv_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"-", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"gL", " ", 
        RowBox[{"(", 
         RowBox[{"kp", "+", 
          RowBox[{"gL", " ", "p1"}]}], ")"}]}], ",", " ", 
       RowBox[{"gL", "  ", "kv"}], " ", ",", " ", 
       RowBox[{"kp", "+", 
        RowBox[{"gL", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "p1", "+", "p2"}], ")"}]}]}], ",", "kv"}], 
      "}"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalGamma]4", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fp_", ",", "p_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kp_", ",", "kv_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"-", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"fp", " ", "kp"}], ",", " ", 
       RowBox[{"fp", "  ", "kv"}], " ", ",", " ", 
       RowBox[{"kp", "+", 
        RowBox[{"fp", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "p"}], ")"}]}]}], ",", "kv"}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AofInterest", "=", 
     RowBox[{
      RowBox[{"AT", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"5", ";;", "10"}], ",", 
         RowBox[{"5", ";;", "10"}]}], "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "4"}], ",", 
        RowBox[{"1", ";;", "4"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solps", "=", 
     RowBox[{
      RowBox[{"Solve", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"AofInterest", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "-", 
            RowBox[{"\[CapitalGamma]4", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"fp", ",", "pp"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"kpx1", ",", "kdx1"}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"AofInterest", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "-", 
              RowBox[{"\[CapitalGamma]4", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"fp", ",", "pp"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"kpx1", ",", "kdx1"}], "}"}]}], "]"}]}], ",", 
             "kpx1"}], "]"}]}], "\[IndentingNewLine]", "]"}], "\[Equal]", 
         "\[IndentingNewLine]", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"fp", ",", "pp"}], "}"}]}], "\[IndentingNewLine]", "]"}], "//",
       "Simplify"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.712132547668767*^9, 3.712132594345231*^9}, {
  3.712132635083919*^9, 3.712132663094454*^9}, {3.7121329860431013`*^9, 
  3.712133144012432*^9}, {3.712133352252187*^9, 3.7121333526696377`*^9}, {
  3.7121370163390512`*^9, 3.7121370293859797`*^9}, {3.712137102973229*^9, 
  3.712137103365212*^9}, {3.7121504137162037`*^9, 3.712150446009226*^9}, {
  3.7121505505223017`*^9, 3.7121505533222218`*^9}, {3.712395606466907*^9, 
  3.712395626674182*^9}, {3.712395698220069*^9, 3.712395728302267*^9}, {
  3.712396124465748*^9, 3.7123961263051777`*^9}, {3.712396466379158*^9, 
  3.71239647390554*^9}, {3.7123973902341003`*^9, 3.7123974475880337`*^9}, {
  3.7124096960962048`*^9, 3.712409726042841*^9}, {3.7140570690622377`*^9, 
  3.714057117426083*^9}, {3.714057246270588*^9, 3.71405726575243*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"solps", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", " ", 
      RowBox[{"-", "d"}]}], ",", 
     RowBox[{"lm", "\[Rule]", " ", "l2"}]}], "}"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"solps", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
        RowBox[{"d2", "\[Rule]", " ", 
         RowBox[{"-", "d"}]}], ",", 
        RowBox[{"lm", "\[Rule]", " ", "l2"}], ",", 
        RowBox[{"MM", "\[Rule]", " ", "0"}]}], "}"}]}], "//", 
     RowBox[{
      RowBox[{"FullSimplify", "\[IndentingNewLine]", "solps"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
        RowBox[{"d2", "\[Rule]", " ", 
         RowBox[{"-", "d"}]}], ",", 
        RowBox[{"lm", "\[Rule]", " ", "l2"}], ",", 
        RowBox[{"JM", "\[Rule]", " ", "0"}]}], "}"}]}]}], "//", 
    "FullSimplify"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.712397637918097*^9, 3.7123976591654177`*^9}, {
   3.712409773327779*^9, 3.712409774674542*^9}, 3.712723114921793*^9, 
   3.712723446481591*^9, {3.71272375124551*^9, 3.712723797763619*^9}, {
   3.712766764196806*^9, 3.712766768574154*^9}, {3.7127716155877666`*^9, 
   3.7127716194492807`*^9}, {3.7127716731103153`*^9, 3.71277167326656*^9}, 
   3.714057262803887*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"fp", "\[Rule]", 
     FractionBox[
      RowBox[{"gravity", " ", "l2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"l2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
         RowBox[{"l1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
      RowBox[{"2", " ", "l1", " ", 
       RowBox[{"(", 
        RowBox[{"JM", "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "m"}]}], ")"}]}]]}], ",", 
    RowBox[{"pp", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["JM", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"2", " ", "M1"}]}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{"JM", " ", "l2", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l1", " ", "M1"}], "+", 
           RowBox[{"l2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M1"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["m", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["l2", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"m", "+", 
               RowBox[{"2", " ", "M1"}]}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["l1", "2"], " ", "M1", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"m", "+", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}]}], 
          ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"M1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["l2", "2"], " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"JM", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
           RowBox[{"l1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}], 
         "2"]}], ")"}]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.712723740267791*^9, 3.712723798568553*^9}, 
   3.712766769757365*^9, 3.7127681674199543`*^9, 3.712771620515505*^9, 
   3.712771674285117*^9, 3.712827743747704*^9, 3.713707585672371*^9, 
   3.713707726764867*^9, 3.714057269597063*^9, 3.714057339838776*^9, 
   3.714057841774323*^9, 3.714064278732415*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Stability if p> 0", "Chapter",
 CellChangeTimes->{{3.712409889760705*^9, 3.7124099279819527`*^9}, {
  3.714057369538097*^9, 3.714057378820036*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pp", "/.", 
    RowBox[{"solps", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", " ", 
      RowBox[{"-", "d"}]}], ",", 
     RowBox[{"lm", "\[Rule]", " ", "l2"}], ",", 
     RowBox[{"JM", "\[Rule]", " ", "0"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.712399272070196*^9, 3.712399320286549*^9}, 
   3.7124097989166307`*^9, 3.712723114940588*^9, 3.7127234464973392`*^9, {
   3.714057367047379*^9, 3.714057367290146*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["l2", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M1"}]}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["l1", "2"], " ", "M1", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}]}], ")"}]}], 
  RowBox[{"M1", " ", 
   RowBox[{"(", 
    RowBox[{"M2", "+", "MM"}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"l2", " ", 
       RowBox[{"(", 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M1"}]}], ")"}]}], "+", 
      RowBox[{"l1", " ", 
       RowBox[{"(", 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}], 
    "2"]}]]], "Output",
 CellChangeTimes->{3.712723875110805*^9, 3.712827745056119*^9, 
  3.7140573811825933`*^9, 3.714057841961035*^9, 3.714064278903138*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["given some physical constants", "Chapter",
 CellChangeTimes->{{3.714057042393785*^9, 3.714057057210704*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"PhysicalConstants", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gravity", "\[Rule]", "9.81"}], ",", "\[IndentingNewLine]", 
     RowBox[{"M1", " ", "\[Rule]", "2.222"}], ",", 
     RowBox[{"(*", 
      RowBox[{"neo", " ", "mass"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"M2", "\[Rule]", " ", "2.733"}], ",", 
     RowBox[{"(*", 
      RowBox[{"popeye", " ", "mass"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"l1", "\[Rule]", " ", "1.45"}], ",", 
     RowBox[{"(*", 
      RowBox[{"cable", " ", "length", " ", "neo"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"l2", "\[Rule]", "0.27"}], " ", ",", 
       RowBox[{"lm", "\[Rule]", " ", "0.20"}], ",", 
       RowBox[{"lm", "\[Rule]", " ", 
        RowBox[{"l2", ".07"}]}], ","}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"l2", "\[Rule]", "0.42"}], " ", ",", 
     RowBox[{"lm", "\[Rule]", " ", "0.37"}], ",", 
     RowBox[{"lm", "\[Rule]", " ", 
      RowBox[{"l2", ".05"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"d1", "\[Rule]", " ", 
      RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"d2", "\[Rule]", " ", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"MM", "\[Rule]", "0.896"}], ",", 
     RowBox[{"(*", 
      RowBox[{"manipulator", " ", "mass"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"JM", "\[Rule]", 
      RowBox[{
       FractionBox["1", "12"], "0.896", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["0.42", "2"], ")"}], "2"]}]}]}], 
    RowBox[{"(*", 
     RowBox[{"manipulator", " ", "moment", " ", "of", " ", "inertia"}], 
     "*)"}], "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PhysicalConstants", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{"PhysicalConstants", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Jbar", "\[Rule]", " ", 
          RowBox[{
           RowBox[{"d1", " ", "m1", " ", "gravity"}], "+", 
           RowBox[{"d2", " ", "m2", " ", "gravity"}], "+", 
           RowBox[{
            FractionBox["1", "12"], "mbar", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Abs", "[", "d1", "]"}], "+", 
               RowBox[{"Abs", "[", "d2", "]"}]}], ")"}], "2"]}]}]}], 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"d1", "*", "m1", "*", "g"}], "+", 
           RowBox[{"d2", "*", "m2", "*", "g"}], "+", 
           RowBox[{
            FractionBox["1", "12"], "mbar", " ", 
            SuperscriptBox["L", "2"]}]}], "*)"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"m", "\[Rule]", " ", 
          RowBox[{"m1", "+", "m2", "+", "mbar"}]}]}], "\[IndentingNewLine]", 
        "}"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m1", "\[Rule]", " ", "0.587"}], ",", 
         RowBox[{"m2", "\[Rule]", " ", "0.608"}], ",", 
         RowBox[{"mbar", "\[Rule]", " ", "0.287"}]}], "}"}]}], "/.", 
      "PhysicalConstants"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gainsRelations", "/.", "PhysicalConstants"}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.71109460565976*^9, 3.7110946322782383`*^9}, {
   3.7111964381368437`*^9, 3.711196457499648*^9}, {3.711196512020955*^9, 
   3.711196514898863*^9}, {3.712461199391642*^9, 3.712461229536858*^9}, 
   3.712465673081929*^9, {3.712465769129312*^9, 3.7124657773253508`*^9}, {
   3.712466514298271*^9, 3.7124665164577017`*^9}, {3.712468309379591*^9, 
   3.712468336866548*^9}, {3.712468374201084*^9, 3.712468376673369*^9}, {
   3.712723114985022*^9, 3.712723114991249*^9}, {3.712723147174782*^9, 
   3.7127231471843967`*^9}, {3.7127234465306797`*^9, 3.7127234465355988`*^9}},
 
 ExpressionUUID -> "74f9c4ac-5289-4836-b348-a105fec6cd02"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"kpx2", "\[Rule]", 
    RowBox[{"0.9488247206288017`", " ", "kpx1"}]}], ",", 
   RowBox[{"kdx2", "\[Rule]", 
    RowBox[{"0.9488247206288017`", " ", "kdx1"}]}], ",", 
   RowBox[{"kpz1", "\[Rule]", 
    RowBox[{"1.0252690283581447`", " ", "kpz2"}]}], ",", 
   RowBox[{"kdz1", "\[Rule]", 
    RowBox[{"1.0252690283581447`", " ", "kdz2"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.71246576107544*^9, 3.712465778059292*^9}, 
   3.7124665172262573`*^9, {3.712467024790382*^9, 3.712467045079895*^9}, 
   3.712468302859915*^9, {3.7124683776179953`*^9, 3.7124683807324047`*^9}, 
   3.7124706472143507`*^9, 3.712723887891232*^9, 3.712762496120936*^9, 
   3.712827745440721*^9, 3.713065309882434*^9, 3.713633753018404*^9, {
   3.714057495289113*^9, 3.714057503374942*^9}, 3.714057842081362*^9, 
   3.7140642789658127`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kpx2", "/.", 
      RowBox[{"solx", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{"kpx1", "\[Rule]", " ", "0"}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
      RowBox[{"d2", "\[Rule]", " ", 
       RowBox[{"-", "d"}]}], ",", 
      RowBox[{"JM", "\[Rule]", " ", "0"}], ",", 
      RowBox[{"lm", "\[Rule]", " ", "l2"}], ",", 
      RowBox[{"MM", "\[Rule]", " ", "0"}]}], "}"}]}], "//", "Simplify"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7124670680759373`*^9, 3.712467092517783*^9}, {
   3.712468398796323*^9, 3.712468433255746*^9}, 3.7127231150186872`*^9, 
   3.712723446553358*^9, 3.714057500659831*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Locked manipulator", "Title",
 CellChangeTimes->{3.714043892672473*^9}],

Cell["check notebook \[OpenCurlyDoubleQuote]manipulator fixed\
\[CloseCurlyDoubleQuote].nb", "Chapter",
 CellChangeTimes->{{3.714056139727254*^9, 3.71405615339953*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Integral action", "Title",
 CellChangeTimes->{3.714043899639945*^9}],

Cell[CellGroupData[{

Cell["Integral term in control law", "Chapter",
 CellChangeTimes->{{3.7140575885829678`*^9, 3.714057600548637*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dA", "=", 
   RowBox[{"Length", "[", "AMatrix", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zz", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"dA", "+", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uI", "=", 
   RowBox[{"{", 
    RowBox[{"zz", ",", "zz", ",", 
     RowBox[{
      RowBox[{"-", "M1"}], " ", "k1I", "  ", 
      RowBox[{"UnitVector", "[", 
       RowBox[{
        RowBox[{"dA", "+", "2"}], ",", 
        RowBox[{"dA", "+", "1"}]}], "]"}]}], ",", "zz", ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"M2", "+", "MM"}], ")"}]}], " ", "k2I", " ", 
      RowBox[{"UnitVector", "[", 
       RowBox[{
        RowBox[{"dA", "+", "2"}], ",", 
        RowBox[{"dA", "+", "2"}]}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"uI", "//", "MatrixForm"}], "\[IndentingNewLine]", "uI"}], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{
       RowBox[{"-", "k1I"}], " ", "M1"}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"k2I", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "M2"}], "-", "MM"}], ")"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.714057602060122*^9, {3.7140578421824512`*^9, 3.714057849977854*^9}, 
   3.7140642790184717`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", 
     RowBox[{
      RowBox[{"-", "k1I"}], " ", "M1"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{"k2I", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "M2"}], "-", "MM"}], ")"}]}]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{
  3.714057602060122*^9, {3.7140578421824512`*^9, 3.714057849977854*^9}, 
   3.7140642790374327`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Augment state and state matrix", "Chapter",
 CellChangeTimes->{{3.714057539367818*^9, 3.714057549777384*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AMatrixI", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{"AMatrix", ",", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "[", "AMatrix", "]"}], ",", "2"}], "}"}]}], 
         "]"}], ",", "2"}], "]"}], " ", "+", " ", 
      RowBox[{"BMatrix", ".", "uI"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Dg", "[", "qeq", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"10", ",", ";;"}], "]"}], "]"}], ",", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"Length", "[", "q", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Dg", "[", "qeq", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"12", ",", ";;"}], "]"}], "]"}], ",", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"Length", "[", "q", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"AMatrixI", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{
  3.712413594796372*^9, {3.712413627962544*^9, 3.71241375324452*^9}, {
   3.712413819773795*^9, 3.712413877950577*^9}, {3.71241392311677*^9, 
   3.712413954234529*^9}, {3.712414112788808*^9, 3.712414117282961*^9}, {
   3.7124143050682487`*^9, 3.712414309088584*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0"},
     {
      RowBox[{
       FractionBox[
        RowBox[{"kpx2", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{"kpx1", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpx1"}], " ", "M1"}], "-", 
           RowBox[{"kpx2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "0", "0", 
      RowBox[{
       FractionBox[
        RowBox[{"kpx2", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpx2"}], " ", 
            SuperscriptBox["l2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "-", 
           FractionBox[
            RowBox[{"gravity", " ", "l2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "d2"}], " ", 
                RowBox[{"(", 
                 RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
               RowBox[{"d1", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
            RowBox[{"d1", "-", "d2"}]]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"kpx1", " ", "l1", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpx1"}], " ", 
            SuperscriptBox["l1", "2"], " ", "M1"}], "+", 
           FractionBox[
            RowBox[{"gravity", " ", "l1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "d1"}], " ", "M1"}], "+", 
               RowBox[{"d2", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}]}], 
            RowBox[{"d1", "-", "d2"}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], 
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"kdx2", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{"kdx1", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kdx1"}], " ", "M1"}], "-", 
           RowBox[{"kdx2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "0", "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"kdx2", " ", 
          SuperscriptBox["l2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"l2", " ", "M2"}], "+", 
            RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
          "+", 
          RowBox[{
           SuperscriptBox["lm", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
          RowBox[{
           SuperscriptBox["l2", "2"], " ", "M2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"JM", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "+", 
       FractionBox[
        RowBox[{"kdx2", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "0", "0", "0"},
     {"0", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpz1"}], " ", "M1"}], "-", 
           RowBox[{"kpz2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "M1"}], "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d1"}], " ", "kpz1", " ", "M1"}], "-", 
           RowBox[{"d2", " ", "kpz2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d1"}], " ", "kpz1", " ", "M1"}], "-", 
           RowBox[{"d2", " ", "kpz2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "M1"}], "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["d1", "2"]}], " ", "kpz1", " ", "M1"}], "-", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "kpz2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "0", 
      "0", "0", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kdz1"}], " ", "M1"}], "-", 
           RowBox[{"kdz2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "M1"}], "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d1"}], " ", "kdz1", " ", "M1"}], "-", 
           RowBox[{"d2", " ", "kdz2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d1"}], " ", "kdz1", " ", "M1"}], "-", 
           RowBox[{"d2", " ", "kdz2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "M1"}], "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["d1", "2"]}], " ", "kdz1", " ", "M1"}], "-", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "kdz2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "0", 
      "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"k1I", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"Jbar", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], 
      FractionBox[
       RowBox[{"k2I", " ", 
        RowBox[{"(", 
         RowBox[{"Jbar", "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", "M1"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "M2"}], "-", "MM"}], ")"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{"Jbar", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]},
     {"0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d1", " ", "M1"}], "+", 
            RowBox[{"d2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "kpz1"}], " ", "M1"}], "-", 
            RowBox[{"kpz2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "M1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"Jbar", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d1"}], " ", "kpz1", " ", "M1"}], "-", 
           RowBox[{"d2", " ", "kpz2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d1", " ", "M1"}], "+", 
            RowBox[{"d2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "d1"}], " ", "kpz1", " ", "M1"}], "-", 
            RowBox[{"d2", " ", "kpz2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "M1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"Jbar", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["d1", "2"]}], " ", "kpz1", " ", "M1"}], "-", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "kpz2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "0", 
      "0", "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d1", " ", "M1"}], "+", 
            RowBox[{"d2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "kdz1"}], " ", "M1"}], "-", 
            RowBox[{"kdz2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "M1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"Jbar", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d1"}], " ", "kdz1", " ", "M1"}], "-", 
           RowBox[{"d2", " ", "kdz2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d1", " ", "M1"}], "+", 
            RowBox[{"d2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "d1"}], " ", "kdz1", " ", "M1"}], "-", 
            RowBox[{"d2", " ", "kdz2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "M1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"Jbar", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["d1", "2"]}], " ", "kdz1", " ", "M1"}], "-", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "kdz2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "0", 
      "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"k1I", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d2"}], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], 
      FractionBox[
       RowBox[{"k2I", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "M1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "M2"}], "-", "MM"}], ")"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{"Jbar", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]},
     {
      RowBox[{
       FractionBox[
        RowBox[{"kpx2", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{"kpx1", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpx1"}], " ", "M1"}], "-", 
           RowBox[{"kpx2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "0", "0", 
      RowBox[{
       FractionBox[
        RowBox[{"kpx2", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpx2"}], " ", 
            SuperscriptBox["l2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "-", 
           FractionBox[
            RowBox[{"gravity", " ", "l2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "d2"}], " ", 
                RowBox[{"(", 
                 RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
               RowBox[{"d1", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
            RowBox[{"d1", "-", "d2"}]]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"kpx1", " ", "l1", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpx1"}], " ", 
            SuperscriptBox["l1", "2"], " ", "M1"}], "+", 
           FractionBox[
            RowBox[{"gravity", " ", "l1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "d1"}], " ", "M1"}], "+", 
               RowBox[{"d2", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}]}], 
            RowBox[{"d1", "-", "d2"}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"kdx2", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{"kdx1", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kdx1"}], " ", "M1"}], "-", 
           RowBox[{"kdx2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "0", "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"kdx2", " ", 
          SuperscriptBox["l2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
          "+", 
          RowBox[{
           SuperscriptBox["lm", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
          RowBox[{
           SuperscriptBox["l2", "2"], " ", "M2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"JM", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "+", 
       FractionBox[
        RowBox[{"kdx2", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "0", "0", "0"},
     {
      RowBox[{
       FractionBox[
        RowBox[{"kpx2", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpx1"}], " ", "M1"}], "-", 
           RowBox[{"kpx2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{"kpx1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}], 
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]]}], "0", 
      "0", 
      RowBox[{
       FractionBox[
        RowBox[{"kpx2", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], 
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpx2"}], " ", 
            SuperscriptBox["l2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "-", 
           FractionBox[
            RowBox[{"gravity", " ", "l2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "d2"}], " ", 
                RowBox[{"(", 
                 RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
               RowBox[{"d1", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
            RowBox[{"d1", "-", "d2"}]]}], ")"}]}], 
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"kpx1", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpx1"}], " ", 
            SuperscriptBox["l1", "2"], " ", "M1"}], "+", 
           FractionBox[
            RowBox[{"gravity", " ", "l1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "d1"}], " ", "M1"}], "+", 
               RowBox[{"d2", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}]}], 
            RowBox[{"d1", "-", "d2"}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}], 
        RowBox[{
         SuperscriptBox["l1", "2"], " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"kdx2", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l2", " ", "M2"}], "+", 
           RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kdx1"}], " ", "M1"}], "-", 
           RowBox[{"kdx2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{"kdx1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}], 
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]]}], "0", 
      "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"kdx2", " ", 
          SuperscriptBox["l2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"l2", " ", "M2"}], "+", 
            RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
         RowBox[{"l1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}],
             "+", 
            RowBox[{
             SuperscriptBox["lm", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
            RowBox[{
             SuperscriptBox["l2", "2"], " ", "M2", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"JM", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]]}], "+", 
       FractionBox[
        RowBox[{"kdx2", " ", "l2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], 
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"kdx1", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"JM", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "-", 
       FractionBox[
        RowBox[{"kdx1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
           "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2"}], ")"}], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]]}], "0", "0"},
     {"0", "1", "d1", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "d2", "0", "0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.71272390792524*^9, 3.7128277458350677`*^9, 
  3.714057554388945*^9, 3.714057606597756*^9, 3.714057852742103*^9, 
  3.714064279112707*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Similarity matrix ", "Chapter",
 CellChangeTimes->{{3.714057638497991*^9, 3.7140576436254797`*^9}, 
   3.714057858452422*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"e", "[", "i_", "]"}], ":=", 
  RowBox[{"UnitVector", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"Length", "[", "qt", "]"}]}], "+", "2"}], ",", "i"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n1", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["d2", 
        RowBox[{"d1", "-", "d2"}]]}], 
      RowBox[{"e", "[", "11", "]"}]}], "+", 
     RowBox[{
      FractionBox["d1", 
       RowBox[{"d1", "-", "d2"}]], " ", 
      RowBox[{"e", "[", "12", "]"}]}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n2", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{
         RowBox[{"-", "d1"}], "+", "d2"}]]}], " ", 
      RowBox[{"e", "[", "11", "]"}]}], "-", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"d1", "-", "d2"}]], " ", 
      RowBox[{"e", "[", "12", "]"}]}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ps", "=", 
   RowBox[{
    RowBox[{"e", "[", "1", "]"}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"JM", "-", 
       RowBox[{"lm", " ", 
        RowBox[{"(", 
         RowBox[{"l2", "-", "lm"}], ")"}], " ", "MM"}]}], 
      RowBox[{
       RowBox[{"lm", " ", "m"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"l2", "-", "lm"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", "MM"}], ")"}]}]}]], 
     RowBox[{"e", "[", "4", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"n1", ",", 
       RowBox[{"n1", ".", "AMatrixI"}], ",", 
       RowBox[{"n1", ".", "AMatrixI", ".", "AMatrixI"}], ",", 
       RowBox[{"(*", 
        RowBox[{"z", " ", "bar", " ", "linear", " ", "motion"}], "*)"}], 
       "\[IndentingNewLine]", "n2", ",", 
       RowBox[{"n2", ".", "AMatrixI"}], ",", 
       RowBox[{"n2", ".", "AMatrixI", ".", "AMatrixI"}], ",", 
       RowBox[{"(*", 
        RowBox[{"bar", " ", "angular", " ", "motion"}], "*)"}], 
       "\[IndentingNewLine]", "ps", ",", 
       RowBox[{"ps", ".", "AMatrixI"}], ",", 
       RowBox[{"ps", ".", "AMatrixI", ".", "AMatrixI"}], ",", 
       RowBox[{"ps", ".", "AMatrixI", ".", "AMatrixI", ".", "AMatrixI"}], ",", 
       RowBox[{"(*", 
        RowBox[{"angular", " ", "motion", " ", "cable"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"l2", " ", 
         RowBox[{"e", "[", "4", "]"}]}], "-", 
        RowBox[{"l1", " ", 
         RowBox[{"e", "[", "5", "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l2", " ", 
           RowBox[{"e", "[", "4", "]"}]}], "-", 
          RowBox[{"l1", " ", 
           RowBox[{"e", "[", "5", "]"}]}]}], ")"}], ".", "AMatrixI"}]}], 
      RowBox[{"(*", 
       RowBox[{"angular", " ", "motion", " ", "manipulator"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"e", "[", "4", "]"}], "+", 
         RowBox[{"e", "[", "5", "]"}]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"e", "[", "4", "]"}], "+", 
           RowBox[{"e", "[", "5", "]"}]}], ")"}], ".", "AMatrix"}]}], 
       RowBox[{"(*", 
        RowBox[{"angular", " ", "motion", " ", "manipulator"}], "*)"}], 
       "*)"}], "\[IndentingNewLine]", "}"}], "/.", "gainsRelations"}], "//", 
    "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7140578610091352`*^9, 3.714057884965712*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interpretation for P matrix", "Chapter",
 CellChangeTimes->{{3.71405763177765*^9, 3.7140576336537447`*^9}, {
  3.714057673250952*^9, 3.7140576816484756`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n1", ".", "AMatrixI", ".", "AMatrixI"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n2", ".", "AMatrixI", ".", "AMatrixI"}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.712414712383163*^9, 3.712414730688088*^9}, {
  3.714057890879971*^9, 3.714057893219162*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.712414731324698*^9, 3.712470656698206*^9, 
  3.7127239600160418`*^9, 3.7128277562449427`*^9, 3.714057893596895*^9, 
  3.714064279644814*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", 
   ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.712414731324698*^9, 3.712470656698206*^9, 
  3.7127239600160418`*^9, 3.7128277562449427`*^9, 3.714057893596895*^9, 
  3.714064279663143*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Similar state matrix", "Chapter",
 CellChangeTimes->{{3.714057898978271*^9, 3.714057903459269*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AT", "=", 
   RowBox[{
    RowBox[{"P", ".", "AMatrixI", ".", 
     RowBox[{"Inverse", "[", "P", "]"}]}], "/.", "gainsRelations"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7123847134213867`*^9, 3.712384827780115*^9}, {
   3.7123850076117983`*^9, 3.7123850098161*^9}, {3.712386697154078*^9, 
   3.7123867063382053`*^9}, {3.712386914718993*^9, 3.71238692572136*^9}, 
   3.712394615038212*^9, {3.712409256546166*^9, 3.712409258882004*^9}, 
   3.7124142197790213`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Az and A\[Theta]", "Chapter",
 CellChangeTimes->{{3.7140579150292664`*^9, 3.714057917853961*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AT", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "6"}], ",", 
      RowBox[{"1", ";;", "6"}]}], "]"}], "]"}], "//", "Simplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AT", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "6"}], ",", 
      RowBox[{"7", ";;", "12"}]}], "]"}], "]"}], "//", "Simplify"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.712414363409017*^9, 3.712414375043557*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "d2"}], " ", "k1I"}], "+", 
            RowBox[{"d1", " ", "k2I"}]}], ")"}], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k1I", " ", "M1"}], "+", 
            RowBox[{"k2I", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "kpz2", " ", 
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " ", "M1"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"Jbar", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "kdz2", " ", 
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " ", "M1"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"Jbar", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "d2"}], " ", "Jbar", " ", "k2I", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{"k1I", "-", "k2I"}], ")"}], " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "-", 
        RowBox[{"d1", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Jbar", " ", "k1I"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"k1I", "-", "k2I"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{"Jbar", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]], "0", 
      "0"},
     {"0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"d2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "k1I"}], " ", "M1"}], "+", 
            RowBox[{"k2I", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"d1", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "k2I"}], " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"k1I", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "kpz2", " ", 
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{"d1", " ", "d2", " ", "m"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "M1"}], "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Jbar"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"Jbar", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "kdz2", " ", 
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{"d1", " ", "d2", " ", "m"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "M1"}], "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Jbar"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"Jbar", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{"k1I", "+", "k2I"}], ")"}], " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "k2I", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "k1I", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{"Jbar", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", "kpz2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{
         RowBox[{"-", "Jbar"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", "kdz2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{
         RowBox[{"-", "Jbar"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.712414793418703*^9, 3.712414936578472*^9, 3.712414990729362*^9, 
   3.712470657502452*^9, 3.712723974199608*^9, 3.712827756983921*^9, {
   3.7140579107251377`*^9, 3.714057919073914*^9}, 3.714064279990453*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.712414793418703*^9, 3.712414936578472*^9, 3.712414990729362*^9, 
   3.712470657502452*^9, 3.712723974199608*^9, 3.712827756983921*^9, {
   3.7140579107251377`*^9, 3.714057919073914*^9}, 3.7140642800108213`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["how to block diagonalize matrix", "Chapter",
 CellChangeTimes->{{3.714057936263446*^9, 3.7140579434856853`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"kIsol", " ", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"AT", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "6"}], ",", 
          RowBox[{"1", ";;", "6"}]}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "4"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
     "k1I"}], "]"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.712414802475184*^9, 3.712414845228074*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"k1I", "\[Rule]", 
    FractionBox[
     RowBox[{"d2", " ", "k2I", " ", 
      RowBox[{"(", 
       RowBox[{"Jbar", "+", 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "M1"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"M2", "+", "MM"}], ")"}]}], 
     RowBox[{"d1", " ", "M1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "Jbar"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.71241482390032*^9, 3.712414827912403*^9}, 
   3.7124148691911573`*^9, 3.712414940603528*^9, 3.7124149925834303`*^9, 
   3.712470657754722*^9, 3.7127239764368477`*^9, 3.7128277573021393`*^9, {
   3.714057933380951*^9, 3.714057944349085*^9}, 3.7140642801033783`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["State matrix with given choice", "Chapter",
 CellChangeTimes->{{3.71405795502838*^9, 3.714057959334939*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gainsRelations", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"gainsRelations", ",", 
     RowBox[{"kIsol", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AT", "=", 
   RowBox[{
    RowBox[{"P", ".", "AMatrixI", ".", 
     RowBox[{"Inverse", "[", "P", "]"}]}], "/.", "gainsRelations"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AT", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "6"}], ",", 
      RowBox[{"1", ";;", "6"}]}], "]"}], "]"}], "//", "Simplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AT", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"1", ";;", "6"}], ",", 
       RowBox[{"1", ";;", "6"}]}], "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
      RowBox[{"d2", "\[Rule]", " ", 
       RowBox[{"-", "d"}]}], ",", 
      RowBox[{"lm", "\[Rule]", " ", "l2"}]}], "}"}]}], "//", "Simplify"}], "//",
   "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"AT", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "6"}], ",", 
         RowBox[{"1", ";;", "6"}]}], "]"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
        RowBox[{"d2", "\[Rule]", " ", 
         RowBox[{"-", "d"}]}], ",", 
        RowBox[{"lm", "\[Rule]", " ", "l2"}], ",", 
        RowBox[{"JM", "\[Rule]", " ", "0"}]}], "}"}]}], "//", "Simplify"}], "//",
     "MatrixForm"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.712414853356646*^9, 3.712414874461141*^9}, {
   3.712470686604928*^9, 3.7124707022953863`*^9}, 3.712723118063999*^9, 
   3.712723446566544*^9, {3.712827705702894*^9, 3.7128277161429577`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "k2I", " ", 
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " ", "M1"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"Jbar", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "kpz2", " ", 
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " ", "M1"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"Jbar", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "kdz2", " ", 
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " ", "M1"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"Jbar", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}]]}], "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "k2I", " ", 
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{"d1", " ", "d2", " ", "m"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "M1"}], "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Jbar"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"Jbar", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "kpz2", " ", 
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{"d1", " ", "d2", " ", "m"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "M1"}], "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Jbar"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"Jbar", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "kdz2", " ", 
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{"d1", " ", "d2", " ", "m"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "M1"}], "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Jbar"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"Jbar", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", "k2I", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{
         RowBox[{"-", "Jbar"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", "kpz2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{
         RowBox[{"-", "Jbar"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", "kdz2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{
         RowBox[{"-", "Jbar"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.712414875258457*^9, 3.712415001961052*^9, 
  3.712470657967757*^9, 3.712470702804825*^9, 3.712723986855371*^9, 
  3.712827757448917*^9, 3.714057960414864*^9, 3.714064280220518*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "k2I", " ", 
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "M1"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "M1", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"m", " ", 
             RowBox[{"(", 
              RowBox[{"M1", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpz2", " ", 
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "M1"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "M1", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"m", " ", 
             RowBox[{"(", 
              RowBox[{"M1", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kdz2", " ", 
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "M1"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "M1", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
            RowBox[{"m", " ", 
             RowBox[{"(", 
              RowBox[{"M1", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}]]}], 
      "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "1"},
     {
      FractionBox[
       RowBox[{"2", " ", "d", " ", "k2I", " ", 
        RowBox[{"(", 
         RowBox[{"Jbar", "-", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", "m"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"M1", "-", "M2", "-", "MM"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"M2", "+", "MM"}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Jbar", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Jbar", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", "M1", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
             RowBox[{"m", " ", 
              RowBox[{"(", 
               RowBox[{"M1", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "d", " ", "kpz2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Jbar"}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", "m"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M1", "-", "M2", "-", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Jbar", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", "M1", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
              RowBox[{"m", " ", 
               RowBox[{"(", 
                RowBox[{"M1", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "d", " ", "kdz2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Jbar"}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", "m"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M1", "-", "M2", "-", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Jbar", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Jbar", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", "M1", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
              RowBox[{"m", " ", 
               RowBox[{"(", 
                RowBox[{"M1", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "k2I", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{"Jbar", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kpz2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{"Jbar", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kdz2", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], 
        RowBox[{"Jbar", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"M2", "+", "MM"}], ")"}]}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.712414875258457*^9, 3.712415001961052*^9, 
  3.712470657967757*^9, 3.712470702804825*^9, 3.712723986855371*^9, 
  3.712827757448917*^9, 3.714057960414864*^9, 3.714064280354477*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Attitude inner loop", "Title",
 CellChangeTimes->{{3.714043905717435*^9, 3.714043909921772*^9}}],

Cell["(under work)", "Chapter",
 CellChangeTimes->{{3.71405619336007*^9, 3.714056196374139*^9}}]
}, Closed]]
},
WindowSize->{988, 849},
WindowMargins->{{1, Automatic}, {1, Automatic}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 164, 4, 109, "Chapter"],
Cell[CellGroupData[{
Cell[747, 28, 78, 1, 66, "Title"],
Cell[CellGroupData[{
Cell[850, 33, 255, 4, 59, "Subsubsection"],
Cell[1108, 39, 327, 9, 32, "Input"]
}, Open  ]],
Cell[1450, 51, 658, 9, 59, "Subsubsection"],
Cell[CellGroupData[{
Cell[2133, 64, 120, 1, 54, "Chapter"],
Cell[2256, 67, 4395, 103, 516, "Input"],
Cell[6654, 172, 457, 8, 49, "Text"],
Cell[7114, 182, 1003, 26, 96, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8154, 213, 110, 1, 65, "Chapter"],
Cell[8267, 216, 2216, 65, 144, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10520, 286, 145, 1, 65, "Chapter"],
Cell[10668, 289, 312, 4, 30, "Text"],
Cell[10983, 295, 4055, 94, 285, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15075, 394, 202, 3, 65, "Chapter"],
Cell[CellGroupData[{
Cell[15302, 401, 770, 21, 54, "Input"],
Cell[16075, 424, 3161, 89, 238, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19285, 519, 128, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[19438, 524, 180, 4, 32, "Input"],
Cell[19621, 530, 340, 6, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20010, 542, 269, 3, 65, "Chapter"],
Cell[20282, 547, 3230, 77, 152, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23549, 629, 97, 1, 65, "Chapter"],
Cell[23649, 632, 1425, 31, 96, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25111, 668, 120, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[25256, 673, 1463, 43, 117, "Input"],
Cell[26722, 718, 237, 4, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27008, 728, 154, 3, 65, "Chapter"],
Cell[CellGroupData[{
Cell[27187, 735, 2196, 62, 100, "Input"],
Cell[29386, 799, 482, 7, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[29917, 812, 294, 5, 65, "Chapter"],
Cell[30214, 819, 502, 13, 54, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30753, 837, 273, 4, 65, "Chapter"],
Cell[CellGroupData[{
Cell[31051, 845, 98, 1, 35, "Subsubsection"],
Cell[31152, 848, 287, 7, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31476, 860, 207, 2, 35, "Subsubsection"],
Cell[31686, 864, 1611, 40, 96, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33334, 909, 212, 4, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[33571, 917, 729, 21, 54, "Input"],
Cell[34303, 940, 1303, 36, 46, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[35667, 983, 176, 2, 65, "Chapter"],
Cell[CellGroupData[{
Cell[35868, 989, 1433, 25, 75, "Input"],
Cell[37304, 1016, 2923, 51, 194, "Output"],
Cell[40230, 1069, 10342, 276, 252, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[50633, 1352, 86, 1, 66, "Title"],
Cell[50722, 1355, 297, 8, 67, "Chapter",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[51044, 1367, 129, 1, 54, "Chapter"],
Cell[51176, 1370, 2888, 77, 138, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54101, 1452, 192, 2, 65, "Chapter"],
Cell[54296, 1456, 787, 22, 32, "Input"],
Cell[55086, 1480, 1044, 29, 96, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56167, 1514, 272, 5, 65, "Chapter"],
Cell[CellGroupData[{
Cell[56464, 1523, 1707, 40, 180, "Input"],
Cell[58174, 1565, 1697, 26, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[59920, 1597, 194, 4, 109, "Chapter"],
Cell[60117, 1603, 777, 20, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60931, 1628, 151, 2, 65, "Chapter"],
Cell[CellGroupData[{
Cell[61107, 1634, 245, 6, 32, "Input"],
Cell[61355, 1642, 1863, 27, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[63267, 1675, 115, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[63407, 1680, 1617, 26, 54, "Input"],
Cell[65027, 1708, 59135, 1666, 298, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[124223, 3381, 95, 1, 66, "Title"],
Cell[CellGroupData[{
Cell[124343, 3386, 113, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[124481, 3391, 1395, 42, 117, "Input"],
Cell[125879, 3435, 1086, 27, 74, "Output"],
Cell[126968, 3464, 1151, 29, 92, "Output"],
Cell[128122, 3495, 1226, 31, 108, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[129397, 3532, 105, 1, 65, "Chapter"],
Cell[129505, 3535, 645, 14, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130187, 3554, 191, 3, 65, "Chapter"],
Cell[CellGroupData[{
Cell[130403, 3561, 618, 14, 96, "Input"],
Cell[131024, 3577, 496, 8, 32, "Output"],
Cell[131523, 3587, 1094, 27, 74, "Output"],
Cell[132620, 3616, 1147, 30, 92, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[133816, 3652, 233, 3, 65, "Chapter"],
Cell[CellGroupData[{
Cell[134074, 3659, 1005, 23, 96, "Input"],
Cell[135082, 3684, 1354, 36, 92, "Output"],
Cell[136439, 3722, 1348, 37, 114, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[137848, 3766, 95, 1, 66, "Title"],
Cell[137946, 3769, 115, 1, 65, "Chapter"]
}, Closed]],
Cell[CellGroupData[{
Cell[138098, 3775, 90, 1, 66, "Title"],
Cell[CellGroupData[{
Cell[138213, 3780, 406, 7, 109, "Chapter"],
Cell[CellGroupData[{
Cell[138644, 3791, 2455, 68, 139, "Input"],
Cell[141102, 3861, 66000, 1771, 172, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[207139, 5637, 290, 6, 32, "Input"],
Cell[207432, 5645, 1883, 53, 47, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[209364, 5704, 104, 1, 65, "Chapter"],
Cell[209471, 5707, 3090, 62, 159, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[212598, 5774, 178, 2, 65, "Chapter"],
Cell[212779, 5778, 457, 9, 32, "Input"],
Cell[CellGroupData[{
Cell[213261, 5791, 454, 12, 32, "Input"],
Cell[213718, 5805, 38993, 1074, 270, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[252760, 6885, 132, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[252917, 6890, 1088, 31, 54, "Input"],
Cell[254008, 6923, 3162, 68, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[257207, 6996, 367, 9, 32, "Input"],
Cell[257577, 7007, 2487, 56, 56, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[260113, 7069, 212, 3, 65, "Chapter"],
Cell[CellGroupData[{
Cell[260350, 7076, 843, 21, 75, "Subsection"],
Cell[261196, 7099, 1693, 45, 138, "Input"],
Cell[CellGroupData[{
Cell[262914, 7148, 1905, 50, 117, "Input"],
Cell[264822, 7200, 1646, 47, 56, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[266529, 7254, 114, 1, 65, "Chapter"],
Cell[266646, 7257, 626, 15, 54, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[267309, 7277, 191, 2, 65, "Chapter"],
Cell[267503, 7281, 292, 8, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[267832, 7294, 114, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[267971, 7299, 2524, 79, 243, "Input"],
Cell[270498, 7380, 7275, 205, 122, "Output"],
Cell[277776, 7587, 833, 21, 92, "Output"],
Cell[278612, 7610, 847, 23, 126, "Output"],
Cell[279462, 7635, 16332, 417, 114, "Output"],
Cell[295797, 8054, 5913, 158, 114, "Output"],
Cell[301713, 8214, 5224, 137, 80, "Output"],
Cell[306940, 8353, 8353, 214, 80, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[315342, 8573, 109, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[315476, 8578, 3936, 127, 201, "Input"],
Cell[319415, 8707, 5506, 160, 132, "Output"],
Cell[324924, 8869, 813, 21, 92, "Output"],
Cell[325740, 8892, 824, 23, 126, "Output"],
Cell[326567, 8917, 5492, 152, 114, "Output"],
Cell[332062, 9071, 2763, 80, 110, "Output"],
Cell[334828, 9153, 2468, 69, 72, "Output"],
Cell[337299, 9224, 3070, 86, 80, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[340418, 9316, 110, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[340553, 9321, 811, 27, 54, "Input"],
Cell[341367, 9350, 3067, 85, 72, "Output"],
Cell[344437, 9437, 1611, 47, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[346085, 9489, 1187, 39, 54, "Input"],
Cell[347275, 9530, 2289, 65, 76, "Output"],
Cell[349567, 9597, 1399, 41, 72, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[351015, 9644, 192, 3, 65, "Chapter"],
Cell[351210, 9649, 4159, 108, 285, "Input"],
Cell[CellGroupData[{
Cell[355394, 9761, 1458, 37, 75, "Input"],
Cell[356855, 9800, 3644, 104, 128, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[360548, 9910, 153, 2, 65, "Chapter"],
Cell[CellGroupData[{
Cell[360726, 9916, 608, 16, 32, "Input"],
Cell[361337, 9934, 1201, 39, 53, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[362587, 9979, 114, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[362726, 9984, 3965, 90, 510, "Input"],
Cell[366694, 10076, 866, 17, 32, "Output"]
}, Open  ]],
Cell[367575, 10096, 786, 21, 32, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[368410, 10123, 77, 1, 66, "Title"],
Cell[368490, 10126, 168, 2, 65, "Chapter"]
}, Closed]],
Cell[CellGroupData[{
Cell[368695, 10133, 74, 1, 66, "Title"],
Cell[CellGroupData[{
Cell[368794, 10138, 115, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[368934, 10143, 955, 28, 117, "Input"],
Cell[369892, 10173, 1173, 29, 110, "Output"],
Cell[371068, 10204, 1186, 32, 54, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[372303, 10242, 115, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[372443, 10247, 1767, 46, 138, "Input"],
Cell[374213, 10295, 63474, 1785, 334, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[437736, 12086, 131, 2, 65, "Chapter"],
Cell[437870, 12090, 3603, 107, 303, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[441510, 12202, 164, 2, 65, "Chapter"],
Cell[CellGroupData[{
Cell[441699, 12208, 334, 8, 54, "Input"],
Cell[442036, 12218, 342, 7, 32, "Output"],
Cell[442381, 12227, 342, 7, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[442772, 12240, 105, 1, 65, "Chapter"],
Cell[442880, 12243, 503, 11, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[443420, 12259, 103, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[443548, 12264, 530, 17, 54, "Input"],
Cell[444081, 12283, 12984, 364, 166, "Output"],
Cell[457068, 12649, 1008, 25, 126, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[458125, 12680, 118, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[458268, 12685, 500, 15, 32, "Input"],
Cell[458771, 12702, 972, 26, 47, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[459792, 12734, 114, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[459931, 12739, 1892, 56, 117, "Input"],
Cell[461826, 12797, 10695, 300, 156, "Output"],
Cell[472524, 13099, 8079, 230, 166, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[480664, 13336, 102, 1, 66, "Title"],
Cell[480769, 13339, 96, 1, 65, "Chapter"]
}, Closed]]
}
]
*)

