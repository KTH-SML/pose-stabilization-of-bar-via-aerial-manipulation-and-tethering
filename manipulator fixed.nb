(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    249787,       6792]
NotebookOptionsPosition[    241598,       6506]
NotebookOutlinePosition[    241956,       6522]
CellTagsIndexPosition[    241913,       6519]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
Heterogeneous Collaborative Pose Stabilization of a Bar Via Aerial \
Manipulation and Tethering\
\>", "Chapter",
 CellChangeTimes->{3.714043925269031*^9}],

Cell[CellGroupData[{

Cell["Problem Description", "Title",
 CellChangeTimes->{3.714043861412257*^9}],

Cell[CellGroupData[{

Cell["\<\
import some functions that compute dynamics based on Lagrangian, and that \
lineartize the system dynamics around a point (should be an equilibrium point)\
\>", "Subsubsection",
 CellChangeTimes->{{3.714043954385538*^9, 3.7140440151805964`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NotebookEvaluate", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<lagrangian_matrices.nb\>\""}], "}"}], "]"}], "]"}], ";"}]], "Input",\

 CellChangeTimes->{{3.712255289034539*^9, 3.7122552920410633`*^9}}]
}, Open  ]],

Cell[TextData[StyleBox["Problem: 2D bar pose stabilization of bar tethered to \
1 uav and grasped by 1 uav via a one-link manipulator -- manipulator locked", \
"Subsubsection"]], "Subsubsection",
 CellChangeTimes->{{3.535359441795238*^9, 3.535359447164266*^9}, {
   3.625750347233474*^9, 3.6257503556738234`*^9}, {3.7081796858867607`*^9, 
   3.7081797314348383`*^9}, {3.7122023767161922`*^9, 3.712202427957158*^9}, 
   3.71220246449969*^9, {3.712407484338901*^9, 3.7124074984121304`*^9}, {
   3.714044037412551*^9, 3.714044108915683*^9}},
 ExpressionUUID -> "8c6e4113-1e33-4ae8-bdf9-095e34aa0ff1"],

Cell[CellGroupData[{

Cell["Position and generalized coordinated", "Chapter",
 CellChangeTimes->{{3.714044136148864*^9, 3.71404414372159*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"global", " ", "coordinates"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "REMARK", " ", "positions", " ", "are", " ", "of", " ", "center", " ", 
    "of", " ", "mass"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"px", ",", "pz", ",", 
       RowBox[{"(*", 
        RowBox[{"linear", " ", "position", " ", "of", " ", "bar"}], "*)"}], 
       "\[IndentingNewLine]", "nbarx", ",", "nbarz", ",", 
       RowBox[{"(*", 
        RowBox[{"angular", " ", "position", " ", "of", " ", "bar"}], "*)"}], 
       "\[IndentingNewLine]", "pmx", ",", "pmz", ",", 
       RowBox[{"(*", 
        RowBox[{"linear", " ", "position", " ", "of", " ", "manipulator"}], 
        "*)"}], "\[IndentingNewLine]", "nmx", ",", "nmz", ",", 
       RowBox[{"(*", 
        RowBox[{"angular", " ", "position", " ", "of", " ", "manipulator"}], 
        "*)"}], "\[IndentingNewLine]", "P1x", ",", "P1z", ",", 
       RowBox[{"(*", 
        RowBox[{"linear", " ", "position", " ", "of", " ", "uav", " ", "1"}], 
        "*)"}], "\[IndentingNewLine]", "P2x", ",", "P2z"}], 
      RowBox[{"(*", 
       RowBox[{"linear", " ", "position", " ", "of", " ", "uav", " ", "2"}], 
       "*)"}], "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"generalized", " ", 
      RowBox[{"coordinates", ":", " ", 
       RowBox[{"with", " ", "these"}]}]}], ",", " ", 
     RowBox[{
     "one", " ", "should", " ", "be", " ", "able", " ", "to", " ", 
      "reconstruct", " ", "the", " ", "global", " ", "coordinates"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"px", ",", "pz", ",", 
       RowBox[{"(*", 
        RowBox[{"linear", " ", "position", " ", "of", " ", "bar"}], "*)"}], 
       "\[IndentingNewLine]", "\[Alpha]bar", ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"angular", " ", "position", " ", "of", " ", "bar"}], " ", 
         "-", " ", 
         RowBox[{
          RowBox[{"w", ".", "r", ".", "t", ".", " ", "to"}], " ", "x", " ", 
          "axis"}]}], "*)"}], "\[IndentingNewLine]", "\[Alpha]C1"}], "  ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "angular", " ", "position", " ", "of", " ", "cable", " ", "1"}], " ", 
        "-", " ", 
        RowBox[{
         RowBox[{"w", ".", "r", ".", "t", ".", " ", "to"}], " ", "y", " ", 
         "axis"}]}], "*)"}], "\[IndentingNewLine]", "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.537875650856196*^9, 3.537875706470892*^9}, {
   3.70527711771891*^9, 3.7052771205190372`*^9}, {3.705277234254648*^9, 
   3.705277291572391*^9}, {3.705294619713979*^9, 3.705294621278212*^9}, {
   3.7070493283637*^9, 3.707049342455456*^9}, {3.707051010610423*^9, 
   3.707051021507587*^9}, {3.7070511209782553`*^9, 3.7070511213486643`*^9}, {
   3.707051261975539*^9, 3.707051266354985*^9}, {3.7070557488775663`*^9, 
   3.707055758243678*^9}, {3.70705588195124*^9, 3.7070559158163977`*^9}, {
   3.7070586751664867`*^9, 3.707058682074964*^9}, {3.707377148852126*^9, 
   3.7073772813305817`*^9}, {3.707399107435753*^9, 3.7073991299062634`*^9}, {
   3.707631662427849*^9, 3.707631663358962*^9}, {3.707633813256242*^9, 
   3.7076338209347754`*^9}, {3.708001224297695*^9, 3.708001244666469*^9}, {
   3.708179744704523*^9, 3.708179948572051*^9}, 3.71108324533064*^9, {
   3.711089886247382*^9, 3.7110898866294327`*^9}, {3.711099799153736*^9, 
   3.711099806124866*^9}, 3.712402024517878*^9, {3.714044420167972*^9, 
   3.714044420253366*^9}, {3.714045009782826*^9, 3.7140450165052567`*^9}},
 ExpressionUUID -> "2a4c5a2f-14ff-4a51-874d-d274721b773e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"qd", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"pxd", ",", "pzd", ",", 
     RowBox[{"(*", 
      RowBox[{"linear", " ", "velocity", " ", "of", " ", "bar"}], "*)"}], 
     "\[IndentingNewLine]", "\[Alpha]bard", ",", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"angular", " ", "velocity", " ", "of", " ", "bar"}], " ", "-", 
       " ", 
       RowBox[{
        RowBox[{"w", ".", "r", ".", "t", ".", " ", "to"}], " ", "x", " ", 
        "axis"}]}], "*)"}], "\[IndentingNewLine]", "\[Alpha]C1d"}], 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"angular", " ", "velocity", " ", "of", " ", "cable", " ", "1"}],
       " ", "-", " ", 
      RowBox[{
       RowBox[{"w", ".", "r", ".", "t", ".", " ", "to"}], " ", "y", " ", 
       "axis"}]}], "*)"}], "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.711090312805035*^9, 3.7110903208469877`*^9}, {
  3.714044198356216*^9, 3.714044202091302*^9}, {3.714044426346162*^9, 
  3.714044426471797*^9}},
 ExpressionUUID -> "f69c764e-0e75-4e9c-b485-8a40cccbb349"],

Cell["\<\
We will need to write the previous states as functions of time, so that we \
can take total derivatives. We can create new variables by applying a pure \
function:\
\>", "Text",
 CellChangeTimes->{{3.537875708338273*^9, 3.5378757399056873`*^9}, {
  3.537875925413426*^9, 3.537875955970327*^9}, {3.712202464538468*^9, 
  3.712202464561369*^9}, {3.71220265860371*^9, 3.712202661202537*^9}},
 ExpressionUUID -> "85809aa9-b23d-4de0-9b19-f1730e239aba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "generalized", " ", "coordinates", " ", "as", " ", "function", " ", "of", 
    " ", "time", " ", "and", " ", "its", " ", "1", "st", " ", "and", " ", "2",
     "nd", " ", "derivatives"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"qt", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", "t", "]"}], "&"}], "/@", "q"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qdt", "=", 
     RowBox[{"D", "[", 
      RowBox[{"qt", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qddt", "=", 
     RowBox[{"D", "[", 
      RowBox[{"qdt", ",", "t"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.5378759655652113`*^9, 3.537875978405024*^9}, {
   3.537876885017558*^9, 3.537876888437872*^9}, {3.537880235731019*^9, 
   3.537880236155603*^9}, {3.712380376572734*^9, 3.7123804217960243`*^9}, 
   3.712408129223044*^9},
 ExpressionUUID -> "13002005-e5e9-4011-8dce-b876428bd5e6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["8 holonomic constraints", "Chapter",
 CellChangeTimes->{{3.714044588033142*^9, 3.7140445958545094`*^9}, 
   3.714044980416707*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "pz_", ",", "nbarx_", ",", "nbarz_", ",", "pmx_", ",", 
      "pmz_", ",", "nmx_", ",", "nmz_", ",", "P1x_", ",", "P1z_", ",", "P2x_",
       ",", "P2z_"}], "}"}], "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", ".", "#"}], "&"}], "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"px", ",", "pz"}], "}"}], "+", 
         RowBox[{"d1", 
          RowBox[{"{", 
           RowBox[{"nbarx", ",", "nbarz"}], "}"}]}], "-", 
         RowBox[{"{", 
          RowBox[{"P1x", ",", "P1z"}], "}"}]}], "]"}], "-", 
       SuperscriptBox["l1", "2"]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"px", ",", "pz"}], "}"}], "+", 
      RowBox[{"d2", 
       RowBox[{"{", 
        RowBox[{"nbarx", ",", "nbarz"}], "}"}]}], "-", 
      RowBox[{"{", 
       RowBox[{"P2x", ",", "P2z"}], "}"}], "+", 
      RowBox[{"l2", " ", 
       RowBox[{"{", 
        RowBox[{"nmx", ",", "nmz"}], "}"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"px", ",", "pz"}], "}"}], "+", 
      RowBox[{"d2", 
       RowBox[{"{", 
        RowBox[{"nbarx", ",", "nbarz"}], "}"}]}], "-", 
      RowBox[{"{", 
       RowBox[{"pmx", ",", "pmz"}], "}"}], "+", 
      RowBox[{"lm", " ", 
       RowBox[{"{", 
        RowBox[{"nmx", ",", "nmz"}], "}"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nbarx", ",", "nbarz"}], "}"}], ".", 
        RowBox[{"{", 
         RowBox[{"nbarx", ",", "nbarz"}], "}"}]}], "-", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nmx", ",", "nmz"}], "}"}], ".", 
        RowBox[{"{", 
         RowBox[{"nmx", ",", "nmz"}], "}"}]}], "-", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nmx", ",", "nmz"}], "}"}], ".", 
       RowBox[{"{", 
        RowBox[{"nbarx", ",", "nbarz"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7140445970601788`*^9, 3.7140448177691174`*^9}, {
  3.71404486496996*^9, 3.714044867717222*^9}, {3.71404493252601*^9, 
  3.714045003201785*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Function g from generalized coordinates to position vector", "Chapter",
 CellChangeTimes->{{3.7140443477298393`*^9, 3.714044365263026*^9}}],

Cell["\<\
Define the map that relates the two sets of coordinates (the most important \
function!):\
\>", "Text",
 CellChangeTimes->{{3.537876040247859*^9, 3.537876067434545*^9}, 
   3.537876101555757*^9, {3.5378827232983513`*^9, 3.537882749474223*^9}},
 ExpressionUUID -> "c813662b-0f04-4b08-8050-25309ab1451e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"uvh", "[", "\[Alpha]_", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Alpha]", "]"}], ",", 
     RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uvv", "[", "\[Alpha]_", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], ",", 
      RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"g", "[", 
    RowBox[{"{", 
     RowBox[{"px_", ",", "pz_", ",", "\[Alpha]bar_", ",", "\[Alpha]C1_"}], 
     "}"}], "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"px", ",", "pz"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"uvh", "[", "\[Alpha]bar", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"px", ",", "pz"}], "}"}], "+", 
      RowBox[{"d2", " ", 
       RowBox[{"uvh", "[", "\[Alpha]bar", "]"}]}], "+", 
      RowBox[{"lm", " ", 
       RowBox[{"uvv", "[", "\[Alpha]bar", "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"uvv", "[", "\[Alpha]bar", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"px", ",", "pz"}], "}"}], "+", 
      RowBox[{"d1", " ", 
       RowBox[{"uvh", "[", "\[Alpha]bar", "]"}]}], "+", 
      RowBox[{"l1", " ", 
       RowBox[{"uvv", "[", "\[Alpha]C1", "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"px", ",", "pz"}], "}"}], "+", 
      RowBox[{"d2", " ", 
       RowBox[{"uvh", "[", "\[Alpha]bar", "]"}]}], "+", 
      RowBox[{"l2", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ".", 
        RowBox[{"uvh", "[", "\[Alpha]bar", "]"}]}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.537876074907959*^9, 3.537876076674851*^9}, {
   3.537877255919182*^9, 3.5378772575499077`*^9}, {3.537880102391426*^9, 
   3.537880106412527*^9}, 3.53920098987811*^9, {3.539201054866827*^9, 
   3.539201060781165*^9}, {3.705277331261415*^9, 3.7052773678984957`*^9}, {
   3.7052774103985786`*^9, 3.705277435114867*^9}, {3.705277496846698*^9, 
   3.705277558433708*^9}, {3.705293789674754*^9, 3.705293799602372*^9}, {
   3.707049357498105*^9, 3.707049367521861*^9}, {3.7070494289467497`*^9, 
   3.707049462978292*^9}, {3.707049715724574*^9, 3.707049715969323*^9}, {
   3.707051276609754*^9, 3.707051278207502*^9}, {3.707055772667694*^9, 
   3.707055784772543*^9}, {3.7070558945618763`*^9, 3.707055928851099*^9}, {
   3.7070586982082777`*^9, 3.707058713135297*^9}, {3.707377321004766*^9, 
   3.707377373130725*^9}, {3.707399147653522*^9, 3.707399178668713*^9}, {
   3.707409725233466*^9, 3.707409725251438*^9}, {3.7076316856107063`*^9, 
   3.707631715111828*^9}, {3.707631747862039*^9, 3.7076317850842113`*^9}, {
   3.707633832177225*^9, 3.7076338375063972`*^9}, 3.708088272870463*^9, {
   3.708137877502083*^9, 3.708137899848523*^9}, {3.711083272487733*^9, 
   3.711083276593732*^9}, 3.711089904216239*^9, {3.7110899926248217`*^9, 
   3.711090015625568*^9}, {3.7124020437416687`*^9, 3.712402089049574*^9}, 
   3.712402280243423*^9, {3.714044404808881*^9, 3.714044443508625*^9}, {
   3.714058043889591*^9, 3.71405807963866*^9}},
 ExpressionUUID -> "d0fd8828-3b3f-415d-b01e-81c531f7ed9a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Jacobian of map g", "Chapter",
 CellChangeTimes->{{3.712380447637004*^9, 3.712380451934094*^9}, {
  3.712408153869577*^9, 3.712408162730542*^9}, {3.7140443833865747`*^9, 
  3.714044386507687*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Dg", "[", 
    RowBox[{"{", 
     RowBox[{"px_", ",", "pz_", ",", "\[Alpha]bar_", ",", "\[Alpha]C1_"}], 
     "}"}], "]"}], "=", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"g", "[", "q", "]"}], ",", 
      RowBox[{"{", "q", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"J", "=", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"g", "[", "qt", "]"}], ",", 
      RowBox[{"{", "qt", "}"}]}], "]"}]}], ")"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.714044409650546*^9, 3.714044409832756*^9}, 
   3.71404444351546*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Alpha]bar", "[", "t", "]"}], "]"}]}], "0"},
     {"0", "0", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Alpha]bar", "[", "t", "]"}], "]"}], "0"},
     {"1", "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "lm"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Alpha]bar", "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"d2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Alpha]bar", "[", "t", "]"}], "]"}]}]}], "0"},
     {"0", "1", 
      RowBox[{
       RowBox[{"d2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Alpha]bar", "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"lm", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Alpha]bar", "[", "t", "]"}], "]"}]}]}], "0"},
     {"0", "0", 
      RowBox[{"-", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]bar", "[", "t", "]"}], "]"}]}], "0"},
     {"0", "0", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Alpha]bar", "[", "t", "]"}], "]"}]}], "0"},
     {"1", "0", 
      RowBox[{
       RowBox[{"-", "d1"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Alpha]bar", "[", "t", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"-", "l1"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]C1", "[", "t", "]"}], "]"}]}]},
     {"0", "1", 
      RowBox[{"d1", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]bar", "[", "t", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"-", "l1"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Alpha]C1", "[", "t", "]"}], "]"}]}]},
     {"1", "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "l2"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Alpha]bar", "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"d2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Alpha]bar", "[", "t", "]"}], "]"}]}]}], "0"},
     {"0", "1", 
      RowBox[{
       RowBox[{"d2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Alpha]bar", "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"l2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Alpha]bar", "[", "t", "]"}], "]"}]}]}], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7140580841939096`*^9, 3.714064377840322*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check g map satisfies holonomic constraints ", "Chapter",
 CellChangeTimes->{{3.714044823289524*^9, 3.71404483980197*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"g", "[", "q", "]"}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.714044848787335*^9, 3.714044856764862*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
   "}"}]], "Output",
 CellChangeTimes->{3.714058086858941*^9, 3.714064377895504*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kinetic and potential energy functions", "Chapter",
 CellChangeTimes->{{3.708181120684865*^9, 3.708181132020318*^9}, 
   3.708181295962384*^9, 3.712730431196821*^9, {3.714044472311593*^9, 
   3.714044480115984*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Kinectic", "[", 
   RowBox[{"{", 
    RowBox[{
    "pxd_", ",", "pzd_", ",", "nbarxd_", ",", "nbarzd_", ",", "pmxd_", ",", 
     "pmzd_", ",", "nmxd_", ",", "nmzd_", ",", "P1xd_", ",", "P1zd_", ",", 
     "P2xd_", ",", "P2zd_"}], "}"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], "M1", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["P1xd", "2"], "+", 
      SuperscriptBox["P1zd", "2"]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], "M2", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["P2xd", "2"], "+", 
      SuperscriptBox["P2zd", "2"]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], "m", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["pxd", "2"], "+", 
      SuperscriptBox["pzd", "2"]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], "Jbar", "  ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["nbarxd", "2"], "+", 
      SuperscriptBox["nbarzd", "2"]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], "MM", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["pmxd", "2"], "+", 
      SuperscriptBox["pmzd", "2"]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], "JM", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["nmxd", "2"], "+", 
      SuperscriptBox["nmzd", "2"]}], ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Potential", "[", 
   RowBox[{"{", 
    RowBox[{
    "px_", ",", "pz_", ",", "nbarx_", ",", "nbarz_", ",", "pmx_", ",", "pmz_",
      ",", "nmx_", ",", "nmz_", ",", "P1x_", ",", "P1z_", ",", "P2x_", ",", 
     "P2z_"}], "}"}], "]"}], ":=", 
  RowBox[{"gravity", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"M1", " ", "P1z"}], "+", 
     RowBox[{"M2", " ", "P2z"}], "+", 
     RowBox[{"m", " ", "pz"}], "+", 
     RowBox[{"MM", " ", "pmz"}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.5315700210108128`*^9, 3.531570113847682*^9}, {
   3.537876265026963*^9, 3.537876299056636*^9}, {3.5378772695871553`*^9, 
   3.537877271330921*^9}, {3.538891005856593*^9, 3.538891007407086*^9}, {
   3.70529395259408*^9, 3.7052939615437393`*^9}, 3.7052939977767477`*^9, {
   3.705294040437755*^9, 3.705294083529961*^9}, {3.7052941806151333`*^9, 
   3.705294183037215*^9}, {3.7052945547890453`*^9, 3.705294610906481*^9}, {
   3.706794922851754*^9, 3.706794923644573*^9}, {3.7067949572351847`*^9, 
   3.7067949630176563`*^9}, {3.7070494709462767`*^9, 3.707049542077465*^9}, {
   3.707050327568529*^9, 3.707050430032276*^9}, {3.7070513045186253`*^9, 
   3.70705132004698*^9}, {3.707055835746743*^9, 3.707055875694645*^9}, {
   3.707055938155796*^9, 3.707055940540186*^9}, {3.7070572167922583`*^9, 
   3.707057233090601*^9}, {3.707058766968213*^9, 3.707058781916214*^9}, {
   3.707377413310997*^9, 3.7073774255281467`*^9}, {3.707377457880165*^9, 
   3.70737757174139*^9}, {3.707399227189233*^9, 3.707399307464115*^9}, {
   3.707633844291562*^9, 3.707633865666338*^9}, {3.71220246040977*^9, 
   3.712202460447608*^9}, {3.712202491851122*^9, 3.712202503618841*^9}, {
   3.7122025460181313`*^9, 3.71220257106778*^9}, {3.712380513092469*^9, 
   3.712380513542139*^9}, {3.7140450097900343`*^9, 3.7140450165248404`*^9}},
 ExpressionUUID -> "6f8a9b07-7f8c-4f9c-8432-6d13f45d1059"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lagrangian", "Chapter",
 CellChangeTimes->{{3.714044484973217*^9, 3.7140444871547728`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "lagrangian", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"L", "[", 
     RowBox[{"p_", ",", "pd_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Kinectic", "[", "pd", "]"}], "-", 
     RowBox[{"Potential", "[", "p", "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"lagrangian", " ", "equations"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Lq", "=", 
     RowBox[{
      RowBox[{"L", "[", 
       RowBox[{
        RowBox[{"g", "[", "qt", "]"}], ",", 
        RowBox[{
         RowBox[{"Dg", "[", "qt", "]"}], ".", "qdt"}]}], "]"}], "//", 
      "Simplify"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.708067169861274*^9, 3.708067183425559*^9}, {
   3.708067250685109*^9, 3.708067340601609*^9}, {3.7081801712684402`*^9, 
   3.7081801796980143`*^9}, {3.708180325112464*^9, 3.708180357692067*^9}, {
   3.708180817747765*^9, 3.708180910748762*^9}, {3.708180944893852*^9, 
   3.7081810783016148`*^9}, {3.708181168921371*^9, 3.708181191095236*^9}, {
   3.7081831770631866`*^9, 3.708183206676272*^9}, {3.712202460608285*^9, 
   3.712202460654106*^9}, 3.7122027813513308`*^9, {3.7122028152875967`*^9, 
   3.7122028233567047`*^9}, {3.712252447688376*^9, 3.712252459433139*^9}, {
   3.7123806179164543`*^9, 3.712380637843601*^9}, {3.714044520432714*^9, 
   3.714044530014509*^9}},
 ExpressionUUID -> "ef458ca4-6e39-41ae-bd58-6a559fee4d8a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equations of motion from Lagrangian", "Chapter",
 CellChangeTimes->{{3.714044501869937*^9, 3.714044510194434*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UnactuatedEquationsOfMotion", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"Lq", ",", 
          RowBox[{"{", "qdt", "}"}]}], "]"}], ",", "t"}], "]"}], "-", 
      RowBox[{"D", "[", 
       RowBox[{"Lq", ",", 
        RowBox[{"{", "qt", "}"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"mass", ",", " ", 
    RowBox[{"coriolis", " ", "and", " ", "gravity", " ", "matrices"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"MMatrix", ",", "CMatrix", ",", "GMatrix"}], "}"}], "=", 
    RowBox[{"LagrangeMatrices", "[", 
     RowBox[{
      RowBox[{"Length", "[", "q", "]"}], ",", "g", ",", "Potential", ",", 
      "Kinectic"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"this", " ", "is", " ", "just", " ", "a", " ", "check"}], ",", 
    " ", 
    RowBox[{
    "to", " ", "make", " ", "sure", " ", "matrices", " ", "are", " ", 
     "correct"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MMatrix", "[", "qt", "]"}], ".", "qddt"}], "+", 
   RowBox[{
    RowBox[{"CMatrix", "[", 
     RowBox[{"qt", ",", "qdt"}], "]"}], ".", "qdt"}], "+", 
   RowBox[{"GMatrix", "[", "qt", "]"}], "-", "UnactuatedEquationsOfMotion"}], 
  "//", "Simplify"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.714058097125642*^9, 3.714064380829918*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Check that mass matrix is invertible around equilibrium point\
\>", "Chapter",
 CellChangeTimes->{{3.714044540509898*^9, 3.714044553387693*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Det", "[", 
     RowBox[{"MMatrix", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "]"}], "]"}], "//",
     "Simplify"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Det", "[", 
     RowBox[{"MMatrix", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "]"}], "]"}], "-", 
    
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["l1", "2"], " ", "M1", " ", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"M1", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"d1", "-", "d2"}], ")"}], "2"]}], "+", 
           RowBox[{"m", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "M1"}]}], " ", ")"}]}]}], 
          ")"}]}], "+", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"Jbar", "+", " ", "JM"}], ")"}]}], " ", "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "m", " ", "M2"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["lm", "2"], " ", "m"}], "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"l2", "-", "lm"}], ")"}], "2"], " ", "M2"}]}], ")"}],
             " ", "MM"}]}], ")"}]}]}], "\[IndentingNewLine]", ")"}]}], 
     "\[IndentingNewLine]", ")"}]}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.7127302967214727`*^9, 3.712730325159853*^9}, {
   3.712731091434038*^9, 3.712731219626836*^9}, {3.712731315028063*^9, 
   3.712731422892598*^9}, {3.7127314864404078`*^9, 3.712731528857667*^9}, 
   3.7127320800926743`*^9, {3.7140580593022747`*^9, 3.714058059306744*^9}, {
   3.714058109306328*^9, 3.714058155239768*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.712730326496295*^9, {3.7127310920934687`*^9, 3.712731102099155*^9}, {
   3.712731178547413*^9, 3.71273118643295*^9}, 3.712731220431561*^9, 
   3.71273132957977*^9, {3.7127313630083437`*^9, 3.712731423463969*^9}, {
   3.7127315015912333`*^9, 3.712731535888582*^9}, 3.712732085070509*^9, 
   3.712806593624016*^9, 3.7128213891393213`*^9, 3.713634293134007*^9, 
   3.713635229158866*^9, 3.7136353718491173`*^9, 3.713635446636376*^9, 
   3.713636272986986*^9, 3.7136366469309607`*^9, 3.7140581004505777`*^9, {
   3.714058135225724*^9, 3.7140581573870773`*^9}, 3.714064380917963*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Equilibrium state", "Code",
 FontWeight->"Plain"]], "Chapter",
 CellChangeTimes->{{3.708181265233707*^9, 3.708181265713923*^9}, 
   3.708181309218297*^9, {3.708181351257999*^9, 3.70818136579596*^9}, {
   3.714045076052676*^9, 3.714045080321437*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"equilibrium", " ", "--"}], " ", "generalized", " ", 
    "coordinate"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"qeq", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"Length", "[", "q", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qdeq", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"Length", "[", "q", "]"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.708181318323213*^9, 3.70818134239609*^9}, {
  3.708181375785921*^9, 3.7081813978362494`*^9}, {3.711082190971339*^9, 
  3.711082217858996*^9}, {3.7110900632326403`*^9, 3.711090063422863*^9}, {
  3.7110902480616302`*^9, 3.7110902519774733`*^9}, {3.714045175639629*^9, 
  3.714045175913357*^9}},
 ExpressionUUID -> "7c6c61fa-7135-4a51-87d8-f18d3b14e52c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Equilibrium input", "Code",
 FontWeight->"Plain"]], "Chapter",
 CellChangeTimes->{{3.708181265233707*^9, 3.708181265713923*^9}, 
   3.708181309218297*^9, {3.708181351257999*^9, 3.70818136579596*^9}, {
   3.714045076052676*^9, 3.714045089531629*^9}}],

Cell[CellGroupData[{

Cell["Input", "Subsubsection",
 CellChangeTimes->{{3.708181404575041*^9, 3.708181408928587*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"uu", "=", 
   RowBox[{"{", 
    RowBox[{"U1x", ",", "U1y", ",", "U2x", ",", "U2y"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7110901018107758`*^9, 3.711090102595442*^9}},
 ExpressionUUID -> "913d7803-8c52-4c21-a7cb-aa1794b5f86e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Function that maps how input affect acceleration of generalized coordinates\
\>", "Subsubsection",
 CellChangeTimes->{{3.7081814186147337`*^9, 3.708181440889977*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"px_", ",", "pz_", ",", "\[Alpha]bar_", ",", "\[Alpha]C1_"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"U1x_", ",", "U1y_", ",", "U2x_", ",", "U2y_"}], "}"}]}], "]"}],
    "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "+", 
    RowBox[{"(*", 
     RowBox[{"angular", " ", "acceleration", " ", "on", " ", "\[Alpha]man"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Evaluate", "[", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"g", "[", "q", "]"}], ",", 
         RowBox[{"{", "q", "}"}]}], "]"}], "]"}], "]"}], ".", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "U1x", ",", "U1y", ",", "U2x", ",", "U2y"}], "}"}]}]}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"linear", " ", "acceleration", " ", "on", " ", "Px1"}], ",", 
    "Py1", ",", "Px2", ",", "Py2"}], "*)"}], ";"}]], "Input",
 CellChangeTimes->{{3.708100940729021*^9, 3.7081009408614063`*^9}, {
   3.708101015226564*^9, 3.708101086012739*^9}, {3.7081373582399187`*^9, 
   3.708137358432314*^9}, {3.708140535298183*^9, 3.708140543660432*^9}, {
   3.70818137361593*^9, 3.70818137436969*^9}, 3.708181412138376*^9, {
   3.7081814439621363`*^9, 3.7081815431429*^9}, 3.7110834182572203`*^9, 
   3.711090015648273*^9, {3.711090076384243*^9, 3.71109007712584*^9}, {
   3.7110901218229237`*^9, 3.711090133316579*^9}, {3.712402172199226*^9, 
   3.712402173547615*^9}, 3.714044443553442*^9},
 ExpressionUUID -> "7c9758cd-5b10-4f49-a9b7-574b20676145"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equilibrium input", "Subsubsection",
 CellChangeTimes->{{3.708181548384183*^9, 3.708181561310329*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ueq", "=", 
  RowBox[{"uu", "/.", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GMatrix", "[", "qeq", "]"}], "\[Equal]", 
         RowBox[{"FU", "[", 
          RowBox[{"qeq", ",", "uu"}], "]"}]}], ",", "uu"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "//", "Simplify"}], ")"}]}]}]], "Input",\

 ExpressionUUID -> "e7223e63-0bd2-416e-b347-264b67ca6277"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"gravity", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d1"}], " ", "M1"}], "+", 
        RowBox[{"d2", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}]}], 
     RowBox[{"d1", "-", "d2"}]]}], ",", "0", ",", 
   FractionBox[
    RowBox[{"gravity", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "d2"}], " ", 
        RowBox[{"(", 
         RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
       RowBox[{"d1", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
    RowBox[{"d1", "-", "d2"}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.711083425196968*^9, {3.711090095929482*^9, 3.711090107885804*^9}, 
   3.711090138841598*^9, 3.711093474700795*^9, 3.711094595230481*^9, 
   3.711100406882753*^9, 3.71119646418648*^9, 3.712221335860262*^9, 
   3.712227681500759*^9, 3.712399733774637*^9, 3.712402177141663*^9, 
   3.71240228871994*^9, 3.7124026357359047`*^9, 3.7124028025634203`*^9, 
   3.712415080413456*^9, 3.7124152874531193`*^9, 3.712415419310575*^9, 
   3.7124156422725687`*^9, 3.712415887392569*^9, 3.7124159801418533`*^9, 
   3.712416259390355*^9, 3.712416733790353*^9, 3.712417308160533*^9, 
   3.7124234772798147`*^9, 3.712459182845894*^9, 3.712460489598145*^9, 
   3.7124617182512417`*^9, 3.7128065941682453`*^9, 3.7128213896737328`*^9, 
   3.7136342935390263`*^9, 3.713635229565865*^9, 3.713635372467202*^9, 
   3.713635447176395*^9, 3.713636273777576*^9, 3.713636647386602*^9, 
   3.714058166244567*^9, 3.714064381117836*^9},
 ExpressionUUID -> "30adb251-980d-4d30-856f-3c0f64f4aba5"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Find A and B matrices", "Chapter",
 CellChangeTimes->{{3.7081816097983217`*^9, 3.7081816138591833`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"AMatrix", ",", "BMatrix"}], "}"}], "=", 
   RowBox[{"LagrangeLinearization", "[", 
    RowBox[{
    "qeq", ",", "g", ",", "Potential", ",", "Kinectic", ",", "FU", ",", 
     "uu"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"AMatrix", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"BMatrix", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.70806690602981*^9, 3.708067137519293*^9}, 
   3.70806716823663*^9, {3.708067343481702*^9, 3.708067369864313*^9}, {
   3.708067405944409*^9, 3.708067479463253*^9}, {3.708067584088011*^9, 
   3.7080676056603327`*^9}, {3.70806764592771*^9, 3.70806769869061*^9}, {
   3.7080677483418503`*^9, 3.708067962566708*^9}, {3.70810080097167*^9, 
   3.708100842810926*^9}, 3.708100916994722*^9, {3.708101090871266*^9, 
   3.708101161330327*^9}, {3.7081368521598454`*^9, 3.7081368994090347`*^9}, {
   3.708137128767048*^9, 3.708137320915947*^9}, {3.70818158019107*^9, 
   3.708181580337303*^9}, {3.708181632311233*^9, 3.708181733560211*^9}, {
   3.70818276197582*^9, 3.708182906698174*^9}, {3.708183304879369*^9, 
   3.7081833126779003`*^9}, 3.7124021927257957`*^9},
 ExpressionUUID -> "20f9c02a-f665-46bc-84fe-7ffdbb395f4f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.708067963024736*^9, {3.7081008211590147`*^9, 3.7081008435758867`*^9}, 
   3.708137325107339*^9, 3.708139609108975*^9, 3.708140496773178*^9, 
   3.708140717717827*^9, 3.7081466563968353`*^9, 3.708162916510455*^9, 
   3.708172729483234*^9, 3.7081729384438057`*^9, 3.708181737847156*^9, 
   3.70818343188901*^9, 3.70818483602179*^9, 3.708184901911689*^9, 
   3.7081849549355993`*^9, 3.711081447553238*^9, 3.711081567657364*^9, 
   3.711082303106089*^9, 3.711083449466754*^9, 3.711090159067191*^9, 
   3.711093480894548*^9, 3.7110945957500753`*^9, 3.711100407282896*^9, 
   3.7111964646314163`*^9, 3.712221336429347*^9, 3.712227682093028*^9, 
   3.7123997342504168`*^9, 3.7124021962735662`*^9, 3.712402289800959*^9, 
   3.712402636837647*^9, 3.7124028036989183`*^9, 3.7124150814828043`*^9, 
   3.712415288576704*^9, 3.7124154204245*^9, 3.71241564347994*^9, 
   3.712415888529765*^9, 3.71241598144429*^9, 3.712416260687605*^9, 
   3.712416736350545*^9, 3.7124173094022427`*^9, 3.712423478461341*^9, 
   3.7124591839085693`*^9, 3.712460490184182*^9, 3.712461719317685*^9, 
   3.712806596106649*^9, 3.712821392481164*^9, 3.7136342957618113`*^9, 
   3.7136352315537043`*^9, 3.713635374410223*^9, 3.713635448961392*^9, 
   3.713636275691991*^9, 3.713636649142748*^9, 3.71405817013291*^9, 
   3.714064382787429*^9},
 ExpressionUUID -> "c31320d6-a0c1-43bc-9ff1-125b788d4c21"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "l2"}], " ", "M2"}], "-", 
          RowBox[{"lm", " ", "MM"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "-", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d1", " ", "M1"}], "+", 
            RowBox[{"d2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"l2", " ", "M2"}], "+", 
               RowBox[{"lm", " ", "MM"}]}], ")"}], "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"Jbar", "+", "JM", "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}]}], ")"}]}], 
        "-", 
        RowBox[{"M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"Jbar", "+", "JM", "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d1", " ", "M1"}], "+", 
              RowBox[{"d2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
          ")"}]}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"l2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"l2", " ", "M2"}], "+", 
            RowBox[{"lm", " ", "MM"}]}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"Jbar", "+", "JM", "+", 
            RowBox[{
             SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
            RowBox[{
             SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
            RowBox[{
             SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
            RowBox[{
             SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
            RowBox[{
             SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d1", " ", "M1"}], "+", 
            RowBox[{"d2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d1", " ", "M1"}], "+", 
             RowBox[{"d2", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"l2", " ", "M2"}], "+", 
                RowBox[{"lm", " ", "MM"}]}], ")"}], "2"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"Jbar", "+", "JM", "+", 
               RowBox[{
                SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
               RowBox[{
                SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
               RowBox[{
                SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
               RowBox[{
                SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
               RowBox[{
                SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}]}], ")"}]}], 
         "-", 
         RowBox[{"M1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"Jbar", "+", "JM", "+", 
               RowBox[{
                SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
               RowBox[{
                SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
               RowBox[{
                SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
               RowBox[{
                SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
               RowBox[{
                SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d1", " ", "M1"}], "+", 
               RowBox[{"d2", " ", 
                RowBox[{"(", 
                 RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
           ")"}]}]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "M1"}], "-", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "l2"}], " ", "M2"}], "-", 
          RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d1", " ", "M1"}], "+", 
            RowBox[{"d2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"l2", " ", "M2"}], "+", 
               RowBox[{"lm", " ", "MM"}]}], ")"}], "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"Jbar", "+", "JM", "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}]}], ")"}]}], 
        "-", 
        RowBox[{"M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"Jbar", "+", "JM", "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d1", " ", "M1"}], "+", 
              RowBox[{"d2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
          ")"}]}]}]]},
     {"0", 
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m", " ", "M1"}], "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "m", " ", "M2"}], "+", 
        RowBox[{
         SuperscriptBox["l2", "2"], " ", "m", " ", "M2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "M1", " ", "M2"}], "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         SuperscriptBox["M2", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "m", " ", "MM"}], "+", 
        RowBox[{
         SuperscriptBox["lm", "2"], " ", "m", " ", "MM"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "M1", " ", "MM"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d2", "2"], " ", "M2", " ", "MM"}], "+", 
        RowBox[{
         SuperscriptBox["l2", "2"], " ", "M2", " ", "MM"}], "-", 
        RowBox[{"2", " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], "+", 
        RowBox[{
         SuperscriptBox["lm", "2"], " ", "M2", " ", "MM"}], "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         SuperscriptBox["MM", "2"]}], "+", 
        RowBox[{"Jbar", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{"JM", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "-", 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "M1"}], "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d1", " ", "M1"}], "+", 
            RowBox[{"d2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"l2", " ", "M2"}], "+", 
               RowBox[{"lm", " ", "MM"}]}], ")"}], "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"Jbar", "+", "JM", "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}]}], ")"}]}], 
        "-", 
        RowBox[{"M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"Jbar", "+", "JM", "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d1", " ", "M1"}], "+", 
              RowBox[{"d2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
          ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "lm"}], " ", "MM"}], "+", 
          RowBox[{"l2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "M1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d1", " ", "M1"}], "+", 
            RowBox[{"d2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"l2", " ", "M2"}], "+", 
               RowBox[{"lm", " ", "MM"}]}], ")"}], "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"Jbar", "+", "JM", "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}]}], ")"}]}], 
        "-", 
        RowBox[{"M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"Jbar", "+", "JM", "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d1", " ", "M1"}], "+", 
              RowBox[{"d2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
          ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m", " ", "M1"}], "-", 
        RowBox[{"d1", " ", "d2", " ", "m", " ", "M1"}], "+", 
        RowBox[{
         SuperscriptBox["l2", "2"], " ", "m", " ", "M2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "M1", " ", "M2"}], "-", 
        RowBox[{"d1", " ", "d2", " ", "M1", " ", "M2"}], "+", 
        RowBox[{
         SuperscriptBox["lm", "2"], " ", "m", " ", "MM"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "M1", " ", "MM"}], "-", 
        RowBox[{"d1", " ", "d2", " ", "M1", " ", "MM"}], "+", 
        RowBox[{
         SuperscriptBox["l2", "2"], " ", "M2", " ", "MM"}], "-", 
        RowBox[{"2", " ", "l2", " ", "lm", " ", "M2", " ", "MM"}], "+", 
        RowBox[{
         SuperscriptBox["lm", "2"], " ", "M2", " ", "MM"}], "+", 
        RowBox[{"Jbar", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{"JM", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d1", " ", "M1"}], "+", 
            RowBox[{"d2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"l2", " ", "M2"}], "+", 
               RowBox[{"lm", " ", "MM"}]}], ")"}], "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"Jbar", "+", "JM", "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}]}], ")"}]}], 
        "-", 
        RowBox[{"M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"Jbar", "+", "JM", "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d1", " ", "M1"}], "+", 
              RowBox[{"d2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
          ")"}]}]}]]},
     {"0", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d1", " ", "M1"}], "+", 
            RowBox[{"d2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"l2", " ", "M2"}], "+", 
               RowBox[{"lm", " ", "MM"}]}], ")"}], "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"Jbar", "+", "JM", "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}]}], ")"}]}], 
        "-", 
        RowBox[{"M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"Jbar", "+", "JM", "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d1", " ", "M1"}], "+", 
              RowBox[{"d2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
          ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"lm", " ", "MM"}], "-", 
          RowBox[{"l2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "MM"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d1", " ", "M1"}], "+", 
            RowBox[{"d2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"l2", " ", "M2"}], "+", 
               RowBox[{"lm", " ", "MM"}]}], ")"}], "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"Jbar", "+", "JM", "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}]}], ")"}]}], 
        "-", 
        RowBox[{"M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"Jbar", "+", "JM", "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d1", " ", "M1"}], "+", 
              RowBox[{"d2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
          ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "M1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d1", " ", "M1"}], "+", 
            RowBox[{"d2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"l2", " ", "M2"}], "+", 
               RowBox[{"lm", " ", "MM"}]}], ")"}], "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"Jbar", "+", "JM", "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}]}], ")"}]}], 
        "-", 
        RowBox[{"M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"Jbar", "+", "JM", "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d1", " ", "M1"}], "+", 
              RowBox[{"d2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
          ")"}]}]}]]},
     {
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"l1", " ", "M1"}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "l2"}], " ", "M2"}], "-", 
          RowBox[{"lm", " ", "MM"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"M2", "+", "MM"}], ")"}]}], "-", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], 
       RowBox[{"l1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d1", " ", "M1"}], "+", 
              RowBox[{"d2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"l2", " ", "M2"}], "+", 
                 RowBox[{"lm", " ", "MM"}]}], ")"}], "2"]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"Jbar", "+", "JM", "+", 
                RowBox[{
                 SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}]}], ")"}]}],
           "-", 
          RowBox[{"M1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"Jbar", "+", "JM", "+", 
                RowBox[{
                 SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"d1", " ", "M1"}], "+", 
                RowBox[{"d2", " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
            ")"}]}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"l2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"l2", " ", "M2"}], "+", 
            RowBox[{"lm", " ", "MM"}]}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"Jbar", "+", "JM", "+", 
            RowBox[{
             SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
            RowBox[{
             SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
            RowBox[{
             SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
            RowBox[{
             SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
            RowBox[{
             SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d1", " ", "M1"}], "+", 
            RowBox[{"d2", " ", 
             RowBox[{"(", 
              RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d1", " ", "M1"}], "+", 
               RowBox[{"d2", " ", 
                RowBox[{"(", 
                 RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"l2", " ", "M2"}], "+", 
                  RowBox[{"lm", " ", "MM"}]}], ")"}], "2"]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"Jbar", "+", "JM", "+", 
                 RowBox[{
                  SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                 RowBox[{
                  SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                 RowBox[{
                  SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}]}], 
             ")"}]}], "-", 
           RowBox[{"M1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"Jbar", "+", "JM", "+", 
                 RowBox[{
                  SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                 RowBox[{
                  SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                 RowBox[{
                  SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"d1", " ", "M1"}], "+", 
                 RowBox[{"d2", " ", 
                  RowBox[{"(", 
                   RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
             ")"}]}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "M1"}], "-", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "l2"}], " ", "M2"}], "-", 
          RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
       RowBox[{"l1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d1", " ", "M1"}], "+", 
              RowBox[{"d2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"l2", " ", "M2"}], "+", 
                 RowBox[{"lm", " ", "MM"}]}], ")"}], "2"]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"Jbar", "+", "JM", "+", 
                RowBox[{
                 SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}]}], ")"}]}],
           "-", 
          RowBox[{"M1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"Jbar", "+", "JM", "+", 
                RowBox[{
                 SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"d1", " ", "M1"}], "+", 
                RowBox[{"d2", " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
            ")"}]}]}], ")"}]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.708067963024736*^9, {3.7081008211590147`*^9, 3.7081008435758867`*^9}, 
   3.708137325107339*^9, 3.708139609108975*^9, 3.708140496773178*^9, 
   3.708140717717827*^9, 3.7081466563968353`*^9, 3.708162916510455*^9, 
   3.708172729483234*^9, 3.7081729384438057`*^9, 3.708181737847156*^9, 
   3.70818343188901*^9, 3.70818483602179*^9, 3.708184901911689*^9, 
   3.7081849549355993`*^9, 3.711081447553238*^9, 3.711081567657364*^9, 
   3.711082303106089*^9, 3.711083449466754*^9, 3.711090159067191*^9, 
   3.711093480894548*^9, 3.7110945957500753`*^9, 3.711100407282896*^9, 
   3.7111964646314163`*^9, 3.712221336429347*^9, 3.712227682093028*^9, 
   3.7123997342504168`*^9, 3.7124021962735662`*^9, 3.712402289800959*^9, 
   3.712402636837647*^9, 3.7124028036989183`*^9, 3.7124150814828043`*^9, 
   3.712415288576704*^9, 3.7124154204245*^9, 3.71241564347994*^9, 
   3.712415888529765*^9, 3.71241598144429*^9, 3.712416260687605*^9, 
   3.712416736350545*^9, 3.7124173094022427`*^9, 3.712423478461341*^9, 
   3.7124591839085693`*^9, 3.712460490184182*^9, 3.712461719317685*^9, 
   3.712806596106649*^9, 3.712821392481164*^9, 3.7136342957618113`*^9, 
   3.7136352315537043`*^9, 3.713635374410223*^9, 3.713635448961392*^9, 
   3.713636275691991*^9, 3.713636649142748*^9, 3.71405817013291*^9, 
   3.7140643828082113`*^9},
 ExpressionUUID -> "c31320d6-a0c1-43bc-9ff1-125b788d4c21"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Control law and closed loop", "Title",
 CellChangeTimes->{3.714043867254344*^9}],

Cell[TextData[{
 "Define control laws: as functions of q and ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["q", "."], TraditionalForm]]]
}], "Chapter",
 InitializationCell->True,
 CellChangeTimes->{{3.7081819873180227`*^9, 3.708181989419869*^9}, {
   3.708182498182735*^9, 3.7081825174518642`*^9}, 3.7140581806265697`*^9}],

Cell[CellGroupData[{

Cell["control law for uav 1 and 2: PD control laws", "Chapter",
 CellChangeTimes->{{3.708182019639147*^9, 3.708182055637903*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"U1cl", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "pz_", ",", "nbarx_", ",", "nbarz_", ",", "pmx_", ",", 
       "pmz_", ",", "nmx_", ",", "nmz_", ",", "P1x_", ",", "P1z_", ",", 
       "P2x_", ",", "P2z_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "pxd_", ",", "pzd_", ",", "nbarxd_", ",", "nbarzd_", ",", "pmxd_", ",", 
       "pmzd_", ",", "nmxd_", ",", "nmzd_", ",", "P1xd_", ",", "P1zd_", ",", 
       "P2xd_", ",", "P2zd_"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"kpx1", " ", "P1x"}], ",", 
        RowBox[{"kpz1", " ", "P1z"}]}], "}"}]}], " ", "-", "  ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"kdx1", " ", "P1xd"}], ",", 
        RowBox[{"kdz1", " ", "P1zd"}]}], "}"}], "\[IndentingNewLine]", 
      RowBox[{"U2cl", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "px_", ",", "pz_", ",", "nbarx_", ",", "nbarz_", ",", "pmx_", ",", 
          "pmz_", ",", "nmx_", ",", "nmz_", ",", "P1x_", ",", "P1z_", ",", 
          "P2x_", ",", "P2z_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "pxd_", ",", "pzd_", ",", "nbarxd_", ",", "nbarzd_", ",", "pmxd_", 
          ",", "pmzd_", ",", "nmxd_", ",", "nmzd_", ",", "P1xd_", ",", 
          "P1zd_", ",", "P2xd_", ",", "P2zd_"}], "}"}]}], "]"}]}]}], ":=", 
    RowBox[{
     RowBox[{"-", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"kpx2", " ", "P2x"}], ",", 
        RowBox[{"kpz2", " ", "P2z"}]}], "}"}]}], " ", "-", "  ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"kdx2", " ", "P2xd"}], ",", 
        RowBox[{"kdz2", " ", "P2zd"}]}], "}"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"U1cl", "[", 
       RowBox[{
        RowBox[{"g", "[", "qeq", "]"}], ",", 
        RowBox[{
         RowBox[{"Dg", "[", "qeq", "]"}], ".", "qdeq"}]}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"U2cl", "[", 
       RowBox[{
        RowBox[{"g", "[", "qeq", "]"}], ",", 
        RowBox[{
         RowBox[{"Dg", "[", "qeq", "]"}], ".", "qdeq"}]}], "]"}]}]}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.71108712736161*^9, 3.711087143411004*^9}, 
   3.711087221031281*^9, {3.711087506454138*^9, 3.711087507411874*^9}, {
   3.712226098793837*^9, 3.712226113238043*^9}, {3.712402231115078*^9, 
   3.712402241672309*^9}, {3.712402338521391*^9, 3.7124023465254307`*^9}, {
   3.712461656366403*^9, 3.712461681861918*^9}, {3.714045009809084*^9, 
   3.714045016547414*^9}, 3.714055801851609*^9},
 ExpressionUUID -> "c0b95538-d80a-4b69-a218-bc9e89829619"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"U1cl", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "pz_", ",", "nbarx_", ",", "nbarz_", ",", "pmx_", ",", 
      "pmz_", ",", "nmx_", ",", "nmz_", ",", "P1x_", ",", "P1z_", ",", "P2x_",
       ",", "P2z_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "pxd_", ",", "pzd_", ",", "nbarxd_", ",", "nbarzd_", ",", "pmxd_", ",", 
      "pmzd_", ",", "nmxd_", ",", "nmzd_", ",", "P1xd_", ",", "P1zd_", ",", 
      "P2xd_", ",", "P2zd_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"M1", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"kpx1", " ", 
         RowBox[{"(", 
          RowBox[{"P1x", "-", "d1"}], ")"}]}], ",", 
        RowBox[{"kpz1", " ", 
         RowBox[{"(", 
          RowBox[{"P1z", "-", "l1"}], ")"}]}]}], "}"}]}], " ", "-", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"kdx1", " ", "P1xd"}], ",", 
       RowBox[{"kdz1", " ", "P1zd"}]}], "}"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U2cl", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "pz_", ",", "nbarx_", ",", "nbarz_", ",", "pmx_", ",", 
      "pmz_", ",", "nmx_", ",", "nmz_", ",", "P1x_", ",", "P1z_", ",", "P2x_",
       ",", "P2z_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "pxd_", ",", "pzd_", ",", "nbarxd_", ",", "nbarzd_", ",", "pmxd_", ",", 
      "pmzd_", ",", "nmxd_", ",", "nmzd_", ",", "P1xd_", ",", "P1zd_", ",", 
      "P2xd_", ",", "P2zd_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"M2", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"kpx2", " ", 
         RowBox[{"(", 
          RowBox[{"P2x", "-", "d2"}], ")"}]}], ",", 
        RowBox[{"kpz2", " ", 
         RowBox[{"(", 
          RowBox[{"P2z", "-", "l2"}], ")"}]}]}], "}"}]}], " ", "-", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"kdx2", " ", "P2xd"}], ",", 
       RowBox[{"kdz2", " ", "P2zd"}]}], "}"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"U1cl", "[", 
  RowBox[{
   RowBox[{"g", "[", "qeq", "]"}], ",", 
   RowBox[{
    RowBox[{"Dg", "[", "qeq", "]"}], ".", "qdeq"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"U2cl", "[", 
  RowBox[{
   RowBox[{"g", "[", "qeq", "]"}], ",", 
   RowBox[{
    RowBox[{"Dg", "[", "qeq", "]"}], ".", "qdeq"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7081820496338253`*^9, 3.708182051364481*^9}, {
   3.711083303769495*^9, 3.711083303786563*^9}, {3.711083342187722*^9, 
   3.711083342192993*^9}, {3.711087092568275*^9, 3.711087114347608*^9}, 
   3.711087216304159*^9, 3.711087292625989*^9, {3.711087467656968*^9, 
   3.711087484194909*^9}, {3.7110875180428457`*^9, 3.71108751830215*^9}, {
   3.711090262484215*^9, 3.711090269648041*^9}, {3.712226124094798*^9, 
   3.712226137573113*^9}, {3.712402223365464*^9, 3.7124022675055313`*^9}, {
   3.712402322538835*^9, 3.7124023309752502`*^9}, {3.712461656380745*^9, 
   3.7124616819022284`*^9}, {3.7140450098289003`*^9, 3.714045016492078*^9}, 
   3.714058060103343*^9, {3.714058192017964*^9, 3.714058194926188*^9}},
 ExpressionUUID -> "fac01159-26fb-41b3-b529-333758df6f90"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.711087519069071*^9, 3.711087585589242*^9, 3.711088498911677*^9, 
   3.71108884503539*^9, 3.711089171857459*^9, 3.711090270352056*^9, 
   3.7110935106619043`*^9, 3.7110945965018387`*^9, 3.7111004076327143`*^9, 
   3.711196465079879*^9, 3.7122213368652*^9, 3.712226138642612*^9, 
   3.712227682660049*^9, 3.7123997345756683`*^9, 3.712402244496759*^9, 
   3.7124022901083803`*^9, 3.7124023490227613`*^9, 3.7124026374097967`*^9, 
   3.712402804268724*^9, 3.71241508184944*^9, 3.712415288744331*^9, 
   3.712415420970478*^9, 3.712415644171373*^9, 3.712415889136387*^9, 
   3.712415982341086*^9, 3.712416261223613*^9, 3.712416736778081*^9, 
   3.712417309669093*^9, 3.7124234790785217`*^9, 3.712459184503002*^9, 
   3.7124604904387903`*^9, 3.712461719755196*^9, 3.712806597052246*^9, 
   3.712821393959959*^9, 3.7136342962177057`*^9, 3.7136352320587263`*^9, 
   3.713635374890746*^9, 3.713635449466049*^9, 3.7136362764335003`*^9, 
   3.7136366497766457`*^9, 3.714055805271522*^9, {3.714058186361701*^9, 
   3.714058195494377*^9}, 3.71406438300249*^9},
 ExpressionUUID -> "9e2354ab-b8db-4a85-a913-b57bac9ff3e8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.711087519069071*^9, 3.711087585589242*^9, 3.711088498911677*^9, 
   3.71108884503539*^9, 3.711089171857459*^9, 3.711090270352056*^9, 
   3.7110935106619043`*^9, 3.7110945965018387`*^9, 3.7111004076327143`*^9, 
   3.711196465079879*^9, 3.7122213368652*^9, 3.712226138642612*^9, 
   3.712227682660049*^9, 3.7123997345756683`*^9, 3.712402244496759*^9, 
   3.7124022901083803`*^9, 3.7124023490227613`*^9, 3.7124026374097967`*^9, 
   3.712402804268724*^9, 3.71241508184944*^9, 3.712415288744331*^9, 
   3.712415420970478*^9, 3.712415644171373*^9, 3.712415889136387*^9, 
   3.712415982341086*^9, 3.712416261223613*^9, 3.712416736778081*^9, 
   3.712417309669093*^9, 3.7124234790785217`*^9, 3.712459184503002*^9, 
   3.7124604904387903`*^9, 3.712461719755196*^9, 3.712806597052246*^9, 
   3.712821393959959*^9, 3.7136342962177057`*^9, 3.7136352320587263`*^9, 
   3.713635374890746*^9, 3.713635449466049*^9, 3.7136362764335003`*^9, 
   3.7136366497766457`*^9, 3.714055805271522*^9, {3.714058186361701*^9, 
   3.714058195494377*^9}, 3.714064383016601*^9},
 ExpressionUUID -> "9e2354ab-b8db-4a85-a913-b57bac9ff3e8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["combine all control laws: Don\[CloseCurlyQuote]t forget the equilibrium \
input", "Chapter",
 CellChangeTimes->{{3.708182124094872*^9, 3.7081821596668453`*^9}, {
   3.708182487068285*^9, 3.70818249057577*^9}, {3.708182529210463*^9, 
   3.7081825387056293`*^9}, 3.714055833174608*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"recall", " ", "input"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"uu", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"control", " ", "law", " ", "for", " ", "each", " ", 
     RowBox[{"input", ":", " ", 
      RowBox[{"as", " ", "function", " ", "of", " ", "q", " ", "and", " ", 
       OverscriptBox["q", "."]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uucl", "[", 
     RowBox[{"q_", ",", "qd_"}], "]"}], ":=", 
    RowBox[{"ueq", "+", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"U1cl", "[", 
        RowBox[{
         RowBox[{"g", "[", "q", "]"}], ",", 
         RowBox[{
          RowBox[{"Dg", "[", "q", "]"}], ".", "qd"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"U2cl", "[", 
        RowBox[{
         RowBox[{"g", "[", "q", "]"}], ",", 
         RowBox[{
          RowBox[{"Dg", "[", "q", "]"}], ".", "qd"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.7081821697789927`*^9, 3.7081821723454723`*^9}, {
  3.7081822526260777`*^9, 3.70818228207806*^9}, {3.708182377301983*^9, 
  3.7081824101722937`*^9}, {3.7081835400972643`*^9, 3.7081835835560207`*^9}, {
  3.708183635596067*^9, 3.708183682316533*^9}, {3.708183718286434*^9, 
  3.708183733417137*^9}, {3.711087167930683*^9, 3.711087170901867*^9}, {
  3.7110872309072523`*^9, 3.7110872459498034`*^9}, {3.711088477428088*^9, 
  3.7110884778879642`*^9}, {3.711090340750986*^9, 3.7110903422780237`*^9}},
 ExpressionUUID -> "cc494775-1f34-43f9-aa55-515653883adb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"U1x", ",", "U1y", ",", "U2x", ",", "U2y"}], "}"}]], "Output",
 CellChangeTimes->{
  3.708182466984248*^9, 3.7081834519915447`*^9, {3.7081835500577507`*^9, 
   3.708183584208784*^9}, {3.708183684332692*^9, 3.708183693441111*^9}, 
   3.708183737127442*^9, 3.708184836884509*^9, 3.708184902922738*^9, 
   3.70818495602444*^9, {3.711081467066073*^9, 3.7110814765605593`*^9}, 
   3.7110815955290422`*^9, 3.7110823913989*^9, 3.711083464309478*^9, 
   3.711084408913787*^9, {3.71108452599544*^9, 3.711084536732602*^9}, 
   3.711085579176152*^9, 3.711086966558526*^9, {3.711087159655169*^9, 
   3.7110871715902147`*^9}, {3.711087205445136*^9, 3.7110872270368967`*^9}, 
   3.7110875328663883`*^9, 3.711087788855068*^9, 3.711090291143914*^9, 
   3.711090342782229*^9, 3.711093512996928*^9, 3.711094596649478*^9, 
   3.7111004076974792`*^9, 3.7111964650870037`*^9, 3.71222133694337*^9, 
   3.7122261463587513`*^9, 3.712227682750999*^9, 3.712399734649929*^9, 
   3.712402358254924*^9, 3.712402637496561*^9, 3.712402804431946*^9, 
   3.71241508190009*^9, 3.712415288791602*^9, 3.712415421051298*^9, 
   3.712415644216351*^9, 3.712415889213385*^9, 3.712415982500458*^9, 
   3.7124162613082647`*^9, 3.712416736798107*^9, 3.7124173097031107`*^9, 
   3.712423479198472*^9, 3.712459184591259*^9, 3.712460490447637*^9, 
   3.7124617198029423`*^9, 3.712806597197638*^9, 3.712821394069763*^9, 
   3.713634296316702*^9, 3.7136352321590242`*^9, 3.713635374977051*^9, 
   3.713635449554175*^9, 3.7136362765888853`*^9, 3.713636649893751*^9, 
   3.714055835029245*^9, 3.714058198821203*^9, 3.714064383091362*^9},
 ExpressionUUID -> "4a51f650-5c06-4f31-ac3c-dc4f5cb99104"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
compose function that maps input to linear/angular accelerations of q, with \
proposed control laws\
\>", "Chapter",
 CellChangeTimes->{{3.708182124094872*^9, 3.7081821596668453`*^9}, 
   3.711088517393121*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FUState", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"px_", ",", "pz_", ",", "\[Alpha]bar_", ",", "\[Alpha]C1_"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "pxd_", ",", "pzd_", ",", "\[Alpha]bard_", ",", "\[Alpha]C1d_"}], 
      "}"}]}], "]"}], "=", 
   RowBox[{"FU", "[", 
    RowBox[{"q", ",", 
     RowBox[{"uucl", "[", 
      RowBox[{"q", ",", "qd"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.70818236581586*^9, 3.7081823686731577`*^9}, {
   3.708182418454298*^9, 3.70818242625992*^9}, 3.708182524956933*^9, 
   3.708183745013349*^9, {3.7110900157784452`*^9, 3.7110900315373287`*^9}, {
   3.7140444436299553`*^9, 3.7140444436337223`*^9}},
 ExpressionUUID -> "93c5a0e0-2f57-4b61-8694-aed6ceb1136d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["check equilibrium is still equilibrium!", "Chapter",
 CellChangeTimes->{{3.708182545781909*^9, 3.7081825559502363`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GMatrix", "[", "qeq", "]"}], "-", 
   RowBox[{"FUState", "[", 
    RowBox[{"qeq", ",", "qdeq"}], "]"}]}], "//", "Simplify"}]], "Input",
 ExpressionUUID -> "7d49a0a2-3d7f-4546-9b02-101752e682e8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.708182419439815*^9, 3.708182459327886*^9}, 
   3.7081834522219*^9, 3.708183747280048*^9, 3.708184837021894*^9, 
   3.7081849030394583`*^9, 3.708184956208845*^9, {3.711081470804797*^9, 
   3.711081478510476*^9}, 3.711081605986294*^9, 3.7110823962643833`*^9, 
   3.7110834676433163`*^9, 3.7110844114123163`*^9, {3.711084526103644*^9, 
   3.711084536817964*^9}, 3.711085579298325*^9, 3.7110869722983418`*^9, 
   3.7110871749195757`*^9, 3.711087208238171*^9, 3.711087262967269*^9, 
   3.711087537382152*^9, 3.711087792463641*^9, 3.711088506818138*^9, 
   3.7110885774604177`*^9, 3.7110891969815273`*^9, 3.711090346705798*^9, 
   3.7110935150517693`*^9, 3.711094597035582*^9, 3.711100407813685*^9, 
   3.711196465281292*^9, 3.712221337038701*^9, 3.712226149622566*^9, 
   3.712227682855217*^9, 3.712399734788454*^9, 3.712402363278891*^9, 
   3.712402637672188*^9, 3.712402804602162*^9, 3.712415081953402*^9, 
   3.712415288847867*^9, 3.712415421187035*^9, 3.7124156443609133`*^9, 
   3.71241588934556*^9, 3.712415982949788*^9, 3.712416261446143*^9, 
   3.712416736880383*^9, 3.712417309736677*^9, 3.712423479280671*^9, 
   3.7124591847383432`*^9, 3.712460490505742*^9, 3.712461719897553*^9, 
   3.712806597547411*^9, 3.7128213942022877`*^9, 3.71363429642869*^9, 
   3.7136352322771273`*^9, 3.713635375079199*^9, 3.713635449671544*^9, 
   3.713636276873466*^9, 3.713636650022892*^9, 3.714058203896831*^9, 
   3.714064383201438*^9},
 ExpressionUUID -> "e71d9683-23ee-4256-a038-03eb2868f0d2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Find A matrix of closed loop", "Chapter",
 CellChangeTimes->{{3.7081825919386806`*^9, 3.708182599408729*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AMatrix", "=", 
   RowBox[{"LagrangeLinearizationClosedLoop", "[", 
    RowBox[{
    "qeq", ",", "g", ",", "Potential", ",", "Kinectic", ",", "FUState"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"AMatrix", "//", "MatrixForm"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.70806690602981*^9, 3.708067137519293*^9}, 
   3.70806716823663*^9, {3.708067343481702*^9, 3.708067369864313*^9}, {
   3.708067405944409*^9, 3.708067479463253*^9}, {3.708067584088011*^9, 
   3.7080676056603327`*^9}, {3.70806764592771*^9, 3.70806769869061*^9}, {
   3.7080677483418503`*^9, 3.708067962566708*^9}, {3.70810080097167*^9, 
   3.708100842810926*^9}, 3.708100916994722*^9, {3.708101090871266*^9, 
   3.708101161330327*^9}, {3.7081368521598454`*^9, 3.7081368994090347`*^9}, {
   3.708137128767048*^9, 3.708137320915947*^9}, {3.708138685170187*^9, 
   3.708138802811664*^9}, {3.7081396456930723`*^9, 3.70813964600933*^9}, {
   3.708182574326517*^9, 3.708182616754509*^9}, {3.70818265533571*^9, 
   3.708182711715873*^9}, 3.7081829418049717`*^9, {3.7081830601761923`*^9, 
   3.7081830903641663`*^9}, {3.7081833263709173`*^9, 3.708183394278305*^9}, {
   3.708183756683989*^9, 3.708183788737091*^9}, {3.7122024612695*^9, 
   3.7122024613437853`*^9}, 3.712202781411571*^9, {3.712202815640732*^9, 
   3.712202823598898*^9}, 3.712202884239641*^9, {3.71220295764498*^9, 
   3.7122030487407923`*^9}, {3.712203087121792*^9, 3.712203087267913*^9}, 
   3.712255758385713*^9, {3.7122562582596903`*^9, 3.7122562616033363`*^9}, {
   3.714058210428135*^9, 3.7140582177236547`*^9}},
 ExpressionUUID -> "20f9c02a-f665-46bc-84fe-7ffdbb395f4f"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Routh\[CloseCurlyQuote]s criterion", "Title",
 CellChangeTimes->{3.7140438716267977`*^9}],

Cell[CellGroupData[{

Cell["Controllable canonical form", "Chapter",
 CellChangeTimes->{{3.7120541198105907`*^9, 3.71205412486038*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"addrow", "[", "a_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"UnitVector", "[", 
       RowBox[{
        RowBox[{"Length", "[", "a", "]"}], ",", 
        RowBox[{
         RowBox[{"Length", "[", "a", "]"}], "+", "1", "-", 
         RowBox[{
          RowBox[{"Dimensions", "[", "#", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], "}"}], ",", "#"}], "]"}],
    "&"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC", "[", "a_", "]"}], ":=", 
  RowBox[{"Nest", "[", 
   RowBox[{
    RowBox[{"addrow", "[", "a", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"-", "a"}], "}"}], ",", 
    RowBox[{
     RowBox[{"Length", "[", "a", "]"}], "-", "1"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC", "[", 
   RowBox[{"{", 
    RowBox[{"a0", ",", "a1", ",", "a2"}], "}"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC", "[", 
   RowBox[{"{", 
    RowBox[{"a0", ",", "a1", ",", "a2", ",", "a3"}], "}"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC", "[", 
   RowBox[{"{", 
    RowBox[{"a0", ",", "a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}], "]"}], 
  "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7120552813651543`*^9, 3.712055332502823*^9}, {
  3.712055374880151*^9, 3.7120554005155563`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0"},
     {"0", "0", "1"},
     {
      RowBox[{"-", "a0"}], 
      RowBox[{"-", "a1"}], 
      RowBox[{"-", "a2"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.71205530000025*^9, 3.712055333328465*^9}, {
   3.712055390029583*^9, 3.712055400759265*^9}, 3.71205573325695*^9, 
   3.7121542746987667`*^9, 3.712156632599451*^9, 3.712161859194921*^9, 
   3.712165302505271*^9, 3.7123963734878473`*^9, 3.713020734005403*^9, 
   3.714055969645577*^9, 3.7140582235356493`*^9, 3.714064383336546*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"},
     {
      RowBox[{"-", "a0"}], 
      RowBox[{"-", "a1"}], 
      RowBox[{"-", "a2"}], 
      RowBox[{"-", "a3"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.71205530000025*^9, 3.712055333328465*^9}, {
   3.712055390029583*^9, 3.712055400759265*^9}, 3.71205573325695*^9, 
   3.7121542746987667`*^9, 3.712156632599451*^9, 3.712161859194921*^9, 
   3.712165302505271*^9, 3.7123963734878473`*^9, 3.713020734005403*^9, 
   3.714055969645577*^9, 3.7140582235356493`*^9, 3.714064383356217*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0"},
     {"0", "0", "1", "0", "0"},
     {"0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "1"},
     {
      RowBox[{"-", "a0"}], 
      RowBox[{"-", "a1"}], 
      RowBox[{"-", "a2"}], 
      RowBox[{"-", "a3"}], 
      RowBox[{"-", "a4"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.71205530000025*^9, 3.712055333328465*^9}, {
   3.712055390029583*^9, 3.712055400759265*^9}, 3.71205573325695*^9, 
   3.7121542746987667`*^9, 3.712156632599451*^9, 3.712161859194921*^9, 
   3.712165302505271*^9, 3.7123963734878473`*^9, 3.713020734005403*^9, 
   3.714055969645577*^9, 3.7140582235356493`*^9, 3.714064383369083*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Hurwitz conditions", "Chapter",
 CellChangeTimes->{{3.7120554792779493`*^9, 3.712055483753387*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NotebookEvaluate", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<hurwitz_conditions.nb\>\""}], "}"}], "]"}], "]"}], ";"}]], "Input",\

 CellChangeTimes->{{3.71005535745792*^9, 3.710055358482471*^9}, {
   3.710055419189004*^9, 3.710055459554541*^9}, {3.7100555370149403`*^9, 
   3.710055548671946*^9}, 3.710055638835634*^9, 3.710057803745392*^9, {
   3.7100599861952877`*^9, 3.710059990024391*^9}, 3.7101574160581427`*^9, {
   3.710157992771703*^9, 3.710157993807963*^9}, {3.712055524490918*^9, 
   3.712055546142333*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[CapitalGamma]4 (all terms need to be positive)", "Chapter",
 CellChangeTimes->{{3.7120554182278137`*^9, 3.712055419427719*^9}, {
  3.712055595766025*^9, 3.712055596366538*^9}, {3.712055718178494*^9, 
  3.712055718429797*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalGamma]\[CapitalGamma]4", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fp", " ", "kp"}], ",", 
     RowBox[{"fp", "  ", "kv"}], ",", 
     RowBox[{"kp", "+", 
      RowBox[{"fp", 
       RowBox[{"(", " ", 
        RowBox[{"1", "+", "pp"}], ")"}]}]}], ",", "kv"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC", "[", "\[CapitalGamma]\[CapitalGamma]4", "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Step4", "[", 
   RowBox[{"CC", "[", "\[CapitalGamma]\[CapitalGamma]4", "]"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7120554261282387`*^9, 3.7120554724783382`*^9}, {
  3.712055569984881*^9, 3.712055660316914*^9}, {3.7123963787706137`*^9, 
  3.71239639648423*^9}, {3.712397311433783*^9, 3.712397328106955*^9}, {
  3.712397601258409*^9, 3.712397603489622*^9}, {3.713020723047752*^9, 
  3.7130207267376213`*^9}, {3.714055986337946*^9, 3.7140560169101763`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"},
     {
      RowBox[{
       RowBox[{"-", "fp"}], " ", "kp"}], 
      RowBox[{
       RowBox[{"-", "fp"}], " ", "kv"}], 
      RowBox[{
       RowBox[{"-", "kp"}], "-", 
       RowBox[{"fp", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "pp"}], ")"}]}]}], 
      RowBox[{"-", "kv"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.712055660818775*^9, 3.712055735445222*^9, 3.71215428081413*^9, 
   3.712156636053732*^9, 3.7121618613672247`*^9, 3.712165305600306*^9, {
   3.712396375421197*^9, 3.7123964007573843`*^9}, 3.712397329015139*^9, 
   3.7123976093705893`*^9, 3.713020736246664*^9, {3.714056004189702*^9, 
   3.714056017343246*^9}, 3.714058227170265*^9, 3.71406438540898*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"1"},
      {"kv"},
      {
       RowBox[{"kv", " ", 
        RowBox[{"(", 
         RowBox[{"kp", "+", 
          RowBox[{"fp", " ", "pp"}]}], ")"}]}]},
      {
       RowBox[{
        SuperscriptBox["fp", "2"], " ", 
        SuperscriptBox["kv", "2"], " ", "pp"}]},
      {
       RowBox[{"fp", " ", "kp"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.712055660818775*^9, 3.712055735445222*^9, 3.71215428081413*^9, 
   3.712156636053732*^9, 3.7121618613672247`*^9, 3.712165305600306*^9, {
   3.712396375421197*^9, 3.7123964007573843`*^9}, 3.712397329015139*^9, 
   3.7123976093705893`*^9, 3.713020736246664*^9, {3.714056004189702*^9, 
   3.714056017343246*^9}, 3.714058227170265*^9, 3.714064385429055*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Crane system", "Title",
 CellChangeTimes->{{3.714043875169298*^9, 3.714043879175914*^9}}],

Cell["check notebook crane_system.nb", "Chapter",
 CellChangeTimes->{{3.714056081909184*^9, 3.714056100131195*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Locked manipulator", "Title",
 CellChangeTimes->{3.714043892672473*^9}],

Cell[CellGroupData[{

Cell["\<\
special point: jerk does not depend on gains (jerk of other points do)\
\>", "Chapter",
 CellChangeTimes->{{3.712408836072962*^9, 3.7124088578216343`*^9}, {
  3.712409622752447*^9, 3.712409633418105*^9}, {3.712723110611459*^9, 
  3.712723110617111*^9}, {3.712723142110758*^9, 3.712723142116228*^9}, {
  3.71405632634144*^9, 3.714056333959029*^9}, {3.714056502213894*^9, 
  3.714056507964816*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"e", "[", "i_", "]"}], ":=", 
  RowBox[{"UnitVector", "[", 
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"Length", "[", "qt", "]"}]}], ",", "i"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], "+", 
           RowBox[{"\[CapitalGamma]1", " ", 
            RowBox[{"e", "[", "3", "]"}]}]}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{"AMatrix", ".", "AMatrix", ".", "AMatrix"}], ")"}]}], "/.", 
        
        RowBox[{"{", 
         RowBox[{
          RowBox[{"kpx2", "\[Rule]", " ", "0"}], ",", " ", 
          RowBox[{"kdx2", "\[Rule]", " ", "0"}]}], "}"}]}], ")"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
    "\[CapitalGamma]1"}], "]"}], "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], "+", 
           RowBox[{"\[CapitalGamma]1", " ", 
            RowBox[{"e", "[", "3", "]"}]}]}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{"AMatrix", ".", "AMatrix", ".", "AMatrix"}], ")"}]}], "/.", 
        
        RowBox[{"{", 
         RowBox[{
          RowBox[{"kpx2", "\[Rule]", " ", "0"}], ",", " ", 
          RowBox[{"kdx2", "\[Rule]", " ", "0"}]}], "}"}]}], ")"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], ",", 
    "\[CapitalGamma]1"}], "]"}], "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], "+", 
           RowBox[{"\[CapitalGamma]1", " ", 
            RowBox[{"e", "[", "3", "]"}]}]}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{"AMatrix", ".", "AMatrix", ".", "AMatrix"}], ")"}]}], "/.", 
        
        RowBox[{"{", 
         RowBox[{
          RowBox[{"kpx2", "\[Rule]", " ", "0"}], ",", " ", 
          RowBox[{"kdx2", "\[Rule]", " ", "0"}]}], "}"}]}], ")"}], "[", 
      RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], ",", 
    "\[CapitalGamma]1"}], "]"}], "//", "Simplify"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[CapitalGamma]1", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"l2", " ", "M2"}], "+", 
       RowBox[{"lm", " ", "MM"}]}], 
      RowBox[{"m", "+", "M2", "+", "MM"}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.7140583536070967`*^9, 3.714064386489153*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[CapitalGamma]1", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"l2", " ", "M2"}], "+", 
       RowBox[{"lm", " ", "MM"}]}], 
      RowBox[{"m", "+", "M2", "+", "MM"}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.7140583536070967`*^9, 3.714064389435075*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[CapitalGamma]1", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"l2", " ", "M2"}], "+", 
       RowBox[{"lm", " ", "MM"}]}], 
      RowBox[{"m", "+", "M2", "+", "MM"}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.7140583536070967`*^9, 3.714064389795273*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["chain of four integrators: jerk does not depend on \
gains (jerk of other points do)", "Chapter"]], "Chapter",
 CellChangeTimes->{{3.712459200528317*^9, 3.71245921198088*^9}, {
  3.71405837194748*^9, 3.714058372297235*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"e", "[", "i_", "]"}], ":=", 
   RowBox[{"UnitVector", "[", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"Length", "[", "qt", "]"}]}], ",", "i"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"e", "[", "1", "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"e", "[", "4", "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"e", "[", "5", "]"}], "}"}]}], "]"}], ".", "AMatrix", ".", 
       "AMatrix", ".", "AMatrix"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"MM", "\[Rule]", " ", "0"}], ",", 
        RowBox[{"JM", "\[Rule]", " ", "0"}], ",", 
        RowBox[{"k\[Tau]2p", "\[Rule]", " ", "0"}], ",", 
        RowBox[{"k\[Tau]2d", "\[Rule]", " ", "0"}]}], "}"}]}], "//", 
     "Simplify"}], "//", "MatrixForm"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ps", " ", "=", " ", 
   RowBox[{
    RowBox[{"e", "[", "1", "]"}], "-", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"l2", " ", "M2"}], "+", 
       RowBox[{"lm", " ", "MM"}]}], 
      RowBox[{"m", "+", "M2", "+", "MM"}]], 
     RowBox[{"e", "[", "3", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ps", ".", "AMatrix", ".", "AMatrix", ".", "AMatrix"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"kpx2", "\[Rule]", " ", "0"}], ",", " ", 
      RowBox[{"kdx2", "\[Rule]", " ", "0"}]}], "}"}]}], "//", "Simplify"}], "//",
   "Simplify"}]}], "Input",
 CellChangeTimes->{
  3.7124592632956133`*^9, {3.713635641310994*^9, 3.7136356677876253`*^9}, 
   3.7140580602227592`*^9, 3.7140583604493923`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   FractionBox[
    RowBox[{"gravity", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "d1"}], " ", "M1"}], "+", 
       RowBox[{"d2", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"d1", "-", "d2"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.712402840165358*^9, 3.712415085766474*^9, 3.712415292591827*^9, 
   3.712415425216256*^9, 3.7124156482849197`*^9, 3.712415893525754*^9, 
   3.7124159870460443`*^9, 3.7124162654565573`*^9, 3.7124167441755257`*^9, 
   3.71241731353209*^9, 3.712423483245164*^9, 3.7124591886695557`*^9, 
   3.712459263745698*^9, 3.7124604926951103`*^9, 3.712461723471465*^9, 
   3.7128066039118767`*^9, 3.7128214009815817`*^9, {3.713635637940481*^9, 
   3.713635654079975*^9}, 3.713636656359008*^9, {3.714058362468145*^9, 
   3.714058379385667*^9}, 3.714064390690021*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["two chains of two integrators", "Chapter",
 CellChangeTimes->{{3.7124592508565617`*^9, 3.712459278182395*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", "[", "2", "]"}], ")"}], ".", "AMatrix"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"kpx2", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"kdx2", "\[Rule]", " ", "0"}]}], "}"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", "[", "3", "]"}], ")"}], ".", "AMatrix"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"kpx2", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"kdx2", "\[Rule]", " ", "0"}]}], "}"}]}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.7124592197732897`*^9, 3.712459260018585*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.71245923178008*^9, 3.712459260351851*^9}, 
   3.7124604930328283`*^9, 3.712461724598605*^9, 3.712806605070017*^9, 
   3.71282140206793*^9, 3.7136366574164467`*^9, 3.7140583889323063`*^9, 
   3.714064390760889*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.71245923178008*^9, 3.712459260351851*^9}, 
   3.7124604930328283`*^9, 3.712461724598605*^9, 3.712806605070017*^9, 
   3.71282140206793*^9, 3.7136366574164467`*^9, 3.7140583889323063`*^9, 
   3.714064390772923*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Similarity matrix", "Chapter",
 CellChangeTimes->{{3.7140584223550663`*^9, 3.714058427496435*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], 
         RowBox[{"e", "[", "2", "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "M1"}], "+", 
           RowBox[{"d2", " ", "M2"}], "+", 
           RowBox[{"d2", " ", "MM"}]}], ")"}], " ", 
         RowBox[{"e", "[", "3", "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], 
           RowBox[{"e", "[", "2", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d1", " ", "M1"}], "+", 
             RowBox[{"d2", " ", "M2"}], "+", 
             RowBox[{"d2", " ", "MM"}]}], ")"}], " ", 
           RowBox[{"e", "[", "3", "]"}]}]}], ")"}], ".", "AMatrix"}], ",", 
       RowBox[{"(*", 
        RowBox[{"y", " ", "bar", " ", "linear", " ", "motion"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ".", "AMatrix"}], ",", 
       RowBox[{"(*", 
        RowBox[{"bar", " ", "angular", " ", "motion"}], "*)"}], 
       "\[IndentingNewLine]", "ps", ",", 
       RowBox[{"ps", ".", "AMatrix"}], ",", 
       RowBox[{"ps", ".", "AMatrix", ".", "AMatrix"}], ",", 
       RowBox[{"ps", ".", "AMatrix", ".", "AMatrix", ".", "AMatrix"}]}], 
      RowBox[{"(*", 
       RowBox[{"x", " ", "bar", " ", "linear", " ", "motion"}], "*)"}], 
      "\[IndentingNewLine]", "}"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"kpx2", "\[Rule]", " ", "0"}], ",", 
       RowBox[{"kdx2", "\[Rule]", "0"}]}], "}"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"P", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.711092453916059*^9, 3.7110924571454153`*^9}, {
  3.712402902444599*^9, 3.712402911251636*^9}, {3.712807018053228*^9, 
  3.712807051404173*^9}, {3.712807343359084*^9, 3.71280736461865*^9}, {
  3.712808456519232*^9, 3.7128084801506042`*^9}, {3.712808520195406*^9, 
  3.712808522624433*^9}, {3.712809247746314*^9, 3.7128092620981693`*^9}, {
  3.714058060404537*^9, 3.7140580604231462`*^9}, {3.71405841976725*^9, 
  3.714058451095043*^9}},
 ExpressionUUID -> "5b4dca48-e8b4-4a0a-a24b-59ecd2f8b0ff"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], 
      RowBox[{
       RowBox[{"d1", " ", "M1"}], "+", 
       RowBox[{"d2", " ", 
        RowBox[{"(", 
         RowBox[{"M2", "+", "MM"}], ")"}]}]}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], 
      RowBox[{
       RowBox[{"d1", " ", "M1"}], "+", 
       RowBox[{"d2", " ", 
        RowBox[{"(", 
         RowBox[{"M2", "+", "MM"}], ")"}]}]}], "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"1", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"l2", " ", "M2"}], "+", 
         RowBox[{"lm", " ", "MM"}]}], 
        RowBox[{"m", "+", "M2", "+", "MM"}]]}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"l2", " ", "M2"}], "+", 
         RowBox[{"lm", " ", "MM"}]}], 
        RowBox[{"m", "+", "M2", "+", "MM"}]]}], "0"},
     {"0", "0", "0", 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "M1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "M1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.714058451952209*^9, 3.7140643910946407`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Similar state matrix", "Chapter",
 CellChangeTimes->{{3.71405845520332*^9, 3.7140584602323227`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AT", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"P", ".", "AMatrix", ".", 
      RowBox[{"Inverse", "[", "P", "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"kpx2", "\[Rule]", " ", "0"}], ",", 
       RowBox[{"kdx2", "\[Rule]", "0"}]}], "}"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AT", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.711092381388533*^9, 3.711092475019307*^9}, 
   3.71109361073739*^9, {3.714058461611519*^9, 3.7140584617737083`*^9}},
 ExpressionUUID -> "f7a9fa4f-097a-4de9-82c9-8c56df217bf3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"kpz1", " ", "M1"}], "+", 
         RowBox[{"kpz2", " ", "M2"}]}], 
        RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"kdz1", " ", "M1"}], "+", 
         RowBox[{"kdz2", " ", "M2"}]}], 
        RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpz2"}], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1"}], ")"}], " ", "M2"}], "+", 
           RowBox[{"kpz1", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], "-", 
        RowBox[{"d1", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpz2"}], " ", "M2"}], "+", 
           RowBox[{"kpz1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kdz2"}], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1"}], ")"}], " ", "M2"}], "+", 
           RowBox[{"kdz1", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], "-", 
        RowBox[{"d1", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kdz2"}], " ", "M2"}], "+", 
           RowBox[{"kdz1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}]], "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "kpz2"}], " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M1"}], ")"}], " ", "M2"}], "+", 
             RowBox[{"kpz1", " ", "M1", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"d1", " ", "M1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "kpz2"}], " ", "M2"}], "+", 
             RowBox[{"kpz1", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d1", " ", "M1"}], "+", 
              RowBox[{"d2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"l2", " ", "M2"}], "+", 
                 RowBox[{"lm", " ", "MM"}]}], ")"}], "2"]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"Jbar", "+", "JM", "+", 
                RowBox[{
                 SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}]}], ")"}]}],
           "-", 
          RowBox[{"M1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"Jbar", "+", "JM", "+", 
                RowBox[{
                 SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"d1", " ", "M1"}], "+", 
                RowBox[{"d2", " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
            ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "kdz2"}], " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M1"}], ")"}], " ", "M2"}], "+", 
             RowBox[{"kdz1", " ", "M1", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"d1", " ", "M1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "kdz2"}], " ", "M2"}], "+", 
             RowBox[{"kdz1", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d1", " ", "M1"}], "+", 
              RowBox[{"d2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"l2", " ", "M2"}], "+", 
                 RowBox[{"lm", " ", "MM"}]}], ")"}], "2"]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"Jbar", "+", "JM", "+", 
                RowBox[{
                 SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}]}], ")"}]}],
           "-", 
          RowBox[{"M1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"Jbar", "+", "JM", "+", 
                RowBox[{
                 SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"d1", " ", "M1"}], "+", 
                RowBox[{"d2", " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
            ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}]}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d1", " ", "kpz1", " ", "M1"}], "+", 
             RowBox[{"d2", " ", "kpz2", " ", "M2"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d1", " ", "M1"}], "+", 
             RowBox[{"d2", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["d1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"d1", "-", "d2"}], ")"}], " ", "kpz1", " ", "M1"}], 
             "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"d1", "-", "d2"}], ")"}], " ", 
              SuperscriptBox["d2", "2"], " ", "kpz2", " ", "M2"}], "-", 
             RowBox[{"gravity", " ", "l2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"d2", " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}], "-", 
                RowBox[{"d1", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
            ")"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d1", " ", "M1"}], "+", 
             RowBox[{"d2", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"kpz2", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "M1"}], ")"}], " ", "M2"}], "-", 
                RowBox[{"kpz1", " ", "M1", " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
             RowBox[{"d1", " ", "M1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "kpz2"}], " ", "M2"}], "+", 
                RowBox[{"kpz1", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
            ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d1", " ", "M1"}], "+", 
              RowBox[{"d2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"l2", " ", "M2"}], "+", 
                 RowBox[{"lm", " ", "MM"}]}], ")"}], "2"]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"Jbar", "+", "JM", "+", 
                RowBox[{
                 SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}]}], ")"}]}],
           "+", 
          RowBox[{"M1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"Jbar", "+", "JM", "+", 
                RowBox[{
                 SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"d1", " ", "M1"}], "+", 
                RowBox[{"d2", " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
            ")"}]}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kdz2", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"m", "+", "M1"}], ")"}], "2"], " ", "M2"}], "+", 
              RowBox[{"kdz1", " ", "M1", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"M2", "+", "MM"}], ")"}], "2"]}]}], ")"}]}], "-", 
           RowBox[{"2", " ", "d1", " ", "d2", " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kdz2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M1"}], ")"}], " ", "M2"}], "+", 
              RowBox[{"kdz1", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
           
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kdz2", " ", "M1", " ", "M2"}], "+", 
              RowBox[{"kdz1", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], "2"]}]}], 
             ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d1", "2"], " ", 
            SuperscriptBox["m", "2"], " ", "M1"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            SuperscriptBox["m", "2"], " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", 
            SuperscriptBox["m", "2"], " ", "M2"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d1", "2"], " ", "m", " ", "M1", " ", "M2"}], "-", 
           
           RowBox[{
           "2", " ", "d1", " ", "d2", " ", "m", " ", "M1", " ", "M2"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "m", " ", "M1", " ", "M2"}], "+", 
           
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "m", " ", "M1", " ", "M2"}], "+", 
           
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "m", " ", 
            SuperscriptBox["M2", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "m", " ", 
            SuperscriptBox["M2", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1", " ", 
            SuperscriptBox["M2", "2"]}], "-", 
           RowBox[{"2", " ", "d1", " ", "d2", " ", "M1", " ", 
            SuperscriptBox["M2", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "M1", " ", 
            SuperscriptBox["M2", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            SuperscriptBox["m", "2"], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            SuperscriptBox["m", "2"], " ", "MM"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d1", "2"], " ", "m", " ", "M1", " ", "MM"}], "-", 
           
           RowBox[{
           "2", " ", "d1", " ", "d2", " ", "m", " ", "M1", " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "m", " ", "M1", " ", "MM"}], "+", 
           
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "m", " ", "M1", " ", "MM"}], "+", 
           
           RowBox[{"2", " ", 
            SuperscriptBox["d2", "2"], " ", "m", " ", "M2", " ", "MM"}], "+", 
           
           RowBox[{"2", " ", 
            SuperscriptBox["l2", "2"], " ", "m", " ", "M2", " ", "MM"}], "-", 
           
           RowBox[{
           "2", " ", "l2", " ", "lm", " ", "m", " ", "M2", " ", "MM"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["lm", "2"], " ", "m", " ", "M2", " ", "MM"}], "+", 
           
           RowBox[{"2", " ", 
            SuperscriptBox["d1", "2"], " ", "M1", " ", "M2", " ", "MM"}], "-", 
           RowBox[{
           "4", " ", "d1", " ", "d2", " ", "M1", " ", "M2", " ", "MM"}], "+", 
           
           RowBox[{"2", " ", 
            SuperscriptBox["d2", "2"], " ", "M1", " ", "M2", " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M1", " ", "M2", " ", "MM"}], "-", 
           RowBox[{
           "2", " ", "l2", " ", "lm", " ", "M1", " ", "M2", " ", "MM"}], "+", 
           
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "M1", " ", "M2", " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", 
            SuperscriptBox["M2", "2"], " ", "MM"}], "-", 
           RowBox[{"2", " ", "l2", " ", "lm", " ", 
            SuperscriptBox["M2", "2"], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", 
            SuperscriptBox["M2", "2"], " ", "MM"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "m", " ", 
            SuperscriptBox["MM", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "m", " ", 
            SuperscriptBox["MM", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "M1", " ", 
            SuperscriptBox["MM", "2"]}], "-", 
           RowBox[{"2", " ", "d1", " ", "d2", " ", "M1", " ", 
            SuperscriptBox["MM", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "M1", " ", 
            SuperscriptBox["MM", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "M2", " ", 
            SuperscriptBox["MM", "2"]}], "-", 
           RowBox[{"2", " ", "l2", " ", "lm", " ", "M2", " ", 
            SuperscriptBox["MM", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["lm", "2"], " ", "M2", " ", 
            SuperscriptBox["MM", "2"]}], "+", 
           RowBox[{"Jbar", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
           RowBox[{"JM", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
          ")"}]}]]}], "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l2", " ", "M2"}], "+", 
          RowBox[{"lm", " ", "MM"}]}], ")"}]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["d1", "2"], " ", 
         SuperscriptBox["m", "2"], " ", "M1"}], "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         SuperscriptBox["m", "2"], " ", "M2"}], "+", 
        RowBox[{
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["m", "2"], " ", "M2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d1", "2"], " ", "m", " ", "M1", " ", "M2"}], "-", 
        RowBox[{"2", " ", "d1", " ", "d2", " ", "m", " ", "M1", " ", "M2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "m", " ", "M1", " ", "M2"}], "+", 
        RowBox[{
         SuperscriptBox["l2", "2"], " ", "m", " ", "M1", " ", "M2"}], "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "m", " ", 
         SuperscriptBox["M2", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["l2", "2"], " ", "m", " ", 
         SuperscriptBox["M2", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "M1", " ", 
         SuperscriptBox["M2", "2"]}], "-", 
        RowBox[{"2", " ", "d1", " ", "d2", " ", "M1", " ", 
         SuperscriptBox["M2", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "M1", " ", 
         SuperscriptBox["M2", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         SuperscriptBox["m", "2"], " ", "MM"}], "+", 
        RowBox[{
         SuperscriptBox["lm", "2"], " ", 
         SuperscriptBox["m", "2"], " ", "MM"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d1", "2"], " ", "m", " ", "M1", " ", "MM"}], "-", 
        RowBox[{"2", " ", "d1", " ", "d2", " ", "m", " ", "M1", " ", "MM"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "m", " ", "M1", " ", "MM"}], "+", 
        RowBox[{
         SuperscriptBox["lm", "2"], " ", "m", " ", "M1", " ", "MM"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d2", "2"], " ", "m", " ", "M2", " ", "MM"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["l2", "2"], " ", "m", " ", "M2", " ", "MM"}], "-", 
        RowBox[{"2", " ", "l2", " ", "lm", " ", "m", " ", "M2", " ", "MM"}], 
        "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["lm", "2"], " ", "m", " ", "M2", " ", "MM"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d1", "2"], " ", "M1", " ", "M2", " ", "MM"}], "-", 
        RowBox[{"4", " ", "d1", " ", "d2", " ", "M1", " ", "M2", " ", "MM"}], 
        "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d2", "2"], " ", "M1", " ", "M2", " ", "MM"}], "+", 
        RowBox[{
         SuperscriptBox["l2", "2"], " ", "M1", " ", "M2", " ", "MM"}], "-", 
        RowBox[{"2", " ", "l2", " ", "lm", " ", "M1", " ", "M2", " ", "MM"}], 
        "+", 
        RowBox[{
         SuperscriptBox["lm", "2"], " ", "M1", " ", "M2", " ", "MM"}], "+", 
        RowBox[{
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["M2", "2"], " ", "MM"}], "-", 
        RowBox[{"2", " ", "l2", " ", "lm", " ", 
         SuperscriptBox["M2", "2"], " ", "MM"}], "+", 
        RowBox[{
         SuperscriptBox["lm", "2"], " ", 
         SuperscriptBox["M2", "2"], " ", "MM"}], "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "m", " ", 
         SuperscriptBox["MM", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["lm", "2"], " ", "m", " ", 
         SuperscriptBox["MM", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "M1", " ", 
         SuperscriptBox["MM", "2"]}], "-", 
        RowBox[{"2", " ", "d1", " ", "d2", " ", "M1", " ", 
         SuperscriptBox["MM", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "M1", " ", 
         SuperscriptBox["MM", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["l2", "2"], " ", "M2", " ", 
         SuperscriptBox["MM", "2"]}], "-", 
        RowBox[{"2", " ", "l2", " ", "lm", " ", "M2", " ", 
         SuperscriptBox["MM", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["lm", "2"], " ", "M2", " ", 
         SuperscriptBox["MM", "2"]}], "+", 
        RowBox[{"Jbar", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{"JM", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]], "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"},
     {
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "M1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "l2"}], " ", "M2"}], "-", 
          RowBox[{"lm", " ", "MM"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"kpz2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M1"}], ")"}], " ", "M2"}], "-", 
             RowBox[{"kpz1", " ", "M1", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"d1", " ", "M1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "kpz2"}], " ", "M2"}], "+", 
             RowBox[{"kpz1", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "l1", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d1", " ", "M1"}], "+", 
              RowBox[{"d2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"l2", " ", "M2"}], "+", 
                 RowBox[{"lm", " ", "MM"}]}], ")"}], "2"]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"Jbar", "+", "JM", "+", 
                RowBox[{
                 SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}]}], ")"}]}],
           "-", 
          RowBox[{"M1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"Jbar", "+", "JM", "+", 
                RowBox[{
                 SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"d1", " ", "M1"}], "+", 
                RowBox[{"d2", " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
            ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "M1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "l2"}], " ", "M2"}], "-", 
          RowBox[{"lm", " ", "MM"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"kdz2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M1"}], ")"}], " ", "M2"}], "-", 
             RowBox[{"kdz1", " ", "M1", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"d1", " ", "M1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "kdz2"}], " ", "M2"}], "+", 
             RowBox[{"kdz1", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "l1", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d1", " ", "M1"}], "+", 
              RowBox[{"d2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"l2", " ", "M2"}], "+", 
                 RowBox[{"lm", " ", "MM"}]}], ")"}], "2"]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"Jbar", "+", "JM", "+", 
                RowBox[{
                 SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}]}], ")"}]}],
           "-", 
          RowBox[{"M1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"Jbar", "+", "JM", "+", 
                RowBox[{
                 SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"d1", " ", "M1"}], "+", 
                RowBox[{"d2", " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
            ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "M1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l2", " ", "M2"}], "+", 
          RowBox[{"lm", " ", "MM"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}]}], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d1", " ", "M1"}], "+", 
             RowBox[{"d2", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"kpz2", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "M1"}], ")"}], " ", "M2"}], "-", 
                RowBox[{"kpz1", " ", "M1", " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
             RowBox[{"d1", " ", "M1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "kpz2"}], " ", "M2"}], "+", 
                RowBox[{"kpz1", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
            ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"kpx1", " ", "M1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
                 
                 RowBox[{"(", 
                  RowBox[{"Jbar", "+", "JM", "+", 
                   RowBox[{
                    SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                   RowBox[{
                    SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                   RowBox[{
                    SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                   RowBox[{
                    SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                   RowBox[{
                    SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "-", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"d1", " ", "M1"}], "+", 
                   RowBox[{"d2", " ", 
                    RowBox[{"(", 
                    RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
               ")"}]}], "+", 
             RowBox[{"kpx1", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"l2", " ", "M2"}], "+", 
                   RowBox[{"lm", " ", "MM"}]}], ")"}], "2"], "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
                 
                 RowBox[{"(", 
                  RowBox[{"Jbar", "+", "JM", "+", 
                   RowBox[{
                    SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                   RowBox[{
                    SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                   RowBox[{
                    SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                   RowBox[{
                    SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                   RowBox[{
                    SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"d1", " ", "M1"}], "+", 
                   RowBox[{"d2", " ", 
                    RowBox[{"(", 
                    RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
               ")"}]}]}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"d1", "-", "d2"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"d1", " ", "kpz1", " ", "M1"}], "+", 
                RowBox[{"d2", " ", "kpz2", " ", "M2"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"d1", " ", "M1"}], "+", 
                RowBox[{"d2", " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["d1", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{"d1", "-", "d2"}], ")"}], " ", "kpz1", " ", "M1"}], 
                "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                 SuperscriptBox["d2", "2"], " ", "kpz2", " ", "M2"}], "-", 
                RowBox[{"gravity", " ", "l2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"d2", " ", 
                    RowBox[{"(", 
                    RowBox[{"M2", "+", "MM"}], ")"}]}], "-", 
                   RowBox[{"d1", " ", 
                    RowBox[{"(", 
                    RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}],
                ")"}]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "l1", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d1", " ", "M1"}], "+", 
              RowBox[{"d2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"l2", " ", "M2"}], "+", 
                 RowBox[{"lm", " ", "MM"}]}], ")"}], "2"]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"Jbar", "+", "JM", "+", 
                RowBox[{
                 SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}]}], ")"}]}],
           "+", 
          RowBox[{"M1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"Jbar", "+", "JM", "+", 
                RowBox[{
                 SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"d1", " ", "M1"}], "+", 
                RowBox[{"d2", " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
            ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "M1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l2", " ", "M2"}], "+", 
          RowBox[{"lm", " ", "MM"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["d2", "2"], " ", "kdz2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M1"}], ")"}], " ", "M2"}], "+", 
             RowBox[{
              SuperscriptBox["d1", "2"], " ", "kdz1", " ", "M1", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], "-", 
             RowBox[{"d1", " ", "d2", " ", "M1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"kdz2", " ", "M2"}], "+", 
                RowBox[{"kdz1", " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
          "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d1", " ", "M1"}], "+", 
             RowBox[{"d2", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"kdz2", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "M1"}], ")"}], " ", "M2"}], "-", 
                RowBox[{"kdz1", " ", "M1", " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
             RowBox[{"d1", " ", "M1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "kdz2"}], " ", "M2"}], "+", 
                RowBox[{"kdz1", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
            ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"kdx1", " ", "M1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
                 
                 RowBox[{"(", 
                  RowBox[{"Jbar", "+", "JM", "+", 
                   RowBox[{
                    SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                   RowBox[{
                    SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                   RowBox[{
                    SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                   RowBox[{
                    SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                   RowBox[{
                    SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "-", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"d1", " ", "M1"}], "+", 
                   RowBox[{"d2", " ", 
                    RowBox[{"(", 
                    RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
               ")"}]}], "+", 
             RowBox[{"kdx1", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"l2", " ", "M2"}], "+", 
                   RowBox[{"lm", " ", "MM"}]}], ")"}], "2"], "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
                 
                 RowBox[{"(", 
                  RowBox[{"Jbar", "+", "JM", "+", 
                   RowBox[{
                    SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                   RowBox[{
                    SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                   RowBox[{
                    SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                   RowBox[{
                    SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                   RowBox[{
                    SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"d1", " ", "M1"}], "+", 
                   RowBox[{"d2", " ", 
                    RowBox[{"(", 
                    RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
               ")"}]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "l1", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d1", " ", "M1"}], "+", 
              RowBox[{"d2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"l2", " ", "M2"}], "+", 
                 RowBox[{"lm", " ", "MM"}]}], ")"}], "2"]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"Jbar", "+", "JM", "+", 
                RowBox[{
                 SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}]}], ")"}]}],
           "+", 
          RowBox[{"M1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"Jbar", "+", "JM", "+", 
                RowBox[{
                 SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"d1", " ", "M1"}], "+", 
                RowBox[{"d2", " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
            ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{"gravity", " ", "kpx1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "M1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "l1", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]], 
      FractionBox[
       RowBox[{"gravity", " ", "kdx1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "M1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "l1", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"kpx1", " ", 
         SuperscriptBox["M1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"Jbar", "+", "JM", "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
              RowBox[{
               SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d1", " ", "M1"}], "+", 
              RowBox[{"d2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], ")"}]}], 
        "+", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "kpx1"}], " ", "l1", " ", "M1"}], "+", 
            FractionBox[
             RowBox[{"gravity", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "d1"}], " ", "M1"}], "+", 
                RowBox[{"d2", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}]}], 
             RowBox[{"d1", "-", "d2"}]]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"l2", " ", "M2"}], "+", 
                RowBox[{"lm", " ", "MM"}]}], ")"}], "2"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"Jbar", "+", "JM", "+", 
               RowBox[{
                SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
               RowBox[{
                SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
               RowBox[{
                SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
               RowBox[{
                SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
               RowBox[{
                SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d1", " ", "M1"}], "+", 
               RowBox[{"d2", " ", 
                RowBox[{"(", 
                 RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], ")"}]}],
          "l1"]}], 
       RowBox[{"M1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d1", " ", "M1"}], "+", 
              RowBox[{"d2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"l2", " ", "M2"}], "+", 
                 RowBox[{"lm", " ", "MM"}]}], ")"}], "2"]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"Jbar", "+", "JM", "+", 
                RowBox[{
                 SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}]}], ")"}]}],
           "-", 
          RowBox[{"M1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"Jbar", "+", "JM", "+", 
                RowBox[{
                 SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"d1", " ", "M1"}], "+", 
                RowBox[{"d2", " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
            ")"}]}]}], ")"}]}]], 
      RowBox[{"-", "kdx1"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.71405847212365*^9, 3.714064400576501*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Notice that", "Chapter",
 CellChangeTimes->{{3.714058474362159*^9, 3.714058476411914*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{"AT", "[", 
     RowBox[{"[", 
      RowBox[{"8", ",", "1"}], "]"}], "]"}], 
    RowBox[{"AT", "[", 
     RowBox[{"[", 
      RowBox[{"4", ",", "1"}], "]"}], "]"}]], "-", 
   FractionBox[
    RowBox[{"AT", "[", 
     RowBox[{"[", 
      RowBox[{"8", ",", "2"}], "]"}], "]"}], 
    RowBox[{"AT", "[", 
     RowBox[{"[", 
      RowBox[{"4", ",", "2"}], "]"}], "]"}]]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.712808840681676*^9, 3.712808876614402*^9}, {
  3.712808950681013*^9, 3.7128089861498213`*^9}, {3.712809023885312*^9, 
  3.7128090498461657`*^9}, {3.714058486838615*^9, 3.714058491744051*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.714058477543796*^9, 3.71405850183827*^9}, 
   3.714064400928563*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{"AT", "[", 
     RowBox[{"[", 
      RowBox[{"4", ",", "1"}], "]"}], "]"}], 
    RowBox[{"AT", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "3"}], "]"}], "]"}]], "-", 
   FractionBox[
    RowBox[{"AT", "[", 
     RowBox[{"[", 
      RowBox[{"4", ",", "2"}], "]"}], "]"}], 
    RowBox[{"AT", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "4"}], "]"}], "]"}]]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.712809054042574*^9, 3.712809089420821*^9}, {
  3.7128091550828323`*^9, 3.712809203824706*^9}, {3.714058495018427*^9, 
  3.714058499789811*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.7140584839402523`*^9, 3.714058500374351*^9}, 
   3.71406440102763*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Block diagonalize matrix", "Chapter"]], "Chapter",
 CellChangeTimes->{{3.708183848244521*^9, 3.708183909441573*^9}, {
  3.7140585253237658`*^9, 3.7140585294172297`*^9}}],

Cell[CellGroupData[{

Cell["\<\
next two options are equal (just different ways of writting same thing)\
\>", "Subchapter",
 CellChangeTimes->{{3.71405854992558*^9, 3.714058571934432*^9}}],

Cell[CellGroupData[{

Cell["option 1& 2", "Section",
 CellChangeTimes->{{3.712403267557762*^9, 3.712403275666408*^9}, {
  3.7140585619368887`*^9, 3.714058587765327*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"solgains1", " ", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"AT", "[", 
          RowBox[{"[", 
           RowBox[{"8", ",", 
            RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], ",", 
         RowBox[{"AT", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", 
            RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], "]"}], "\[Equal]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"kpx1", ",", "kdx1", ",", "kpz1", ",", "kdz1"}], "}"}]}], 
     "]"}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"solgains1", " ", "=", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"AT", "[", 
         RowBox[{"[", 
          RowBox[{"8", ",", 
           RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "\[Equal]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"kpx1", ",", "kdx1", ",", "kpz1", ",", "kdz1"}], "}"}]}], 
      "]"}], "//", "Simplify"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.711092600680889*^9, 3.711092669983736*^9}, {
   3.712402974850842*^9, 3.7124029801871767`*^9}, {3.712403020392795*^9, 
   3.712403053920061*^9}, {3.712403170431275*^9, 3.712403178090456*^9}, {
   3.7124032489517803`*^9, 3.71240328146611*^9}, {3.7124033322905416`*^9, 
   3.712403342214211*^9}, {3.7124616567632427`*^9, 3.712461675947692*^9}, 
   3.714058579288706*^9},
 ExpressionUUID -> "31d4af61-7d55-44a0-9f88-6c3b0ff0ca8f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"solgains2", " ", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"AT", "[", 
          RowBox[{"[", 
           RowBox[{"8", ",", 
            RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], ",", 
         RowBox[{"AT", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", 
            RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], "]"}], "\[Equal]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"kpz2", ",", "kdz2", ",", "kpz1", ",", "kdz1"}], "}"}]}], 
     "]"}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"solgains2", " ", "=", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"AT", "[", 
         RowBox[{"[", 
          RowBox[{"8", ",", 
           RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "\[Equal]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"kpz2", ",", "kdz2", ",", "kpz1", ",", "kdz1"}], "}"}]}], 
      "]"}], "//", "Simplify"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.712403299754994*^9, 3.712403349074543*^9}, {
  3.7124616568012857`*^9, 3.712461682017887*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"kpx1", ",", "kdx1"}], "}"}], "/.", 
     RowBox[{"solgains1", " ", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/.", 
   RowBox[{"solgains2", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"kpz2", ",", "kdz2"}], "}"}], "/.", 
     RowBox[{"solgains2", " ", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/.", 
   RowBox[{"solgains1", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.712403483779976*^9, 3.712403496738796*^9}, {
  3.712403707782015*^9, 3.712403709102442*^9}, {3.712460589894558*^9, 
  3.712460619913555*^9}, {3.71246108629987*^9, 3.712461143685495*^9}, {
  3.7124616637911577`*^9, 3.712461682020904*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"kpx1", ",", "kdx1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.712403497156307*^9, 3.7124037096880007`*^9, 3.7124150947127247`*^9, 
   3.712415300208152*^9, 3.71241543305614*^9, 3.712415656142797*^9, 
   3.7124159016716137`*^9, 3.712415995737486*^9, 3.712416273903007*^9, 
   3.712416755930023*^9, 3.712417321090506*^9, 3.712423490779283*^9, 
   3.712460499684772*^9, 3.712460623263878*^9, {3.7124610909984083`*^9, 
   3.712461143936425*^9}, 3.712461733049465*^9, 3.712810533990368*^9, 
   3.712821422069257*^9, 3.714058590880982*^9, 3.714064407323889*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"kpz2", ",", "kdz2"}], "}"}]], "Output",
 CellChangeTimes->{
  3.712403497156307*^9, 3.7124037096880007`*^9, 3.7124150947127247`*^9, 
   3.712415300208152*^9, 3.71241543305614*^9, 3.712415656142797*^9, 
   3.7124159016716137`*^9, 3.712415995737486*^9, 3.712416273903007*^9, 
   3.712416755930023*^9, 3.712417321090506*^9, 3.712423490779283*^9, 
   3.712460499684772*^9, 3.712460623263878*^9, {3.7124610909984083`*^9, 
   3.712461143936425*^9}, 3.712461733049465*^9, 3.712810533990368*^9, 
   3.712821422069257*^9, 3.714058590880982*^9, 3.714064409706215*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"kpz1", ",", "kdz1"}], "}"}], "/.", 
        RowBox[{"solgains1", " ", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"kpz1", ",", "kdz1"}], "}"}], "/.", 
        RowBox[{"solgains2", " ", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ")"}], ")"}], "/.", 
   RowBox[{"solgains1", " ", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"kpz1", ",", "kdz1"}], "}"}], "/.", 
        RowBox[{"solgains1", " ", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"kpz1", ",", "kdz1"}], "}"}], "/.", 
        RowBox[{"solgains2", " ", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ")"}], ")"}], "/.", 
   RowBox[{"solgains2", " ", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.712460823841754*^9, 3.71246095482064*^9}, {
  3.712461656810259*^9, 3.712461675961154*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.712460842511112*^9, 3.712460857681858*^9}, {
   3.712460928988352*^9, 3.7124609552952843`*^9}, 3.712461735530281*^9, 
   3.7128214265901823`*^9, 3.714058596437607*^9, 3.714064410497315*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.712460842511112*^9, 3.712460857681858*^9}, {
   3.712460928988352*^9, 3.7124609552952843`*^9}, 3.712461735530281*^9, 
   3.7128214265901823`*^9, 3.714058596437607*^9, 3.714064410587659*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"solgains1", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
       RowBox[{"d2", "\[Rule]", " ", 
        RowBox[{"-", "d"}]}], ",", 
       RowBox[{"l22", "\[Rule]", " ", "0"}]}], "}"}]}], "//", 
    RowBox[{"Simplify", "\[IndentingNewLine]", 
     FractionBox[
      RowBox[{
       RowBox[{"CoefficientList", "[", 
        RowBox[{
         RowBox[{"kpx1", "/.", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"solgains1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
              RowBox[{"d2", "\[Rule]", " ", 
               RowBox[{"-", "d"}]}], ",", 
              RowBox[{"l22", "\[Rule]", " ", "0"}]}], "}"}]}], ")"}]}], ",", 
         "kpz2"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], 
      RowBox[{
       RowBox[{"CoefficientList", "[", 
        RowBox[{
         RowBox[{"kdx1", "/.", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"solgains1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
              RowBox[{"d2", "\[Rule]", " ", 
               RowBox[{"-", "d"}]}], ",", 
              RowBox[{"l22", "\[Rule]", " ", "0"}]}], "}"}]}], ")"}]}], ",", 
         "kdz2"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]]}]}], "//", "Simplify"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.712808715421389*^9, 3.712808726831966*^9}, {
   3.712810040608267*^9, 3.712810074718039*^9}, {3.712810221607155*^9, 
   3.712810270007497*^9}, 3.714058605939549*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["State matrix is block triangular with gains choices above", "Chapter",
 CellChangeTimes->{{3.711093797067411*^9, 3.71109380483971*^9}, {
  3.71405880213153*^9, 3.71405881413144*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AT2", "=", 
   RowBox[{"AT", "//.", 
    RowBox[{"solgains1", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AT2", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "4"}], ",", 
      RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "//", "Simplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AT2", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"1", ";;", "4"}], ",", 
       RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d1", "\[Rule]", "d"}], ",", 
      RowBox[{"d2", "\[Rule]", 
       RowBox[{"-", "d"}]}], ",", 
      RowBox[{"JM", "\[Rule]", " ", "0"}], ",", 
      RowBox[{"MM", "\[Rule]", " ", "0"}], ",", 
      RowBox[{"lm", "\[Rule]", "l2"}]}], "}"}]}], "//", "Simplify"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.711092704614421*^9, 3.71109272072858*^9}, 
   3.711092925911827*^9, {3.711092983598159*^9, 3.711093024684071*^9}, {
   3.7124033516721*^9, 3.712403395021504*^9}, {3.712403696115838*^9, 
   3.712403717858178*^9}, {3.714058713033332*^9, 3.714058716597356*^9}},
 ExpressionUUID -> "57d8413d-543b-440b-8571-f870bff89342"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "kpz2", " ", "M2"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d2"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "kdz2", " ", "M2"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d2"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], "0", "0"},
     {"0", "0", "0", "1"},
     {"0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["d1", "3"], " ", "kpz2", " ", "M1", " ", "M2"}], 
          "-", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "d2", " ", "kpz2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"3", " ", "M1"}]}], ")"}], " ", "M2"}], "-", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["d2", "2"], " ", "kpz2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M1"}], ")"}], " ", "M2"}], "+", 
             RowBox[{"gravity", " ", "l2", " ", 
              RowBox[{"(", 
               RowBox[{"M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
            ")"}]}], "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["d2", "2"], " ", "kpz2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "m"}], "+", 
                RowBox[{"3", " ", "M1"}]}], ")"}], " ", "M2"}], "+", 
             RowBox[{"gravity", " ", "l2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
            ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d1", " ", "M1"}], "+", 
              RowBox[{"d2", " ", 
               RowBox[{"(", 
                RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"l2", " ", "M2"}], "+", 
                 RowBox[{"lm", " ", "MM"}]}], ")"}], "2"]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"Jbar", "+", "JM", "+", 
                RowBox[{
                 SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}]}], ")"}]}],
           "+", 
          RowBox[{"M1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"Jbar", "+", "JM", "+", 
                RowBox[{
                 SuperscriptBox["d1", "2"], " ", "M1"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["l2", "2"], " ", "M2"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "MM"}], "+", 
                RowBox[{
                 SuperscriptBox["lm", "2"], " ", "MM"}]}], ")"}]}], "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"d1", " ", "M1"}], "+", 
                RowBox[{"d2", " ", 
                 RowBox[{"(", 
                  RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}], "2"]}], 
            ")"}]}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "kdz2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "M1"}], "-", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1"}], ")"}]}]}], ")"}], " ", "M2", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["d1", "2"], " ", 
          SuperscriptBox["m", "2"], " ", "M1"}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          SuperscriptBox["m", "2"], " ", "M2"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", 
          SuperscriptBox["m", "2"], " ", "M2"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d1", "2"], " ", "m", " ", "M1", " ", "M2"}], "-", 
         RowBox[{"2", " ", "d1", " ", "d2", " ", "m", " ", "M1", " ", "M2"}], 
         "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", "m", " ", "M1", " ", "M2"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "m", " ", "M1", " ", "M2"}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", "m", " ", 
          SuperscriptBox["M2", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "m", " ", 
          SuperscriptBox["M2", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          SuperscriptBox["M2", "2"]}], "-", 
         RowBox[{"2", " ", "d1", " ", "d2", " ", "M1", " ", 
          SuperscriptBox["M2", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", "M1", " ", 
          SuperscriptBox["M2", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          SuperscriptBox["m", "2"], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          SuperscriptBox["m", "2"], " ", "MM"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d1", "2"], " ", "m", " ", "M1", " ", "MM"}], "-", 
         RowBox[{"2", " ", "d1", " ", "d2", " ", "m", " ", "M1", " ", "MM"}], 
         "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", "m", " ", "M1", " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", "m", " ", "M1", " ", "MM"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d2", "2"], " ", "m", " ", "M2", " ", "MM"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["l2", "2"], " ", "m", " ", "M2", " ", "MM"}], "-", 
         RowBox[{"2", " ", "l2", " ", "lm", " ", "m", " ", "M2", " ", "MM"}], 
         "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["lm", "2"], " ", "m", " ", "M2", " ", "MM"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d1", "2"], " ", "M1", " ", "M2", " ", "MM"}], "-", 
         RowBox[{"4", " ", "d1", " ", "d2", " ", "M1", " ", "M2", " ", "MM"}],
          "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d2", "2"], " ", "M1", " ", "M2", " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M1", " ", "M2", " ", "MM"}], "-", 
         RowBox[{"2", " ", "l2", " ", "lm", " ", "M1", " ", "M2", " ", "MM"}],
          "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", "M1", " ", "M2", " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", 
          SuperscriptBox["M2", "2"], " ", "MM"}], "-", 
         RowBox[{"2", " ", "l2", " ", "lm", " ", 
          SuperscriptBox["M2", "2"], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", 
          SuperscriptBox["M2", "2"], " ", "MM"}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", "m", " ", 
          SuperscriptBox["MM", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", "m", " ", 
          SuperscriptBox["MM", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "M1", " ", 
          SuperscriptBox["MM", "2"]}], "-", 
         RowBox[{"2", " ", "d1", " ", "d2", " ", "M1", " ", 
          SuperscriptBox["MM", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", "M1", " ", 
          SuperscriptBox["MM", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "M2", " ", 
          SuperscriptBox["MM", "2"]}], "-", 
         RowBox[{"2", " ", "l2", " ", "lm", " ", "M2", " ", 
          SuperscriptBox["MM", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["lm", "2"], " ", "M2", " ", 
          SuperscriptBox["MM", "2"]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
         RowBox[{"JM", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.71405865085424*^9, 3.714058718115931*^9, 
  3.714058815133705*^9, 3.714064411075201*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpz2", " ", "M2"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M2"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kdz2", " ", "M2"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M2"}]}]]}], "0", "0"},
     {"0", "0", "0", "1"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "+", "M2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["d", "2"], " ", "kpz2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M1"}]}], ")"}], " ", "M2"}], "+", 
           RowBox[{"gravity", " ", "l2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M2"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "m", " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2"}], ")"}]}], "+", 
           RowBox[{"Jbar", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", "M1", " ", "M2"}], "+", 
              RowBox[{"m", " ", 
               RowBox[{"(", 
                RowBox[{"M1", "+", "M2"}], ")"}]}]}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kdz2", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M1"}]}], ")"}], " ", "M2", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2"}], ")"}]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["l2", "2"], " ", "m", " ", "M2", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2"}], ")"}]}], "+", 
         RowBox[{"Jbar", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M2"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "M1", " ", "M2"}], "+", 
            RowBox[{"m", " ", 
             RowBox[{"(", 
              RowBox[{"M1", "+", "M2"}], ")"}]}]}], ")"}]}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.71405865085424*^9, 3.714058718115931*^9, 
  3.714058815133705*^9, 3.71406441117773*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AT2", "=", 
   RowBox[{"AT", "//.", 
    RowBox[{"solgains2", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AT2", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"5", ";;", "8"}], ",", 
       RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "//", "Simplify"}], "//", 
   "MatrixForm"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"AT2", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"5", ";;", "8"}], ",", 
        RowBox[{"5", ";;", "8"}]}], "]"}], "]"}], "//", "Simplify"}], "//", 
    "MatrixForm"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AT2", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"5", ";;", "8"}], ",", 
       RowBox[{"5", ";;", "8"}]}], "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d1", "\[Rule]", "d"}], ",", 
      RowBox[{"d2", "\[Rule]", 
       RowBox[{"-", "d"}]}], ",", 
      RowBox[{"JM", "\[Rule]", " ", "0"}], ",", 
      RowBox[{"MM", "\[Rule]", " ", "0"}], ",", 
      RowBox[{"lm", "\[Rule]", " ", "l2"}]}], "}"}]}], "//", "FullSimplify"}],
   "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.712403402610168*^9, 3.712403432143606*^9}, {
  3.71240374263778*^9, 3.712403753557674*^9}, {3.714058710583449*^9, 
  3.714058723433157*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7124034204238853`*^9, 3.712403432530768*^9}, 
   3.712403748087463*^9, 3.712415096605384*^9, 3.7124153017449007`*^9, 
   3.71241543467395*^9, 3.712415657856638*^9, 3.712415903386964*^9, 
   3.712415998014513*^9, 3.7124162757317543`*^9, 3.712416757421887*^9, 
   3.7124173226964693`*^9, 3.712423492351527*^9, 3.712461737087393*^9, 
   3.712821442845173*^9, 3.714058668753397*^9, 3.714058724073873*^9, 
   3.714058816863221*^9, 3.714064411953391*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpx1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M1"}]}], ")"}]}], 
        RowBox[{"2", " ", "l1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2"}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kdx1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M1"}]}], ")"}]}], 
        RowBox[{"2", " ", "l1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2"}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["d", "3"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "M1", " ", "M2"}], "+", 
            RowBox[{"m", " ", 
             RowBox[{"(", 
              RowBox[{"M1", "+", "M2"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "kpx1", " ", "l1", " ", "M1", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M2"}], ")"}]}], "+", 
            RowBox[{"gravity", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", 
               RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "M1", "+", "M2"}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M1", "+", "M2"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "kpx1", " ", "l1", " ", "M1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["l2", "2"], " ", "m", " ", "M2"}], "+", 
               RowBox[{"Jbar", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "M2"}], ")"}]}]}], ")"}]}], "+", 
            RowBox[{"gravity", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", 
               RowBox[{"2", " ", "M1"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["l2", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "M1"}], ")"}], " ", "M2"}], "+", 
               RowBox[{"Jbar", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "M1", "+", "M2"}], ")"}]}]}], ")"}]}]}], 
           ")"}]}]}], 
        RowBox[{"2", " ", "d", " ", "l1", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["l2", "2"], " ", "m", " ", "M2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2"}], ")"}]}], "+", 
           RowBox[{"Jbar", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1", "+", "M2"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", "M1", " ", "M2"}], "+", 
              RowBox[{"m", " ", 
               RowBox[{"(", 
                RowBox[{"M1", "+", "M2"}], ")"}]}]}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", "kdx1"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7124034204238853`*^9, 3.712403432530768*^9}, 
   3.712403748087463*^9, 3.712415096605384*^9, 3.7124153017449007`*^9, 
   3.71241543467395*^9, 3.712415657856638*^9, 3.712415903386964*^9, 
   3.712415998014513*^9, 3.7124162757317543`*^9, 3.712416757421887*^9, 
   3.7124173226964693`*^9, 3.712423492351527*^9, 3.712461737087393*^9, 
   3.712821442845173*^9, 3.714058668753397*^9, 3.714058724073873*^9, 
   3.714058816863221*^9, 3.714064413693965*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Az and A\[Theta] matrices", "Chapter",
 CellChangeTimes->{{3.714057398938271*^9, 3.714057410842629*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"AT", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "4"}], ",", 
        RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"1", ";;", "2"}], ",", 
       RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "//.", 
    RowBox[{"solgains1", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "//", "Simplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"AT", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "4"}], ",", 
        RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"3", ";;", "4"}], ",", 
       RowBox[{"3", ";;", "4"}]}], "]"}], "]"}], "//.", 
    RowBox[{"solgains2", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "//", "Simplify"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.714057417087318*^9, 3.714057446592498*^9}, {
  3.714058823618952*^9, 3.714058862007636*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1"},
     {
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "kpz2", " ", "M2"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d2"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "kdz2", " ", "M2"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d2"}], " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.714057437003685*^9, 3.714057447149685*^9}, 
   3.7140578334297256`*^9, 3.714058826736278*^9, 3.714058862507416*^9, 
   3.714064413973361*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1"},
     {
      RowBox[{"-", "kpx1"}], 
      RowBox[{"-", "kdx1"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.714057437003685*^9, 3.714057447149685*^9}, 
   3.7140578334297256`*^9, 3.714058826736278*^9, 3.714058862507416*^9, 
   3.714064414421678*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ap matrix", "Chapter",
 CellChangeTimes->{{3.712409741633215*^9, 3.712409751009466*^9}, {
  3.712410162335513*^9, 3.712410163746204*^9}, {3.714057323943025*^9, 
  3.714057358306263*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"structure", " ", "to", " ", "polynomial", " ", "coefficients"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[CapitalGamma]4", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p1_", ",", "p2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kp_", ",", "kv_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"-", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"gL", " ", 
        RowBox[{"(", 
         RowBox[{"kp", "+", 
          RowBox[{"gL", " ", "p1"}]}], ")"}]}], ",", " ", 
       RowBox[{"gL", "  ", "kv"}], " ", ",", " ", 
       RowBox[{"kp", "+", 
        RowBox[{"gL", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "p1", "+", "p2"}], ")"}]}]}], ",", "kv"}], 
      "}"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalGamma]4", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fp_", ",", "p_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kp_", ",", "kv_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"-", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"fp", " ", "kp"}], ",", " ", 
       RowBox[{"fp", "  ", "kv"}], " ", ",", " ", 
       RowBox[{"kp", "+", 
        RowBox[{"fp", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "p"}], ")"}]}]}], ",", "kv"}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AofInterest", "=", 
     RowBox[{
      RowBox[{"AT2", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"5", ";;", "8"}], ",", 
         RowBox[{"5", ";;", "8"}]}], "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "4"}], ",", 
        RowBox[{"1", ";;", "4"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solps", "=", 
     RowBox[{
      RowBox[{"Solve", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"AofInterest", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "-", 
            RowBox[{"\[CapitalGamma]4", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"fp", ",", "pp"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"kpx1", ",", "kdx1"}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"AofInterest", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "-", 
              RowBox[{"\[CapitalGamma]4", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"fp", ",", "pp"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"kpx1", ",", "kdx1"}], "}"}]}], "]"}]}], ",", 
             "kpx1"}], "]"}]}], "\[IndentingNewLine]", "]"}], "\[Equal]", 
         "\[IndentingNewLine]", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"fp", ",", "pp"}], "}"}]}], "\[IndentingNewLine]", "]"}], "//",
       "Simplify"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.712132547668767*^9, 3.712132594345231*^9}, {
   3.712132635083919*^9, 3.712132663094454*^9}, {3.7121329860431013`*^9, 
   3.712133144012432*^9}, {3.712133352252187*^9, 3.7121333526696377`*^9}, {
   3.7121370163390512`*^9, 3.7121370293859797`*^9}, {3.712137102973229*^9, 
   3.712137103365212*^9}, {3.7121504137162037`*^9, 3.712150446009226*^9}, {
   3.7121505505223017`*^9, 3.7121505533222218`*^9}, {3.712395606466907*^9, 
   3.712395626674182*^9}, {3.712395698220069*^9, 3.712395728302267*^9}, {
   3.712396124465748*^9, 3.7123961263051777`*^9}, {3.712396466379158*^9, 
   3.71239647390554*^9}, {3.7123973902341003`*^9, 3.7123974475880337`*^9}, {
   3.7124096960962048`*^9, 3.712409726042841*^9}, {3.7140570690622377`*^9, 
   3.714057117426083*^9}, {3.714057246270588*^9, 3.71405726575243*^9}, 
   3.714058881835128*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"solps", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", " ", 
      RowBox[{"-", "d"}]}], ",", 
     RowBox[{"lm", "\[Rule]", " ", "l2"}]}], "}"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"solps", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
        RowBox[{"d2", "\[Rule]", " ", 
         RowBox[{"-", "d"}]}], ",", 
        RowBox[{"lm", "\[Rule]", " ", "l2"}], ",", 
        RowBox[{"MM", "\[Rule]", " ", "0"}]}], "}"}]}], "//", 
     RowBox[{
      RowBox[{"FullSimplify", "\[IndentingNewLine]", "solps"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
        RowBox[{"d2", "\[Rule]", " ", 
         RowBox[{"-", "d"}]}], ",", 
        RowBox[{"lm", "\[Rule]", " ", "l2"}], ",", 
        RowBox[{"JM", "\[Rule]", " ", "0"}]}], "}"}]}]}], "//", 
    "FullSimplify"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.712397637918097*^9, 3.7123976591654177`*^9}, {
   3.712409773327779*^9, 3.712409774674542*^9}, 3.712723114921793*^9, 
   3.712723446481591*^9, {3.71272375124551*^9, 3.712723797763619*^9}, {
   3.712766764196806*^9, 3.712766768574154*^9}, {3.7127716155877666`*^9, 
   3.7127716194492807`*^9}, {3.7127716731103153`*^9, 3.71277167326656*^9}, 
   3.714057262803887*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"fp", "\[Rule]", 
     FractionBox[
      RowBox[{"gravity", " ", 
       RowBox[{"(", 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M1"}]}], ")"}]}], 
      RowBox[{"2", " ", "l1", " ", 
       RowBox[{"(", 
        RowBox[{"m", "+", "M2", "+", "MM"}], ")"}]}]]}], ",", 
    RowBox[{"pp", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SuperscriptBox["m", "3"], " ", "M1"}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SuperscriptBox["m", "3"], " ", "M2"}], "+", 
        RowBox[{
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["m", "3"], " ", "M2"}], "+", 
        RowBox[{"6", " ", 
         SuperscriptBox["d", "2"], " ", 
         SuperscriptBox["m", "2"], " ", "M1", " ", "M2"}], "+", 
        RowBox[{
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["m", "2"], " ", "M1", " ", "M2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", 
         SuperscriptBox["m", "2"], " ", 
         SuperscriptBox["M2", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["m", "2"], " ", 
         SuperscriptBox["M2", "2"]}], "+", 
        RowBox[{"9", " ", 
         SuperscriptBox["d", "2"], " ", "m", " ", "M1", " ", 
         SuperscriptBox["M2", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["l2", "2"], " ", "m", " ", "M1", " ", 
         SuperscriptBox["M2", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["M1", "2"], " ", 
         SuperscriptBox["M2", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", "m", " ", 
         SuperscriptBox["M2", "3"]}], "+", 
        RowBox[{
         SuperscriptBox["l2", "2"], " ", "m", " ", 
         SuperscriptBox["M2", "3"]}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["d", "2"], " ", "M1", " ", 
         SuperscriptBox["M2", "3"]}], "+", 
        RowBox[{
         SuperscriptBox["l2", "2"], " ", "M1", " ", 
         SuperscriptBox["M2", "3"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"m", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"6", " ", "M1"}]}], ")"}]}], "+", 
              RowBox[{"3", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"4", " ", "M1"}]}], ")"}], " ", "M2"}]}], ")"}]}], 
           "+", 
           RowBox[{
            SuperscriptBox["l2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["m", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M1"}], ")"}]}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", 
                  SuperscriptBox["m", "2"]}], "+", 
                 RowBox[{"2", " ", "m", " ", "M1"}], "+", 
                 SuperscriptBox["M1", "2"]}], ")"}], " ", "M2"}], "+", 
              RowBox[{"3", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M1"}], ")"}], " ", 
               SuperscriptBox["M2", "2"]}]}], ")"}]}]}], ")"}], " ", "MM"}], 
        "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["l2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               SuperscriptBox["m", "2"]}], "+", 
              RowBox[{"2", " ", "m", " ", "M1"}], "+", 
              SuperscriptBox["M1", "2"], "+", 
              RowBox[{"3", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M1"}], ")"}], " ", "M2"}]}], ")"}]}], "+", 
           
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"m", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "m"}], "+", 
                 RowBox[{"9", " ", "M1"}]}], ")"}]}], "+", 
              RowBox[{"3", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"4", " ", "M1"}]}], ")"}], " ", "M2"}]}], ")"}]}]}], 
          ")"}], " ", 
         SuperscriptBox["MM", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["l2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M1"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"4", " ", "M1"}]}], ")"}]}]}], ")"}], " ", 
         SuperscriptBox["MM", "3"]}], "+", 
        RowBox[{"Jbar", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{"JM", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}], 
      "/", 
      RowBox[{"(", 
       RowBox[{"M1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["d", "2"], " ", 
           SuperscriptBox["m", "2"], " ", "M1"}], "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", 
           SuperscriptBox["m", "2"], " ", "M2"}], "+", 
          RowBox[{
           SuperscriptBox["l2", "2"], " ", 
           SuperscriptBox["m", "2"], " ", "M2"}], "+", 
          RowBox[{"5", " ", 
           SuperscriptBox["d", "2"], " ", "m", " ", "M1", " ", "M2"}], "+", 
          RowBox[{
           SuperscriptBox["l2", "2"], " ", "m", " ", "M1", " ", "M2"}], "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", "m", " ", 
           SuperscriptBox["M2", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["l2", "2"], " ", "m", " ", 
           SuperscriptBox["M2", "2"]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["d", "2"], " ", "M1", " ", 
           SuperscriptBox["M2", "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["l2", "2"], " ", "m", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M1", "+", 
                RowBox[{"2", " ", "M2"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["d", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["m", "2"], "+", 
                RowBox[{"5", " ", "m", " ", "M1"}], "+", 
                RowBox[{"2", " ", "m", " ", "M2"}], "+", 
                RowBox[{"8", " ", "M1", " ", "M2"}]}], ")"}]}]}], ")"}], " ", 
           "MM"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["l2", "2"], " ", "m"}], "+", 
             RowBox[{
              SuperscriptBox["d", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", 
                RowBox[{"4", " ", "M1"}]}], ")"}]}]}], ")"}], " ", 
           SuperscriptBox["MM", "2"]}], "+", 
          RowBox[{"Jbar", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
          RowBox[{"JM", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}]}], 
         ")"}]}], ")"}]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.712723740267791*^9, 3.712723798568553*^9}, 
   3.712766769757365*^9, 3.7127681674199543`*^9, 3.712771620515505*^9, 
   3.712771674285117*^9, 3.712827743747704*^9, 3.713707585672371*^9, 
   3.713707726764867*^9, 3.714057269597063*^9, 3.714057339838776*^9, 
   3.714057841774323*^9, 3.714058901390411*^9, 3.714064420975711*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Stability if p> 0: p is in fact positive (even without simplifications)\
\>", "Chapter",
 CellChangeTimes->{{3.712409889760705*^9, 3.7124099279819527`*^9}, {
  3.714057369538097*^9, 3.714057378820036*^9}, {3.714058952952753*^9, 
  3.71405896478371*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pp", "/.", 
    RowBox[{"solps", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", " ", 
      RowBox[{"-", "d"}]}], ",", 
     RowBox[{"lm", "\[Rule]", " ", "l2"}], ",", 
     RowBox[{"JM", "\[Rule]", " ", "0"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.712399272070196*^9, 3.712399320286549*^9}, 
   3.7124097989166307`*^9, 3.712723114940588*^9, 3.7127234464973392`*^9, {
   3.714057367047379*^9, 3.714057367290146*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"Jbar", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["l2", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"M2", "+", "MM"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["m", "2"], "+", 
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
      RowBox[{"M1", " ", 
       RowBox[{"(", 
        RowBox[{"M2", "+", "MM"}], ")"}]}]}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["d", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", "M1", " ", 
       RowBox[{"(", 
        RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{"M1", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
  RowBox[{"M1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["l2", "2"], " ", "m", " ", 
      RowBox[{"(", 
       RowBox[{"M2", "+", "MM"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
     RowBox[{"Jbar", " ", 
      RowBox[{"(", 
       RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"m", "+", "M1", "+", "M2", "+", "MM"}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["d", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"m", "+", "M2", "+", "MM"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", "M1", " ", 
         RowBox[{"(", 
          RowBox[{"M2", "+", "MM"}], ")"}]}], "+", 
        RowBox[{"m", " ", 
         RowBox[{"(", 
          RowBox[{"M1", "+", "M2", "+", "MM"}], ")"}]}]}], ")"}]}]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{3.712723875110805*^9, 3.712827745056119*^9, 
  3.7140573811825933`*^9, 3.714057841961035*^9, 3.7140589113247843`*^9, 
  3.7140644250443363`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["given some physical constants", "Chapter",
 CellChangeTimes->{{3.714057042393785*^9, 3.714057057210704*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"PhysicalConstants", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gravity", "\[Rule]", "9.81"}], ",", "\[IndentingNewLine]", 
     RowBox[{"M1", " ", "\[Rule]", "2.222"}], ",", 
     RowBox[{"(*", 
      RowBox[{"neo", " ", "mass"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"M2", "\[Rule]", " ", "2.733"}], ",", 
     RowBox[{"(*", 
      RowBox[{"popeye", " ", "mass"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"l1", "\[Rule]", " ", "1.45"}], ",", 
     RowBox[{"(*", 
      RowBox[{"cable", " ", "length", " ", "neo"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"l2", "\[Rule]", "0.27"}], " ", ",", 
     RowBox[{"lm", "\[Rule]", " ", "0.20"}], ",", 
     RowBox[{"l22", "\[Rule]", " ", "0.07"}], ",", "\[IndentingNewLine]", 
     RowBox[{"d1", "\[Rule]", " ", 
      RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"d2", "\[Rule]", " ", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"MM", "\[Rule]", "0.896"}], ",", 
     RowBox[{"(*", 
      RowBox[{"manipulator", " ", "mass"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"JM", "\[Rule]", 
      RowBox[{
       FractionBox["1", "12"], "0.896", " ", 
       SuperscriptBox["0.27", "2"]}]}]}], 
    RowBox[{"(*", 
     RowBox[{"manipulator", " ", "moment", " ", "of", " ", "inertia"}], 
     "*)"}], "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PhysicalConstants", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{"PhysicalConstants", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Jbar", "\[Rule]", " ", 
          RowBox[{
           RowBox[{"d1", " ", "m1", " ", "gravity"}], "+", 
           RowBox[{"d2", " ", "m2", " ", "gravity"}], "+", 
           RowBox[{
            FractionBox["1", "12"], "mbar", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Abs", "[", "d1", "]"}], "+", 
               RowBox[{"Abs", "[", "d2", "]"}]}], ")"}], "2"]}]}]}], 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"d1", "*", "m1", "*", "g"}], "+", 
           RowBox[{"d2", "*", "m2", "*", "g"}], "+", 
           RowBox[{
            FractionBox["1", "12"], "mbar", " ", 
            SuperscriptBox["L", "2"]}]}], "*)"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"m", "\[Rule]", " ", 
          RowBox[{"m1", "+", "m2", "+", "mbar"}]}]}], "\[IndentingNewLine]", 
        "}"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m1", "\[Rule]", " ", "0.587"}], ",", 
         RowBox[{"m2", "\[Rule]", " ", "0.608"}], ",", 
         RowBox[{"mbar", "\[Rule]", " ", "0.287"}]}], "}"}]}], "/.", 
      "PhysicalConstants"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"kpx2", "\[Rule]", " ", "0"}], ",", 
   RowBox[{"kdx2", "\[Rule]", "0"}]}], "}"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"solgains1", "/.", "PhysicalConstants"}], "//", "Simplify"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"solgains2", "/.", "PhysicalConstants"}], "//", "Simplify"}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.71109460565976*^9, 3.7110946322782383`*^9}, {
   3.7111964381368437`*^9, 3.711196457499648*^9}, {3.711196512020955*^9, 
   3.711196514898863*^9}, {3.712461199391642*^9, 3.712461229536858*^9}, 
   3.714058067143744*^9},
 ExpressionUUID -> "74f9c4ac-5289-4836-b348-a105fec6cd02"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"kpx2", "\[Rule]", "0"}], ",", 
   RowBox[{"kdx2", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.711094623575666*^9, 3.7110946328595457`*^9}, 
   3.711196472386312*^9, 3.7111965179257307`*^9, 3.7122263965383873`*^9, 
   3.712404024185019*^9, 3.7124151077124643`*^9, {3.712461192791058*^9, 
   3.7124612330019293`*^9}, 3.712463467979622*^9, 3.712808764225914*^9, 
   3.712821448835353*^9, 3.7140589317639513`*^9, 3.7140644252100563`*^9},
 ExpressionUUID -> "a7036cb2-0fbd-4f42-802b-902ec8fd696b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"kpx1", "\[Rule]", 
     RowBox[{"1.9425183967011659`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.7413111314518561`", " ", "kpz2"}]}]}], ",", 
    RowBox[{"kdx1", "\[Rule]", 
     RowBox[{"0.7413111314518561`", " ", "kdz2"}]}], ",", 
    RowBox[{"kpz1", "\[Rule]", 
     RowBox[{"0.8339610963384668`", " ", "kpz2"}]}], ",", 
    RowBox[{"kdz1", "\[Rule]", 
     RowBox[{"0.8339610963384668`", " ", "kdz2"}]}]}], "}"}], "}"}]], "Output",\

 CellChangeTimes->{{3.711094623575666*^9, 3.7110946328595457`*^9}, 
   3.711196472386312*^9, 3.7111965179257307`*^9, 3.7122263965383873`*^9, 
   3.712404024185019*^9, 3.7124151077124643`*^9, {3.712461192791058*^9, 
   3.7124612330019293`*^9}, 3.712463467979622*^9, 3.712808764225914*^9, 
   3.712821448835353*^9, 3.7140589317639513`*^9, 3.714064425225233*^9},
 ExpressionUUID -> "a7036cb2-0fbd-4f42-802b-902ec8fd696b"]
}, Open  ]]
}, Open  ]]
}, Closed]]
},
WindowSize->{1390, 855},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 164, 4, 65, "Chapter"],
Cell[CellGroupData[{
Cell[747, 28, 78, 1, 66, "Title"],
Cell[CellGroupData[{
Cell[850, 33, 255, 4, 35, "Subsubsection"],
Cell[1108, 39, 327, 9, 32, "Input"]
}, Open  ]],
Cell[1450, 51, 597, 8, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[2072, 63, 120, 1, 54, "Chapter"],
Cell[2195, 66, 3821, 79, 369, "Input"],
Cell[6019, 147, 1079, 25, 117, "Input"],
Cell[7101, 174, 457, 8, 30, "Text"],
Cell[7561, 184, 1003, 26, 96, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8601, 215, 136, 2, 65, "Chapter"],
Cell[8740, 219, 2434, 72, 165, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11211, 296, 145, 1, 65, "Chapter"],
Cell[11359, 299, 312, 6, 30, "Text"],
Cell[11674, 307, 3640, 83, 264, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15351, 395, 202, 3, 65, "Chapter"],
Cell[CellGroupData[{
Cell[15578, 402, 670, 21, 54, "Input"],
Cell[16251, 425, 2852, 84, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19152, 515, 128, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[19305, 520, 180, 4, 32, "Input"],
Cell[19488, 526, 203, 5, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19740, 537, 221, 3, 65, "Chapter"],
Cell[19964, 542, 3234, 77, 92, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23235, 624, 97, 1, 65, "Chapter"],
Cell[23335, 627, 1425, 31, 96, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24797, 663, 120, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[24942, 668, 1463, 43, 117, "Input"],
Cell[26408, 713, 157, 3, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[26614, 722, 154, 3, 65, "Chapter"],
Cell[CellGroupData[{
Cell[26793, 729, 2560, 69, 148, "Input"],
Cell[29356, 800, 631, 9, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[30036, 815, 273, 4, 65, "Chapter"],
Cell[30312, 821, 914, 23, 75, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31263, 849, 273, 4, 65, "Chapter"],
Cell[CellGroupData[{
Cell[31561, 857, 96, 1, 35, "Subsubsection"],
Cell[31660, 860, 275, 7, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31972, 872, 176, 3, 35, "Subsubsection"],
Cell[32151, 877, 1715, 40, 54, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33903, 922, 108, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[34036, 927, 466, 14, 32, "Input"],
Cell[34505, 943, 1731, 40, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[36297, 990, 110, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[36432, 995, 1240, 22, 75, "Input"],
Cell[37675, 1019, 2316, 44, 70, "Output"],
Cell[39994, 1065, 39861, 1072, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[79916, 2144, 86, 1, 66, "Title"],
Cell[80005, 2147, 322, 8, 67, "Chapter",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[80352, 2159, 129, 1, 54, "Chapter"],
Cell[80484, 2162, 2710, 69, 159, "Input"],
Cell[CellGroupData[{
Cell[83219, 2235, 3166, 82, 138, "Input"],
Cell[86388, 2319, 1202, 19, 70, "Output"],
Cell[87593, 2340, 1203, 19, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[88845, 2365, 289, 4, 65, "Chapter"],
Cell[CellGroupData[{
Cell[89159, 2373, 1601, 35, 159, "Input"],
Cell[90763, 2410, 1685, 25, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[92497, 2441, 220, 5, 109, "Chapter"],
Cell[92720, 2448, 792, 20, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93549, 2473, 126, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[93700, 2478, 241, 6, 32, "Input"],
Cell[93944, 2486, 1600, 24, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[95593, 2516, 115, 1, 65, "Chapter"],
Cell[95711, 2519, 1682, 28, 54, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[97442, 2553, 95, 1, 66, "Title"],
Cell[CellGroupData[{
Cell[97562, 2558, 113, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[97700, 2563, 1395, 42, 117, "Input"],
Cell[99098, 2607, 1038, 26, 70, "Output"],
Cell[100139, 2635, 1103, 28, 70, "Output"],
Cell[101245, 2665, 1178, 30, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[102472, 2701, 105, 1, 65, "Chapter"],
Cell[102580, 2704, 645, 14, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103262, 2723, 233, 3, 65, "Chapter"],
Cell[CellGroupData[{
Cell[103520, 2730, 1005, 23, 96, "Input"],
Cell[104528, 2755, 1303, 35, 70, "Output"],
Cell[105834, 2792, 1298, 36, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[107193, 2835, 95, 1, 66, "Title"],
Cell[107291, 2838, 115, 1, 65, "Chapter"]
}, Closed]],
Cell[CellGroupData[{
Cell[107443, 2844, 77, 1, 66, "Title"],
Cell[CellGroupData[{
Cell[107545, 2849, 406, 7, 65, "Chapter"],
Cell[CellGroupData[{
Cell[107976, 2860, 2440, 73, 96, "Input"],
Cell[110419, 2935, 354, 10, 45, "Output"],
Cell[110776, 2947, 354, 10, 45, "Output"],
Cell[111133, 2959, 354, 10, 45, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[111536, 2975, 247, 3, 65, "Chapter"],
Cell[CellGroupData[{
Cell[111808, 2982, 1777, 52, 115, "Input"],
Cell[113588, 3036, 1106, 26, 47, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[114743, 3068, 116, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[114884, 3073, 679, 21, 54, "Input"],
Cell[115566, 3096, 375, 8, 32, "Output"],
Cell[115944, 3106, 375, 8, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[116368, 3120, 104, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[116497, 3125, 2502, 61, 138, "Input"],
Cell[119002, 3188, 2623, 76, 198, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[121674, 3270, 106, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[121805, 3275, 602, 15, 54, "Input"],
Cell[122410, 3292, 58376, 1518, 222, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[180835, 4816, 96, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[180956, 4821, 674, 19, 52, "Input"],
Cell[181633, 4842, 119, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[181789, 4849, 626, 19, 52, "Input"],
Cell[182418, 4870, 121, 2, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[182588, 4878, 193, 2, 65, "Chapter"],
Cell[CellGroupData[{
Cell[182806, 4884, 166, 3, 63, "Subchapter"],
Cell[CellGroupData[{
Cell[182997, 4891, 147, 2, 64, "Section"],
Cell[183147, 4895, 1724, 45, 54, "Input"],
Cell[184874, 4942, 1391, 40, 54, "Input"],
Cell[CellGroupData[{
Cell[186290, 4986, 912, 25, 54, "Input"],
Cell[187205, 5013, 597, 10, 32, "Output"],
Cell[187805, 5025, 597, 10, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[188439, 5040, 1358, 41, 54, "Input"],
Cell[189800, 5083, 285, 5, 32, "Output"],
Cell[190088, 5090, 285, 5, 32, "Output"]
}, Open  ]],
Cell[190388, 5098, 1768, 48, 62, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[192217, 5153, 188, 2, 65, "Chapter"],
Cell[CellGroupData[{
Cell[192430, 5159, 1281, 35, 75, "Input"],
Cell[193714, 5196, 10832, 276, 124, "Output"],
Cell[204549, 5474, 3577, 100, 122, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[208163, 5579, 1406, 43, 96, "Input"],
Cell[209572, 5624, 1130, 26, 92, "Output"],
Cell[210705, 5652, 4436, 116, 114, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[215190, 5774, 110, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[215325, 5779, 1060, 34, 54, "Input"],
Cell[216388, 5815, 1555, 46, 68, "Output"],
Cell[217946, 5863, 799, 22, 58, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[218794, 5891, 192, 3, 65, "Chapter"],
Cell[218989, 5896, 4194, 109, 285, "Input"],
Cell[CellGroupData[{
Cell[223208, 6009, 1458, 37, 75, "Input"],
Cell[224669, 6048, 8482, 225, 169, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[233200, 6279, 263, 5, 65, "Chapter"],
Cell[CellGroupData[{
Cell[233488, 6288, 608, 16, 32, "Input"],
Cell[234099, 6306, 2177, 66, 56, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[236325, 6378, 114, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[236464, 6383, 3601, 85, 550, "Input"],
Cell[240068, 6470, 560, 10, 32, "Output"],
Cell[240631, 6482, 927, 19, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}
]
*)

